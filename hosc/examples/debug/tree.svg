<svg:svg width="3384" height="1730" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="142" height="30" y="0" x="1621"></svg:rect><svg:text y="15" x="1692">((decomposeTree t) c1)</svg:text><svg:line x2="1692" y2="100" x1="1692" y1="30"></svg:line><svg:rect width="994" height="30" y="100" x="1195"></svg:rect><svg:text y="115" x="1692">(((\p6 -&gt; (\z1 -&gt; case (p6) of {Stub  -&gt; (((decomposeCtx z1) (Stub)) (StubNF)); Leaf w -&gt; (Dec (PRLeaf w) z1); Node v5 p5 -&gt; (((decomposeNode v5) p5) z1);})) t) c1)</svg:text><svg:line x2="1692" y2="200" x1="1692" y1="130"></svg:line><svg:rect width="910" height="30" y="200" x="1237"></svg:rect><svg:text y="215" x="1692">((\u4 -&gt; case (t) of {Stub  -&gt; (((decomposeCtx u4) (Stub)) (StubNF)); Leaf y -&gt; (Dec (PRLeaf y) u4); Node v6 v1 -&gt; (((decomposeNode v6) v1) u4);}) c1)</svg:text><svg:line x2="1692" y2="300" x1="1692" y1="230"></svg:line><svg:rect width="826" height="30" y="300" x="1279"></svg:rect><svg:text y="315" x="1692">case (t) of {Stub  -&gt; (((decomposeCtx c1) (Stub)) (StubNF)); Leaf t4 -&gt; (Dec (PRLeaf t4) c1); Node r y3 -&gt; (((decomposeNode r) y3) c1);}</svg:text><svg:line x2="28" y2="400" x1="1692" y1="330"></svg:line><svg:rect width="16" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="28">t</svg:text><svg:line x2="825" y2="400" x1="1692" y1="330"></svg:line><svg:rect width="232" height="30" y="400" x="709"></svg:rect><svg:text y="415" x="825">(((decomposeCtx c1) (Stub)) (StubNF))</svg:text><svg:line x2="825" y2="500" x1="825" y1="430"></svg:line><svg:rect width="940" height="30" y="500" x="355"></svg:rect><svg:text y="515" x="825">((((\w4 -&gt; (\x4 -&gt; (\p -&gt; case (w4) of {CtE  -&gt; (Val x4 p); CtR x6 w6 -&gt; (((decomposeCtx w6) (Node (Leaf x6) x4)) (NodeNF x6 p));}))) c1) (Stub)) (StubNF))</svg:text><svg:line x2="825" y2="600" x1="825" y1="530"></svg:line><svg:rect width="856" height="30" y="600" x="397"></svg:rect><svg:text y="615" x="825">(((\r1 -&gt; (\w1 -&gt; case (c1) of {CtE  -&gt; (Val r1 w1); CtR v s2 -&gt; (((decomposeCtx s2) (Node (Leaf v) r1)) (NodeNF v w1));})) (Stub)) (StubNF))</svg:text><svg:line x2="825" y2="700" x1="825" y1="630"></svg:line><svg:rect width="814" height="30" y="700" x="418"></svg:rect><svg:text y="715" x="825">((\p2 -&gt; case (c1) of {CtE  -&gt; (Val (Stub) p2); CtR p4 r2 -&gt; (((decomposeCtx r2) (Node (Leaf p4) (Stub))) (NodeNF p4 p2));}) (StubNF))</svg:text><svg:line x2="825" y2="800" x1="825" y1="730"></svg:line><svg:rect width="862" height="30" y="800" x="394"></svg:rect><svg:text y="815" x="825">let u2=(Stub), x7=(StubNF), z=c1
 in case (z) of {CtE  -&gt; (Val u2 x7); CtR t2 v3 -&gt; (((decomposeCtx v3) (Node (Leaf t2) u2)) (NodeNF t2 x7));}</svg:text><svg:line x2="702" y2="900" x1="825" y1="830"></svg:line><svg:rect width="640" height="30" y="900" x="382"></svg:rect><svg:text y="915" x="702">case (z) of {CtE  -&gt; (Val u2 x7); CtR t2 v3 -&gt; (((decomposeCtx v3) (Node (Leaf t2) u2)) (NodeNF t2 x7));}</svg:text><svg:line x2="84" y2="1000" x1="702" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="76"></svg:rect><svg:text y="1015" x="84">z</svg:text><svg:line x2="174" y2="1000" x1="702" y1="930"></svg:line><svg:rect width="76" height="30" y="1000" x="136"></svg:rect><svg:text y="1015" x="174">(Val u2 x7)</svg:text><svg:line x2="143" y2="1100" x1="174" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="132"></svg:rect><svg:text y="1115" x="143">u2</svg:text><svg:line x2="205" y2="1100" x1="174" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="194"></svg:rect><svg:text y="1115" x="205">x7</svg:text><svg:line x2="792" y2="1000" x1="702" y1="930"></svg:line><svg:rect width="346" height="30" y="1000" x="619"></svg:rect><svg:text y="1015" x="792">(((decomposeCtx v3) (Node (Leaf t2) u2)) (NodeNF t2 x7))</svg:text><svg:line x2="792" y2="1100" x1="792" y1="1030"></svg:line><svg:rect width="1072" height="30" y="1100" x="256"></svg:rect><svg:text y="1115" x="792">((((\y1 -&gt; (\v2 -&gt; (\t1 -&gt; case (y1) of {CtE  -&gt; (Val v2 t1); CtR w5 y6 -&gt; (((decomposeCtx y6) (Node (Leaf w5) v2)) (NodeNF w5 t1));}))) v3) (Node (Leaf t2) u2)) (NodeNF t2 x7))</svg:text><svg:line x2="792" y2="1200" x1="792" y1="1130"></svg:line><svg:rect width="970" height="30" y="1200" x="307"></svg:rect><svg:text y="1215" x="792">(((\u -&gt; (\x1 -&gt; case (v3) of {CtE  -&gt; (Val u x1); CtR u7 y7 -&gt; (((decomposeCtx y7) (Node (Leaf u7) u)) (NodeNF u7 x1));})) (Node (Leaf t2) u2)) (NodeNF t2 x7))</svg:text><svg:line x2="792" y2="1300" x1="792" y1="1230"></svg:line><svg:rect width="1006" height="30" y="1300" x="289"></svg:rect><svg:text y="1315" x="792">((\x3 -&gt; case (v3) of {CtE  -&gt; (Val (Node (Leaf t2) u2) x3); CtR t3 u1 -&gt; (((decomposeCtx u1) (Node (Leaf t3) (Node (Leaf t2) u2))) (NodeNF t3 x3));}) (NodeNF t2 x7))</svg:text><svg:line x2="792" y2="1400" x1="792" y1="1330"></svg:line><svg:rect width="988" height="30" y="1400" x="298"></svg:rect><svg:text y="1415" x="792">let t6=v3, t5=(NodeNF t2 x7), z7=(Node (Leaf t2) u2)
 in case (t6) of {CtE  -&gt; (Val z7 t5); CtR t2 v3 -&gt; (((decomposeCtx v3) (Node (Leaf t2) z7)) (NodeNF t2 t5));}</svg:text><svg:line x2="611" y2="1500" x1="792" y1="1430"></svg:line><svg:rect width="646" height="30" y="1500" x="288"></svg:rect><svg:text y="1515" x="611">case (t6) of {CtE  -&gt; (Val z7 t5); CtR t2 v3 -&gt; (((decomposeCtx v3) (Node (Leaf t2) z7)) (NodeNF t2 t5));}</svg:text><svg:line x2="985" y2="1500" x1="792" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="974"></svg:rect><svg:text y="1515" x="985">v3</svg:text><svg:line x2="1083" y2="1500" x1="792" y1="1430"></svg:line><svg:rect width="94" height="30" y="1500" x="1036"></svg:rect><svg:text y="1515" x="1083">(NodeNF t2 x7)</svg:text><svg:line x2="1052" y2="1600" x1="1083" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="1041"></svg:rect><svg:text y="1615" x="1052">t2</svg:text><svg:line x2="1114" y2="1600" x1="1083" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="1103"></svg:rect><svg:text y="1615" x="1114">x7</svg:text><svg:line x2="1233" y2="1500" x1="792" y1="1430"></svg:line><svg:rect width="124" height="30" y="1500" x="1171"></svg:rect><svg:text y="1515" x="1233">(Node (Leaf t2) u2)</svg:text><svg:line x2="1202" y2="1600" x1="1233" y1="1530"></svg:line><svg:rect width="64" height="30" y="1600" x="1170"></svg:rect><svg:text y="1615" x="1202">(Leaf t2)</svg:text><svg:line x2="1202" y2="1700" x1="1202" y1="1630"></svg:line><svg:rect width="22" height="30" y="1700" x="1191"></svg:rect><svg:text y="1715" x="1202">t2</svg:text><svg:line x2="1285" y2="1600" x1="1233" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="1274"></svg:rect><svg:text y="1615" x="1285">u2</svg:text><svg:line x2="1391" y2="900" x1="825" y1="830"></svg:line><svg:rect width="46" height="30" y="900" x="1368"></svg:rect><svg:text y="915" x="1391">(Stub)</svg:text><svg:line x2="1483" y2="900" x1="825" y1="830"></svg:line><svg:rect width="58" height="30" y="900" x="1454"></svg:rect><svg:text y="915" x="1483">(StubNF)</svg:text><svg:line x2="1563" y2="900" x1="825" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="1552"></svg:rect><svg:text y="915" x="1563">c1</svg:text><svg:line x2="1683" y2="400" x1="1692" y1="330"></svg:line><svg:rect width="130" height="30" y="400" x="1618"></svg:rect><svg:text y="415" x="1683">(Dec (PRLeaf t4) c1)</svg:text><svg:line x2="1652" y2="500" x1="1683" y1="430"></svg:line><svg:rect width="76" height="30" y="500" x="1614"></svg:rect><svg:text y="515" x="1652">(PRLeaf t4)</svg:text><svg:line x2="1652" y2="600" x1="1652" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="1641"></svg:rect><svg:text y="615" x="1652">t4</svg:text><svg:line x2="1741" y2="500" x1="1683" y1="430"></svg:line><svg:rect width="22" height="30" y="500" x="1730"></svg:rect><svg:text y="515" x="1741">c1</svg:text><svg:line x2="2578" y2="400" x1="1692" y1="330"></svg:line><svg:rect width="172" height="30" y="400" x="2492"></svg:rect><svg:text y="415" x="2578">(((decomposeNode r) y3) c1)</svg:text><svg:line x2="2578" y2="500" x1="2578" y1="430"></svg:line><svg:rect width="1066" height="30" y="500" x="2045"></svg:rect><svg:text y="515" x="2578">((((\x -&gt; (\u6 -&gt; (\z3 -&gt; case (x) of {Stub  -&gt; (Dec (PRLeftStub u6) z3); Leaf z2 -&gt; ((decomposeTree u6) (CtR z2 z3)); Node z4 w3 -&gt; (Dec (PRAssoc z4 w3 u6) z3);}))) r) y3) c1)</svg:text><svg:line x2="2578" y2="600" x1="2578" y1="530"></svg:line><svg:rect width="994" height="30" y="600" x="2081"></svg:rect><svg:text y="615" x="2578">(((\s4 -&gt; (\s6 -&gt; case (r) of {Stub  -&gt; (Dec (PRLeftStub s4) s6); Leaf v4 -&gt; ((decomposeTree s4) (CtR v4 s6)); Node p3 u3 -&gt; (Dec (PRAssoc p3 u3 s4) s6);})) y3) c1)</svg:text><svg:line x2="2578" y2="700" x1="2578" y1="630"></svg:line><svg:rect width="910" height="30" y="700" x="2123"></svg:rect><svg:text y="715" x="2578">((\x2 -&gt; case (r) of {Stub  -&gt; (Dec (PRLeftStub y3) x2); Leaf z6 -&gt; ((decomposeTree y3) (CtR z6 x2)); Node w2 x5 -&gt; (Dec (PRAssoc w2 x5 y3) x2);}) c1)</svg:text><svg:line x2="2578" y2="800" x1="2578" y1="730"></svg:line><svg:rect width="826" height="30" y="800" x="2165"></svg:rect><svg:text y="815" x="2578">case (r) of {Stub  -&gt; (Dec (PRLeftStub y3) c1); Leaf y4 -&gt; ((decomposeTree y3) (CtR y4 c1)); Node r3 s3 -&gt; (Dec (PRAssoc r3 s3 y3) c1);}</svg:text><svg:line x2="1800" y2="900" x1="2578" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="1792"></svg:rect><svg:text y="915" x="1800">r</svg:text><svg:line x2="1929" y2="900" x1="2578" y1="830"></svg:line><svg:rect width="154" height="30" y="900" x="1852"></svg:rect><svg:text y="915" x="1929">(Dec (PRLeftStub y3) c1)</svg:text><svg:line x2="1898" y2="1000" x1="1929" y1="930"></svg:line><svg:rect width="100" height="30" y="1000" x="1848"></svg:rect><svg:text y="1015" x="1898">(PRLeftStub y3)</svg:text><svg:line x2="1898" y2="1100" x1="1898" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="1887"></svg:rect><svg:text y="1115" x="1898">y3</svg:text><svg:line x2="1999" y2="1000" x1="1929" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="1988"></svg:rect><svg:text y="1015" x="1999">c1</svg:text><svg:line x2="2583" y2="900" x1="2578" y1="830"></svg:line><svg:rect width="202" height="30" y="900" x="2482"></svg:rect><svg:text y="915" x="2583">((decomposeTree y3) (CtR y4 c1))</svg:text><svg:line x2="2583" y2="1000" x1="2583" y1="930"></svg:line><svg:rect width="1066" height="30" y="1000" x="2050"></svg:rect><svg:text y="1015" x="2583">(((\r6 -&gt; (\z5 -&gt; case (r6) of {Stub  -&gt; (((decomposeCtx z5) (Stub)) (StubNF)); Leaf r4 -&gt; (Dec (PRLeaf r4) z5); Node y5 y2 -&gt; (((decomposeNode y5) y2) z5);})) y3) (CtR y4 c1))</svg:text><svg:line x2="2583" y2="1100" x1="2583" y1="1030"></svg:line><svg:rect width="958" height="30" y="1100" x="2104"></svg:rect><svg:text y="1115" x="2583">((\s -&gt; case (y3) of {Stub  -&gt; (((decomposeCtx s) (Stub)) (StubNF)); Leaf p1 -&gt; (Dec (PRLeaf p1) s); Node r5 s1 -&gt; (((decomposeNode r5) s1) s);}) (CtR y4 c1))</svg:text><svg:line x2="2583" y2="1200" x1="2583" y1="1130"></svg:line><svg:rect width="1012" height="30" y="1200" x="2077"></svg:rect><svg:text y="1215" x="2583">let s5=y3, u5=(CtR y4 c1)
 in case (s5) of {Stub  -&gt; (((decomposeCtx u5) (Stub)) (StubNF)); Leaf t4 -&gt; (Dec (PRLeaf t4) u5); Node r y3 -&gt; (((decomposeNode r) y3) u5);}</svg:text><svg:line x2="2490" y2="1300" x1="2583" y1="1230"></svg:line><svg:rect width="832" height="30" y="1300" x="2074"></svg:rect><svg:text y="1315" x="2490">case (s5) of {Stub  -&gt; (((decomposeCtx u5) (Stub)) (StubNF)); Leaf t4 -&gt; (Dec (PRLeaf t4) u5); Node r y3 -&gt; (((decomposeNode r) y3) u5);}</svg:text><svg:line x2="2957" y2="1300" x1="2583" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="2946"></svg:rect><svg:text y="1315" x="2957">y3</svg:text><svg:line x2="3050" y2="1300" x1="2583" y1="1230"></svg:line><svg:rect width="76" height="30" y="1300" x="3012"></svg:rect><svg:text y="1315" x="3050">(CtR y4 c1)</svg:text><svg:line x2="3019" y2="1400" x1="3050" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="3008"></svg:rect><svg:text y="1415" x="3019">y4</svg:text><svg:line x2="3081" y2="1400" x1="3050" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="3070"></svg:rect><svg:text y="1415" x="3081">c1</svg:text><svg:line x2="3260" y2="900" x1="2578" y1="830"></svg:line><svg:rect width="172" height="30" y="900" x="3174"></svg:rect><svg:text y="915" x="3260">(Dec (PRAssoc r3 s3 y3) c1)</svg:text><svg:line x2="3229" y2="1000" x1="3260" y1="930"></svg:line><svg:rect width="118" height="30" y="1000" x="3170"></svg:rect><svg:text y="1015" x="3229">(PRAssoc r3 s3 y3)</svg:text><svg:line x2="3167" y2="1100" x1="3229" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="3156"></svg:rect><svg:text y="1115" x="3167">r3</svg:text><svg:line x2="3229" y2="1100" x1="3229" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="3218"></svg:rect><svg:text y="1115" x="3229">s3</svg:text><svg:line x2="3291" y2="1100" x1="3229" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="3280"></svg:rect><svg:text y="1115" x="3291">y3</svg:text><svg:line x2="3353" y2="1000" x1="3260" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="3342"></svg:rect><svg:text y="1015" x="3353">c1</svg:text>
    <svg:path d="M 288, 1515 C 56, 1515 56, 915 382, 915" style="stroke:black;"></svg:path><svg:path d="M 2906, 1315 C 3384, 1315 3384, 315 2105, 315" style="stroke:black;"></svg:path>
    </svg:svg>