<svg:svg width="5340" height="2630" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="208" height="30" y="0" x="2566"></svg:rect><svg:text y="15" x="2670">(iterate ((decTerm t) (CtxHole)))</svg:text><svg:line x2="2670" y2="100" x1="2670" y1="30"></svg:line><svg:rect width="754" height="30" y="100" x="2293"></svg:rect><svg:text y="115" x="2670">((\p10 -&gt; case (p10) of {Val w16 -&gt; w16; Dec w17 u10 -&gt; (iterate ((decTerm (contract w17)) u10));}) ((decTerm t) (CtxHole)))</svg:text><svg:line x2="2670" y2="200" x1="2670" y1="130"></svg:line><svg:rect width="634" height="30" y="200" x="2353"></svg:rect><svg:text y="215" x="2670">case (((decTerm t) (CtxHole))) of {Val z17 -&gt; z17; Dec w7 y8 -&gt; (iterate ((decTerm (contract w7)) y8));}</svg:text><svg:line x2="2670" y2="300" x1="2670" y1="230"></svg:line><svg:rect width="1306" height="30" y="300" x="2017"></svg:rect><svg:text y="315" x="2670">case ((((\v8 -&gt; (\p8 -&gt; case (v8) of {Cst x10 -&gt; ((decCtx p8) x10); Opr x12 t15 x11 -&gt; ((decTerm t15) (CtxLeft x12 p8 x11));})) t) (CtxHole))) of {Val z17 -&gt; z17; Dec w7 y8 -&gt; (iterate ((decTerm (contract w7)) y8));}</svg:text><svg:line x2="2670" y2="400" x1="2670" y1="330"></svg:line><svg:rect width="1174" height="30" y="400" x="2083"></svg:rect><svg:text y="415" x="2670">case (((\y9 -&gt; case (t) of {Cst z10 -&gt; ((decCtx y9) z10); Opr y12 v17 z -&gt; ((decTerm v17) (CtxLeft y12 y9 z));}) (CtxHole))) of {Val x -&gt; x; Dec s8 u7 -&gt; (iterate ((decTerm (contract s8)) u7));}</svg:text><svg:line x2="2670" y2="500" x1="2670" y1="430"></svg:line><svg:rect width="1246" height="30" y="500" x="2047"></svg:rect><svg:text y="515" x="2670">let w10=(CtxHole), x8=t
 in case (case (x8) of {Cst s -&gt; ((decCtx w10) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 w10 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="2590" y2="600" x1="2670" y1="530"></svg:line><svg:rect width="1078" height="30" y="600" x="2051"></svg:rect><svg:text y="615" x="2590">case (case (x8) of {Cst s -&gt; ((decCtx w10) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 w10 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="31" y2="700" x1="2590" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">x8</svg:text><svg:line x2="1938" y2="700" x1="2590" y1="630"></svg:line><svg:rect width="580" height="30" y="700" x="1648"></svg:rect><svg:text y="715" x="1938">case (((decCtx w10) s)) of {Dec p2 y4 -&gt; (iterate ((decTerm (contract p2)) y4)); Val r1 -&gt; r1;}</svg:text><svg:line x2="1938" y2="800" x1="1938" y1="730"></svg:line><svg:rect width="1546" height="30" y="800" x="1165"></svg:rect><svg:text y="815" x="1938">case ((((\r3 -&gt; (\s3 -&gt; case (r3) of {CtxHole  -&gt; (Val s3); CtxLeft u2 t14 z3 -&gt; ((decTerm z3) (CtxRight u2 s3 t14)); CtxRight y13 v11 t10 -&gt; (Dec (PotRed y13 v11 s3) t10);})) w10) s)) of {Dec p2 y4 -&gt; (iterate ((decTerm (contract p2)) y4)); Val r1 -&gt; r1;}</svg:text><svg:line x2="1938" y2="900" x1="1938" y1="830"></svg:line><svg:rect width="1510" height="30" y="900" x="1183"></svg:rect><svg:text y="915" x="1938">case (((\x13 -&gt; case (w10) of {CtxHole  -&gt; (Val x13); CtxLeft w11 p12 u12 -&gt; ((decTerm u12) (CtxRight w11 x13 p12)); CtxRight z13 x4 s4 -&gt; (Dec (PotRed z13 x4 x13) s4);}) s)) of {Dec y15 v15 -&gt; (iterate ((decTerm (contract y15)) v15)); Val y1 -&gt; y1;}</svg:text><svg:line x2="1938" y2="1000" x1="1938" y1="930"></svg:line><svg:rect width="1342" height="30" y="1000" x="1267"></svg:rect><svg:text y="1015" x="1938">case (case (w10) of {CtxHole  -&gt; (Val s); CtxLeft x17 u5 y5 -&gt; ((decTerm y5) (CtxRight x17 s u5)); CtxRight z2 t3 s10 -&gt; (Dec (PotRed z2 t3 s) s10);}) of {Dec z8 s7 -&gt; (iterate ((decTerm (contract z8)) s7)); Val z5 -&gt; z5;}</svg:text><svg:line x2="96" y2="1100" x1="1938" y1="1030"></svg:line><svg:rect width="28" height="30" y="1100" x="82"></svg:rect><svg:text y="1115" x="96">w10</svg:text><svg:line x2="413" y2="1100" x1="1938" y1="1030"></svg:line><svg:rect width="526" height="30" y="1100" x="150"></svg:rect><svg:text y="1115" x="413">case ((Val s)) of {Dec p6 y7 -&gt; (iterate ((decTerm (contract p6)) y7)); Val s6 -&gt; s6;}</svg:text><svg:line x2="413" y2="1200" x1="413" y1="1130"></svg:line><svg:rect width="16" height="30" y="1200" x="405"></svg:rect><svg:text y="1215" x="413">s</svg:text><svg:line x2="1423" y2="1100" x1="1938" y1="1030"></svg:line><svg:rect width="712" height="30" y="1100" x="1067"></svg:rect><svg:text y="1115" x="1423">case (((decTerm y5) (CtxRight x17 s u5))) of {Dec u15 z1 -&gt; (iterate ((decTerm (contract u15)) z1)); Val s14 -&gt; s14;}</svg:text><svg:line x2="1423" y2="1200" x1="1423" y1="1130"></svg:line><svg:rect width="1414" height="30" y="1200" x="716"></svg:rect><svg:text y="1215" x="1423">case ((((\v10 -&gt; (\w13 -&gt; case (v10) of {Cst r13 -&gt; ((decCtx w13) r13); Opr s12 z12 s11 -&gt; ((decTerm z12) (CtxLeft s12 w13 s11));})) y5) (CtxRight x17 s u5))) of {Dec u15 z1 -&gt; (iterate ((decTerm (contract u15)) z1)); Val s14 -&gt; s14;}</svg:text><svg:line x2="1423" y2="1300" x1="1423" y1="1230"></svg:line><svg:rect width="1252" height="30" y="1300" x="797"></svg:rect><svg:text y="1315" x="1423">case (((\t9 -&gt; case (y5) of {Cst w14 -&gt; ((decCtx t9) w14); Opr v w4 t2 -&gt; ((decTerm w4) (CtxLeft v t9 t2));}) (CtxRight x17 s u5))) of {Dec v3 r15 -&gt; (iterate ((decTerm (contract v3)) r15)); Val p14 -&gt; p14;}</svg:text><svg:line x2="1423" y2="1400" x1="1423" y1="1330"></svg:line><svg:rect width="1312" height="30" y="1400" x="767"></svg:rect><svg:text y="1415" x="1423">let x9=y5, y10=(CtxRight x17 s u5)
 in case (case (x9) of {Cst s -&gt; ((decCtx y10) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 y10 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="1299" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="1078" height="30" y="1500" x="760"></svg:rect><svg:text y="1515" x="1299">case (case (x9) of {Cst s -&gt; ((decCtx y10) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 y10 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="1889" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="1878"></svg:rect><svg:text y="1515" x="1889">y5</svg:text><svg:line x2="2013" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="124" height="30" y="1500" x="1951"></svg:rect><svg:text y="1515" x="2013">(CtxRight x17 s u5)</svg:text><svg:line x2="1954" y2="1600" x1="2013" y1="1530"></svg:line><svg:rect width="28" height="30" y="1600" x="1940"></svg:rect><svg:text y="1615" x="1954">x17</svg:text><svg:line x2="2016" y2="1600" x1="2013" y1="1530"></svg:line><svg:rect width="16" height="30" y="1600" x="2008"></svg:rect><svg:text y="1615" x="2016">s</svg:text><svg:line x2="2075" y2="1600" x1="2013" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="2064"></svg:rect><svg:text y="1615" x="2075">u5</svg:text><svg:line x2="2982" y2="1100" x1="1938" y1="1030"></svg:line><svg:rect width="652" height="30" y="1100" x="2656"></svg:rect><svg:text y="1115" x="2982">case ((Dec (PotRed z2 t3 s) s10)) of {Dec v14 x1 -&gt; (iterate ((decTerm (contract v14)) x1)); Val s1 -&gt; s1;}</svg:text><svg:line x2="2982" y2="1200" x1="2982" y1="1130"></svg:line><svg:rect width="328" height="30" y="1200" x="2818"></svg:rect><svg:text y="1215" x="2982">(iterate ((decTerm (contract (PotRed z2 t3 s))) s10))</svg:text><svg:line x2="2982" y2="1300" x1="2982" y1="1230"></svg:line><svg:rect width="838" height="30" y="1300" x="2563"></svg:rect><svg:text y="1315" x="2982">((\w15 -&gt; case (w15) of {Val y3 -&gt; y3; Dec v2 z7 -&gt; (iterate ((decTerm (contract v2)) z7));}) ((decTerm (contract (PotRed z2 t3 s))) s10))</svg:text><svg:line x2="2982" y2="1400" x1="2982" y1="1330"></svg:line><svg:rect width="742" height="30" y="1400" x="2611"></svg:rect><svg:text y="1415" x="2982">case (((decTerm (contract (PotRed z2 t3 s))) s10)) of {Val r5 -&gt; r5; Dec v5 x5 -&gt; (iterate ((decTerm (contract v5)) x5));}</svg:text><svg:line x2="2982" y2="1500" x1="2982" y1="1430"></svg:line><svg:rect width="1378" height="30" y="1500" x="2293"></svg:rect><svg:text y="1515" x="2982">case ((((\z6 -&gt; (\w8 -&gt; case (z6) of {Cst r4 -&gt; ((decCtx w8) r4); Opr s5 u6 y14 -&gt; ((decTerm u6) (CtxLeft s5 w8 y14));})) (contract (PotRed z2 t3 s))) s10)) of {Val r5 -&gt; r5; Dec v5 x5 -&gt; (iterate ((decTerm (contract v5)) x5));}</svg:text><svg:line x2="2982" y2="1600" x1="2982" y1="1530"></svg:line><svg:rect width="1366" height="30" y="1600" x="2299"></svg:rect><svg:text y="1615" x="2982">case (((\r2 -&gt; case ((contract (PotRed z2 t3 s))) of {Cst y16 -&gt; ((decCtx r2) y16); Opr p15 p17 p16 -&gt; ((decTerm p17) (CtxLeft p15 r2 p16));}) s10)) of {Val u17 -&gt; u17; Dec p13 w12 -&gt; (iterate ((decTerm (contract p13)) w12));}</svg:text><svg:line x2="2982" y2="1700" x1="2982" y1="1630"></svg:line><svg:rect width="1264" height="30" y="1700" x="2350"></svg:rect><svg:text y="1715" x="2982">case (case ((contract (PotRed z2 t3 s))) of {Cst t12 -&gt; ((decCtx s10) t12); Opr s9 w9 z11 -&gt; ((decTerm w9) (CtxLeft s9 s10 z11));}) of {Val r11 -&gt; r11; Dec t16 x16 -&gt; (iterate ((decTerm (contract t16)) x16));}</svg:text><svg:line x2="2982" y2="1800" x1="2982" y1="1730"></svg:line><svg:rect width="1624" height="30" y="1800" x="2170"></svg:rect><svg:text y="1815" x="2982">case (case (((\r14 -&gt; case (r14) of {PotRed t11 u4 v13 -&gt; (Cst ((t11 u4) v13));}) (PotRed z2 t3 s))) of {Cst t12 -&gt; ((decCtx s10) t12); Opr s9 w9 z11 -&gt; ((decTerm w9) (CtxLeft s9 s10 z11));}) of {Val r11 -&gt; r11; Dec t16 x16 -&gt; (iterate ((decTerm (contract t16)) x16));}</svg:text><svg:line x2="2982" y2="1900" x1="2982" y1="1830"></svg:line><svg:rect width="1408" height="30" y="1900" x="2278"></svg:rect><svg:text y="1915" x="2982">case (case (case ((PotRed z2 t3 s)) of {PotRed v1 s2 u -&gt; (Cst ((v1 s2) u));}) of {Cst y2 -&gt; ((decCtx s10) y2); Opr p y t6 -&gt; ((decTerm y) (CtxLeft p s10 t6));}) of {Val r7 -&gt; r7; Dec p7 x7 -&gt; (iterate ((decTerm (contract p7)) x7));}</svg:text><svg:line x2="2982" y2="2000" x1="2982" y1="1930"></svg:line><svg:rect width="1168" height="30" y="2000" x="2398"></svg:rect><svg:text y="2015" x="2982">case (case ((Cst ((z2 t3) s))) of {Cst v12 -&gt; ((decCtx s10) v12); Opr u8 v6 p9 -&gt; ((decTerm v6) (CtxLeft u8 s10 p9));}) of {Val s13 -&gt; s13; Dec z9 u9 -&gt; (iterate ((decTerm (contract z9)) u9));}</svg:text><svg:line x2="2982" y2="2100" x1="2982" y1="2030"></svg:line><svg:rect width="676" height="30" y="2100" x="2644"></svg:rect><svg:text y="2115" x="2982">case (((decCtx s10) ((z2 t3) s))) of {Val z16 -&gt; z16; Dec z14 r16 -&gt; (iterate ((decTerm (contract z14)) r16));}</svg:text><svg:line x2="2982" y2="2200" x1="2982" y1="2130"></svg:line><svg:rect width="1606" height="30" y="2200" x="2179"></svg:rect><svg:text y="2215" x="2982">case ((((\v16 -&gt; (\t5 -&gt; case (v16) of {CtxHole  -&gt; (Val t5); CtxLeft w6 t7 r -&gt; ((decTerm r) (CtxRight w6 t5 t7)); CtxRight p4 u1 x15 -&gt; (Dec (PotRed p4 u1 t5) x15);})) s10) ((z2 t3) s))) of {Val z16 -&gt; z16; Dec z14 r16 -&gt; (iterate ((decTerm (contract z14)) r16));}</svg:text><svg:line x2="2982" y2="2300" x1="2982" y1="2230"></svg:line><svg:rect width="1546" height="30" y="2300" x="2209"></svg:rect><svg:text y="2315" x="2982">case (((\r10 -&gt; case (s10) of {CtxHole  -&gt; (Val r10); CtxLeft u11 r12 v9 -&gt; ((decTerm v9) (CtxRight u11 r10 r12)); CtxRight t1 w3 x2 -&gt; (Dec (PotRed t1 w3 r10) x2);}) ((z2 t3) s))) of {Val u14 -&gt; u14; Dec u13 x3 -&gt; (iterate ((decTerm (contract u13)) x3));}</svg:text><svg:line x2="2982" y2="2400" x1="2982" y1="2330"></svg:line><svg:rect width="1552" height="30" y="2400" x="2206"></svg:rect><svg:text y="2415" x="2982">let r9=((z2 t3) s), p11=s10
 in case (case (p11) of {CtxHole  -&gt; (Val r9); CtxLeft x17 u5 y5 -&gt; ((decTerm y5) (CtxRight x17 r9 u5)); CtxRight z2 t3 s10 -&gt; (Dec (PotRed z2 t3 r9) s10);}) of {Dec z8 s7 -&gt; (iterate ((decTerm (contract z8)) s7)); Val z5 -&gt; z5;}</svg:text><svg:line x2="2889" y2="2500" x1="2982" y1="2430"></svg:line><svg:rect width="1360" height="30" y="2500" x="2209"></svg:rect><svg:text y="2515" x="2889">case (case (p11) of {CtxHole  -&gt; (Val r9); CtxLeft x17 u5 y5 -&gt; ((decTerm y5) (CtxRight x17 r9 u5)); CtxRight z2 t3 s10 -&gt; (Dec (PotRed z2 t3 r9) s10);}) of {Dec z8 s7 -&gt; (iterate ((decTerm (contract z8)) s7)); Val z5 -&gt; z5;}</svg:text><svg:line x2="3648" y2="2500" x1="2982" y1="2430"></svg:line><svg:rect width="76" height="30" y="2500" x="3610"></svg:rect><svg:text y="2515" x="3648">((z2 t3) s)</svg:text><svg:line x2="3620" y2="2600" x1="3648" y1="2530"></svg:line><svg:rect width="22" height="30" y="2600" x="3609"></svg:rect><svg:text y="2615" x="3620">t3</svg:text><svg:line x2="3679" y2="2600" x1="3648" y1="2530"></svg:line><svg:rect width="16" height="30" y="2600" x="3671"></svg:rect><svg:text y="2615" x="3679">s</svg:text><svg:line x2="3741" y2="2500" x1="2982" y1="2430"></svg:line><svg:rect width="28" height="30" y="2500" x="3727"></svg:rect><svg:text y="2515" x="3741">s10</svg:text><svg:line x2="4497" y2="700" x1="2590" y1="630"></svg:line><svg:rect width="712" height="30" y="700" x="4141"></svg:rect><svg:text y="715" x="4497">case (((decTerm z4) (CtxLeft w2 w10 p1))) of {Dec w1 s16 -&gt; (iterate ((decTerm (contract w1)) s16)); Val y17 -&gt; y17;}</svg:text><svg:line x2="4497" y2="800" x1="4497" y1="730"></svg:line><svg:rect width="1324" height="30" y="800" x="3835"></svg:rect><svg:text y="815" x="4497">case ((((\w -&gt; (\t4 -&gt; case (w) of {Cst u3 -&gt; ((decCtx t4) u3); Opr p3 v4 t8 -&gt; ((decTerm v4) (CtxLeft p3 t4 t8));})) z4) (CtxLeft w2 w10 p1))) of {Dec w1 s16 -&gt; (iterate ((decTerm (contract w1)) s16)); Val y17 -&gt; y17;}</svg:text><svg:line x2="4497" y2="900" x1="4497" y1="830"></svg:line><svg:rect width="1252" height="30" y="900" x="3871"></svg:rect><svg:text y="915" x="4497">case (((\r8 -&gt; case (z4) of {Cst w5 -&gt; ((decCtx r8) w5); Opr y11 r6 v7 -&gt; ((decTerm r6) (CtxLeft y11 r8 v7));}) (CtxLeft w2 w10 p1))) of {Dec x6 p5 -&gt; (iterate ((decTerm (contract x6)) p5)); Val s15 -&gt; s15;}</svg:text><svg:line x2="4497" y2="1000" x1="4497" y1="930"></svg:line><svg:rect width="1306" height="30" y="1000" x="3844"></svg:rect><svg:text y="1015" x="4497">let t13=z4, y6=(CtxLeft w2 w10 p1)
 in case (case (t13) of {Cst s -&gt; ((decCtx y6) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 y6 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="4370" y2="1100" x1="4497" y1="1030"></svg:line><svg:rect width="1072" height="30" y="1100" x="3834"></svg:rect><svg:text y="1115" x="4370">case (case (t13) of {Cst s -&gt; ((decCtx y6) s); Opr w2 z4 p1 -&gt; ((decTerm z4) (CtxLeft w2 y6 p1));}) of {Dec u16 x14 -&gt; (iterate ((decTerm (contract u16)) x14)); Val z15 -&gt; z15;}</svg:text><svg:line x2="4957" y2="1100" x1="4497" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="4946"></svg:rect><svg:text y="1115" x="4957">z4</svg:text><svg:line x2="5084" y2="1100" x1="4497" y1="1030"></svg:line><svg:rect width="124" height="30" y="1100" x="5022"></svg:rect><svg:text y="1115" x="5084">(CtxLeft w2 w10 p1)</svg:text><svg:line x2="5019" y2="1200" x1="5084" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="5008"></svg:rect><svg:text y="1215" x="5019">w2</svg:text><svg:line x2="5084" y2="1200" x1="5084" y1="1130"></svg:line><svg:rect width="28" height="30" y="1200" x="5070"></svg:rect><svg:text y="1215" x="5084">w10</svg:text><svg:line x2="5149" y2="1200" x1="5084" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="5138"></svg:rect><svg:text y="1215" x="5149">p1</svg:text><svg:line x2="5232" y2="600" x1="2670" y1="530"></svg:line><svg:rect width="64" height="30" y="600" x="5200"></svg:rect><svg:text y="615" x="5232">(CtxHole)</svg:text><svg:line x2="5312" y2="600" x1="2670" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="5304"></svg:rect><svg:text y="615" x="5312">t</svg:text>
    <svg:path d="M 760, 1515 C 0, 1515 0, 615 2051, 615" style="stroke:black;"></svg:path><svg:path d="M 3569, 2515 C 3814, 2515 3814, 1015 2609, 1015" style="stroke:black;"></svg:path><svg:path d="M 4906, 1115 C 5180, 1115 5180, 615 3129, 615" style="stroke:black;"></svg:path>
    </svg:svg>