<svg:svg width="2064" height="930" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="568" height="30" y="0" x="748"></svg:rect><svg:text y="15" x="1032">case (((append v9) (join v10))) of {Cons v3 v4 -&gt; (Cons (f v3) ((map f) v4)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1032" y2="100" x1="1032" y1="30"></svg:line><svg:rect width="1048" height="30" y="100" x="508"></svg:rect><svg:text y="115" x="1032">case ((((\v2 -&gt; (\p1 -&gt; case (v2) of {Nil  -&gt; p1; Cons w1 u2 -&gt; (Cons w1 ((append u2) p1));})) v9) (join v10))) of {Cons v3 v4 -&gt; (Cons (f v3) ((map f) v4)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1032" y2="200" x1="1032" y1="130"></svg:line><svg:rect width="934" height="30" y="200" x="565"></svg:rect><svg:text y="215" x="1032">case (((\u -&gt; case (v9) of {Nil  -&gt; u; Cons y3 t1 -&gt; (Cons y3 ((append t1) u));}) (join v10))) of {Cons p2 t -&gt; (Cons (f p2) ((map f) t)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1032" y2="300" x1="1032" y1="230"></svg:line><svg:rect width="904" height="30" y="300" x="580"></svg:rect><svg:text y="315" x="1032">case (case (v9) of {Nil  -&gt; (join v10); Cons y u3 -&gt; (Cons y ((append u3) (join v10)));}) of {Cons y2 w -&gt; (Cons (f y2) ((map f) w)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="31" y2="400" x1="1032" y1="330"></svg:line><svg:rect width="22" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="31">v9</svg:text><svg:line x2="638" y2="400" x1="1032" y1="330"></svg:line><svg:rect width="484" height="30" y="400" x="396"></svg:rect><svg:text y="415" x="638">case ((join v10)) of {Cons y1 w2 -&gt; (Cons (f y1) ((map f) w2)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="638" y2="500" x1="638" y1="430"></svg:line><svg:rect width="910" height="30" y="500" x="183"></svg:rect><svg:text y="515" x="638">case (((\x2 -&gt; case (x2) of {Nil  -&gt; (Nil); Cons s z1 -&gt; ((append s) (join z1));}) v10)) of {Cons y1 w2 -&gt; (Cons (f y1) ((map f) w2)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="638" y2="600" x1="638" y1="530"></svg:line><svg:rect width="826" height="30" y="600" x="225"></svg:rect><svg:text y="615" x="638">case (case (v10) of {Nil  -&gt; (Nil); Cons z2 r3 -&gt; ((append z2) (join r3));}) of {Cons r2 z -&gt; (Cons (f r2) ((map f) z)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="96" y2="700" x1="638" y1="630"></svg:line><svg:rect width="28" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="96">v10</svg:text><svg:line x2="377" y2="700" x1="638" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="150"></svg:rect><svg:text y="715" x="377">case ((Nil)) of {Cons s2 w3 -&gt; (Cons (f s2) ((map f) w3)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="377" y2="800" x1="377" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="357"></svg:rect><svg:text y="815" x="377">(Nil)</svg:text><svg:line x2="919" y2="700" x1="638" y1="630"></svg:line><svg:rect width="550" height="30" y="700" x="644"></svg:rect><svg:text y="715" x="919">case (((append z2) (join r3))) of {Cons p u1 -&gt; (Cons (f p) ((map f) u1)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1639" y2="400" x1="1032" y1="330"></svg:line><svg:rect width="610" height="30" y="400" x="1334"></svg:rect><svg:text y="415" x="1639">case ((Cons y ((append u3) (join v10)))) of {Cons v t2 -&gt; (Cons (f v) ((map f) t2)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1639" y2="500" x1="1639" y1="430"></svg:line><svg:rect width="292" height="30" y="500" x="1493"></svg:rect><svg:text y="515" x="1639">(Cons (f y) ((map f) ((append u3) (join v10))))</svg:text><svg:line x2="1254" y2="600" x1="1639" y1="530"></svg:line><svg:rect width="40" height="30" y="600" x="1234"></svg:rect><svg:text y="615" x="1254">(f y)</svg:text><svg:line x2="1254" y2="700" x1="1254" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="1246"></svg:rect><svg:text y="715" x="1254">y</svg:text><svg:line x2="1679" y2="600" x1="1639" y1="530"></svg:line><svg:rect width="214" height="30" y="600" x="1572"></svg:rect><svg:text y="615" x="1679">((map f) ((append u3) (join v10)))</svg:text><svg:line x2="1679" y2="700" x1="1679" y1="630"></svg:line><svg:rect width="730" height="30" y="700" x="1314"></svg:rect><svg:text y="715" x="1679">(((\r1 -&gt; (\s1 -&gt; case (s1) of {Nil  -&gt; (Nil); Cons x1 x -&gt; (Cons (r1 x1) ((map r1) x));})) f) ((append u3) (join v10)))</svg:text><svg:line x2="1679" y2="800" x1="1679" y1="730"></svg:line><svg:rect width="652" height="30" y="800" x="1353"></svg:rect><svg:text y="815" x="1679">((\x3 -&gt; case (x3) of {Nil  -&gt; (Nil); Cons z3 p3 -&gt; (Cons (f z3) ((map f) p3));}) ((append u3) (join v10)))</svg:text><svg:line x2="1679" y2="900" x1="1679" y1="830"></svg:line><svg:rect width="556" height="30" y="900" x="1401"></svg:rect><svg:text y="915" x="1679">case (((append u3) (join v10))) of {Nil  -&gt; (Nil); Cons r v1 -&gt; (Cons (f r) ((map f) v1));}</svg:text>
    <svg:path d="M 644, 715 C 0, 715 0, 15 748, 15" style="stroke:black;"></svg:path><svg:path d="M 1957, 915 C 2064, 915 2064, 15 1316, 15" style="stroke:black;"></svg:path>
    </svg:svg>