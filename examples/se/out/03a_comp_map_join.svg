<svg:svg width="1926" height="1230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="478" height="30" y="0" x="724"></svg:rect><svg:text y="15" x="963">case ((join xs)) of {Cons v3 v4 -&gt; (Cons (f v3) ((map f) v4)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="963" y2="100" x1="963" y1="30"></svg:line><svg:rect width="916" height="30" y="100" x="505"></svg:rect><svg:text y="115" x="963">case (((\w1 -&gt; case (w1) of {Nil  -&gt; (Nil); Cons t2 y3 -&gt; ((append t2) (join y3));}) xs)) of {Cons v3 v4 -&gt; (Cons (f v3) ((map f) v4)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="963" y2="200" x1="963" y1="130"></svg:line><svg:rect width="820" height="30" y="200" x="553"></svg:rect><svg:text y="215" x="963">case (case (xs) of {Nil  -&gt; (Nil); Cons w x1 -&gt; ((append w) (join x1));}) of {Cons z3 p2 -&gt; (Cons (f z3) ((map f) p2)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="31" y2="300" x1="963" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">xs</svg:text><svg:line x2="303" y2="300" x1="963" y1="230"></svg:line><svg:rect width="442" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="303">case ((Nil)) of {Cons p1 y -&gt; (Cons (f p1) ((map f) y)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="303" y2="400" x1="303" y1="330"></svg:line><svg:rect width="40" height="30" y="400" x="283"></svg:rect><svg:text y="415" x="303">(Nil)</svg:text><svg:line x2="1235" y2="300" x1="963" y1="230"></svg:line><svg:rect width="544" height="30" y="300" x="963"></svg:rect><svg:text y="315" x="1235">case (((append w) (join x1))) of {Cons x3 z -&gt; (Cons (f x3) ((map f) z)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1235" y2="400" x1="1235" y1="330"></svg:line><svg:rect width="1012" height="30" y="400" x="729"></svg:rect><svg:text y="415" x="1235">case ((((\u2 -&gt; (\r3 -&gt; case (u2) of {Nil  -&gt; r3; Cons p z1 -&gt; (Cons p ((append z1) r3));})) w) (join x1))) of {Cons x3 z -&gt; (Cons (f x3) ((map f) z)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1235" y2="500" x1="1235" y1="430"></svg:line><svg:rect width="940" height="30" y="500" x="765"></svg:rect><svg:text y="515" x="1235">case (((\w2 -&gt; case (w) of {Nil  -&gt; w2; Cons u3 v2 -&gt; (Cons u3 ((append v2) w2));}) (join x1))) of {Cons r1 u -&gt; (Cons (f r1) ((map f) u)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1235" y2="600" x1="1235" y1="530"></svg:line><svg:rect width="910" height="30" y="600" x="780"></svg:rect><svg:text y="615" x="1235">case (case (w) of {Nil  -&gt; (join x1); Cons y1 s2 -&gt; (Cons y1 ((append s2) (join x1)));}) of {Cons y2 p3 -&gt; (Cons (f y2) ((map f) p3)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="572" y2="700" x1="1235" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="564"></svg:rect><svg:text y="715" x="572">w</svg:text><svg:line x2="853" y2="700" x1="1235" y1="630"></svg:line><svg:rect width="466" height="30" y="700" x="620"></svg:rect><svg:text y="715" x="853">case ((join x1)) of {Cons r v1 -&gt; (Cons (f r) ((map f) v1)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1516" y2="700" x1="1235" y1="630"></svg:line><svg:rect width="622" height="30" y="700" x="1205"></svg:rect><svg:text y="715" x="1516">case ((Cons y1 ((append s2) (join x1)))) of {Cons r2 x2 -&gt; (Cons (f r2) ((map f) x2)); Nil  -&gt; (Nil);}</svg:text><svg:line x2="1516" y2="800" x1="1516" y1="730"></svg:line><svg:rect width="292" height="30" y="800" x="1370"></svg:rect><svg:text y="815" x="1516">(Cons (f y1) ((map f) ((append s2) (join x1))))</svg:text><svg:line x2="1149" y2="900" x1="1516" y1="830"></svg:line><svg:rect width="46" height="30" y="900" x="1126"></svg:rect><svg:text y="915" x="1149">(f y1)</svg:text><svg:line x2="1149" y2="1000" x1="1149" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="1138"></svg:rect><svg:text y="1015" x="1149">y1</svg:text><svg:line x2="1559" y2="900" x1="1516" y1="830"></svg:line><svg:rect width="208" height="30" y="900" x="1455"></svg:rect><svg:text y="915" x="1559">((map f) ((append s2) (join x1)))</svg:text><svg:line x2="1559" y2="1000" x1="1559" y1="930"></svg:line><svg:rect width="694" height="30" y="1000" x="1212"></svg:rect><svg:text y="1015" x="1559">(((\t -&gt; (\x -&gt; case (x) of {Nil  -&gt; (Nil); Cons v u1 -&gt; (Cons (t v) ((map t) u1));})) f) ((append s2) (join x1)))</svg:text><svg:line x2="1559" y2="1100" x1="1559" y1="1030"></svg:line><svg:rect width="646" height="30" y="1100" x="1236"></svg:rect><svg:text y="1115" x="1559">((\z2 -&gt; case (z2) of {Nil  -&gt; (Nil); Cons t1 w3 -&gt; (Cons (f t1) ((map f) w3));}) ((append s2) (join x1)))</svg:text><svg:line x2="1559" y2="1200" x1="1559" y1="1130"></svg:line><svg:rect width="550" height="30" y="1200" x="1284"></svg:rect><svg:text y="1215" x="1559">case (((append s2) (join x1))) of {Nil  -&gt; (Nil); Cons s s1 -&gt; (Cons (f s) ((map f) s1));}</svg:text>
    <svg:path d="M 1834, 1215 C 1926, 1215 1926, 315 1507, 315" style="stroke:black;"></svg:path><svg:path d="M 620, 715 C 0, 715 0, 15 724, 15" style="stroke:black;"></svg:path>
    </svg:svg>