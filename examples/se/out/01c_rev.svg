<svg:svg width="3698" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="760" height="30" y="0" x="1469"></svg:rect><svg:text y="15" x="1849">case (((app (rev v24)) (Cons v23 (Nil)))) of {Cons v9 v10 -&gt; (Cons v9 ((app v10) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="1849" y2="100" x1="1849" y1="30"></svg:line><svg:rect width="1240" height="30" y="100" x="1229"></svg:rect><svg:text y="115" x="1849">case ((((\x1 -&gt; (\t3 -&gt; case (x1) of {Nil  -&gt; t3; Cons v5 s4 -&gt; (Cons v5 ((app s4) t3));})) (rev v24)) (Cons v23 (Nil)))) of {Cons v9 v10 -&gt; (Cons v9 ((app v10) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="1849" y2="200" x1="1849" y1="130"></svg:line><svg:rect width="1132" height="30" y="200" x="1283"></svg:rect><svg:text y="215" x="1849">case (((\y1 -&gt; case ((rev v24)) of {Nil  -&gt; y1; Cons y7 u7 -&gt; (Cons y7 ((app u7) y1));}) (Cons v23 (Nil)))) of {Cons t x3 -&gt; (Cons t ((app x3) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="1849" y2="300" x1="1849" y1="230"></svg:line><svg:rect width="1216" height="30" y="300" x="1241"></svg:rect><svg:text y="315" x="1849">let z=(rev v24)
 in case (case (z) of {Cons z6 s1 -&gt; (Cons z6 ((app s1) (Cons v23 (Nil)))); Nil  -&gt; (Cons v23 (Nil));}) of {Cons s3 z4 -&gt; (Cons s3 ((app z4) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="1052" y2="400" x1="1849" y1="330"></svg:line><svg:rect width="1096" height="30" y="400" x="504"></svg:rect><svg:text y="415" x="1052">case (case (z) of {Cons z6 s1 -&gt; (Cons z6 ((app s1) (Cons v23 (Nil)))); Nil  -&gt; (Cons v23 (Nil));}) of {Cons s3 z4 -&gt; (Cons s3 ((app z4) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="28" y2="500" x1="1052" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="28">z</svg:text><svg:line x2="694" y2="500" x1="1052" y1="430"></svg:line><svg:rect width="766" height="30" y="500" x="311"></svg:rect><svg:text y="515" x="694">case ((Cons z6 ((app s1) (Cons v23 (Nil))))) of {Cons s6 t4 -&gt; (Cons s6 ((app t4) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="694" y2="600" x1="694" y1="530"></svg:line><svg:rect width="376" height="30" y="600" x="506"></svg:rect><svg:text y="615" x="694">(Cons z6 ((app ((app s1) (Cons v23 (Nil)))) (Cons v2 (Nil))))</svg:text><svg:line x2="87" y2="700" x1="694" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="76"></svg:rect><svg:text y="715" x="87">z6</svg:text><svg:line x2="725" y2="700" x1="694" y1="630"></svg:line><svg:rect width="316" height="30" y="700" x="567"></svg:rect><svg:text y="715" x="725">((app ((app s1) (Cons v23 (Nil)))) (Cons v2 (Nil)))</svg:text><svg:line x2="725" y2="800" x1="725" y1="730"></svg:line><svg:rect width="796" height="30" y="800" x="327"></svg:rect><svg:text y="815" x="725">(((\r2 -&gt; (\p3 -&gt; case (r2) of {Nil  -&gt; p3; Cons r5 v7 -&gt; (Cons r5 ((app v7) p3));})) ((app s1) (Cons v23 (Nil)))) (Cons v2 (Nil)))</svg:text><svg:line x2="725" y2="900" x1="725" y1="830"></svg:line><svg:rect width="712" height="30" y="900" x="369"></svg:rect><svg:text y="915" x="725">((\z2 -&gt; case (((app s1) (Cons v23 (Nil)))) of {Nil  -&gt; z2; Cons t5 u5 -&gt; (Cons t5 ((app u5) z2));}) (Cons v2 (Nil)))</svg:text><svg:line x2="725" y2="1000" x1="725" y1="930"></svg:line><svg:rect width="694" height="30" y="1000" x="378"></svg:rect><svg:text y="1015" x="725">case (((app s1) (Cons v23 (Nil)))) of {Nil  -&gt; (Cons v2 (Nil)); Cons u3 w -&gt; (Cons u3 ((app w) (Cons v2 (Nil))));}</svg:text><svg:line x2="725" y2="1100" x1="725" y1="1030"></svg:line><svg:rect width="1174" height="30" y="1100" x="138"></svg:rect><svg:text y="1115" x="725">case ((((\v6 -&gt; (\r4 -&gt; case (v6) of {Nil  -&gt; r4; Cons p1 v4 -&gt; (Cons p1 ((app v4) r4));})) s1) (Cons v23 (Nil)))) of {Nil  -&gt; (Cons v2 (Nil)); Cons u3 w -&gt; (Cons u3 ((app w) (Cons v2 (Nil))));}</svg:text><svg:line x2="725" y2="1200" x1="725" y1="1130"></svg:line><svg:rect width="1102" height="30" y="1200" x="174"></svg:rect><svg:text y="1215" x="725">case (((\z5 -&gt; case (s1) of {Nil  -&gt; z5; Cons z7 y2 -&gt; (Cons z7 ((app y2) z5));}) (Cons v23 (Nil)))) of {Nil  -&gt; (Cons v2 (Nil)); Cons y6 p4 -&gt; (Cons y6 ((app p4) (Cons v2 (Nil))));}</svg:text><svg:line x2="725" y2="1300" x1="725" y1="1230"></svg:line><svg:rect width="1078" height="30" y="1300" x="186"></svg:rect><svg:text y="1315" x="725">case (case (s1) of {Nil  -&gt; (Cons v23 (Nil)); Cons y3 v -&gt; (Cons y3 ((app v) (Cons v23 (Nil))));}) of {Nil  -&gt; (Cons v2 (Nil)); Cons w6 u -&gt; (Cons w6 ((app u) (Cons v2 (Nil))));}</svg:text><svg:line x2="1718" y2="500" x1="1052" y1="430"></svg:line><svg:rect width="628" height="30" y="500" x="1404"></svg:rect><svg:text y="515" x="1718">case ((Cons v23 (Nil))) of {Cons s2 r -&gt; (Cons s2 ((app r) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="1718" y2="600" x1="1718" y1="530"></svg:line><svg:rect width="250" height="30" y="600" x="1593"></svg:rect><svg:text y="615" x="1718">(Cons v23 ((app (Nil)) (Cons v2 (Nil))))</svg:text><svg:line x2="1366" y2="700" x1="1718" y1="630"></svg:line><svg:rect width="28" height="30" y="700" x="1352"></svg:rect><svg:text y="715" x="1366">v23</svg:text><svg:line x2="1752" y2="700" x1="1718" y1="630"></svg:line><svg:rect width="184" height="30" y="700" x="1660"></svg:rect><svg:text y="715" x="1752">((app (Nil)) (Cons v2 (Nil)))</svg:text><svg:line x2="1752" y2="800" x1="1752" y1="730"></svg:line><svg:rect width="664" height="30" y="800" x="1420"></svg:rect><svg:text y="815" x="1752">(((\x6 -&gt; (\w1 -&gt; case (x6) of {Nil  -&gt; w1; Cons u4 y5 -&gt; (Cons u4 ((app y5) w1));})) (Nil)) (Cons v2 (Nil)))</svg:text><svg:line x2="1752" y2="900" x1="1752" y1="830"></svg:line><svg:rect width="568" height="30" y="900" x="1468"></svg:rect><svg:text y="915" x="1752">((\p2 -&gt; case ((Nil)) of {Nil  -&gt; p2; Cons z3 s -&gt; (Cons z3 ((app s) p2));}) (Cons v2 (Nil)))</svg:text><svg:line x2="1752" y2="1000" x1="1752" y1="930"></svg:line><svg:rect width="574" height="30" y="1000" x="1465"></svg:rect><svg:text y="1015" x="1752">case ((Nil)) of {Nil  -&gt; (Cons v2 (Nil)); Cons x7 x5 -&gt; (Cons x7 ((app x5) (Cons v2 (Nil))));}</svg:text><svg:line x2="1752" y2="1100" x1="1752" y1="1030"></svg:line><svg:rect width="100" height="30" y="1100" x="1702"></svg:rect><svg:text y="1115" x="1752">(Cons v2 (Nil))</svg:text><svg:line x2="1712" y2="1200" x1="1752" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="1701"></svg:rect><svg:text y="1215" x="1712">v2</svg:text><svg:line x2="1783" y2="1200" x1="1752" y1="1130"></svg:line><svg:rect width="40" height="30" y="1200" x="1763"></svg:rect><svg:text y="1215" x="1783">(Nil)</svg:text><svg:line x2="2901" y2="400" x1="1849" y1="330"></svg:line><svg:rect width="64" height="30" y="400" x="2869"></svg:rect><svg:text y="415" x="2901">(rev v24)</svg:text><svg:line x2="2901" y2="500" x1="2901" y1="430"></svg:line><svg:rect width="562" height="30" y="500" x="2620"></svg:rect><svg:text y="515" x="2901">((\u2 -&gt; case (u2) of {Nil  -&gt; (Nil); Cons r3 u1 -&gt; ((app (rev u1)) (Cons r3 (Nil)));}) v24)</svg:text><svg:line x2="2901" y2="600" x1="2901" y1="530"></svg:line><svg:rect width="478" height="30" y="600" x="2662"></svg:rect><svg:text y="615" x="2901">case (v24) of {Nil  -&gt; (Nil); Cons t6 s5 -&gt; ((app (rev s5)) (Cons t6 (Nil)));}</svg:text><svg:line x2="2138" y2="700" x1="2901" y1="630"></svg:line><svg:rect width="28" height="30" y="700" x="2124"></svg:rect><svg:text y="715" x="2138">v24</svg:text><svg:line x2="2212" y2="700" x1="2901" y1="630"></svg:line><svg:rect width="40" height="30" y="700" x="2192"></svg:rect><svg:text y="715" x="2212">(Nil)</svg:text><svg:line x2="2975" y2="700" x1="2901" y1="630"></svg:line><svg:rect width="202" height="30" y="700" x="2874"></svg:rect><svg:text y="715" x="2975">((app (rev s5)) (Cons t6 (Nil)))</svg:text><svg:line x2="2975" y2="800" x1="2975" y1="730"></svg:line><svg:rect width="664" height="30" y="800" x="2643"></svg:rect><svg:text y="815" x="2975">(((\t1 -&gt; (\y -&gt; case (t1) of {Nil  -&gt; y; Cons p6 w5 -&gt; (Cons p6 ((app w5) y));})) (rev s5)) (Cons t6 (Nil)))</svg:text><svg:line x2="2975" y2="900" x1="2975" y1="830"></svg:line><svg:rect width="580" height="30" y="900" x="2685"></svg:rect><svg:text y="915" x="2975">((\p -&gt; case ((rev s5)) of {Nil  -&gt; p; Cons w3 w4 -&gt; (Cons w3 ((app w4) p));}) (Cons t6 (Nil)))</svg:text><svg:line x2="2975" y2="1000" x1="2975" y1="930"></svg:line><svg:rect width="592" height="30" y="1000" x="2679"></svg:rect><svg:text y="1015" x="2975">case ((rev s5)) of {Nil  -&gt; (Cons t6 (Nil)); Cons y4 z1 -&gt; (Cons y4 ((app z1) (Cons t6 (Nil))));}</svg:text><svg:line x2="2975" y2="1100" x1="2975" y1="1030"></svg:line><svg:rect width="1090" height="30" y="1100" x="2430"></svg:rect><svg:text y="1115" x="2975">case (((\r6 -&gt; case (r6) of {Nil  -&gt; (Nil); Cons p5 x2 -&gt; ((app (rev x2)) (Cons p5 (Nil)));}) s5)) of {Nil  -&gt; (Cons t6 (Nil)); Cons y4 z1 -&gt; (Cons y4 ((app z1) (Cons t6 (Nil))));}</svg:text><svg:line x2="2975" y2="1200" x1="2975" y1="1130"></svg:line><svg:rect width="994" height="30" y="1200" x="2478"></svg:rect><svg:text y="1215" x="2975">case (case (s5) of {Nil  -&gt; (Nil); Cons x u6 -&gt; ((app (rev u6)) (Cons x (Nil)));}) of {Nil  -&gt; (Cons t6 (Nil)); Cons r1 x4 -&gt; (Cons r1 ((app x4) (Cons t6 (Nil))));}</svg:text><svg:line x2="2283" y2="1300" x1="2975" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="2272"></svg:rect><svg:text y="1315" x="2283">s5</svg:text><svg:line x2="2621" y2="1300" x1="2975" y1="1230"></svg:line><svg:rect width="574" height="30" y="1300" x="2334"></svg:rect><svg:text y="1315" x="2621">case ((Nil)) of {Nil  -&gt; (Cons t6 (Nil)); Cons w2 t2 -&gt; (Cons w2 ((app t2) (Cons t6 (Nil))));}</svg:text><svg:line x2="2621" y2="1400" x1="2621" y1="1330"></svg:line><svg:rect width="100" height="30" y="1400" x="2571"></svg:rect><svg:text y="1415" x="2621">(Cons t6 (Nil))</svg:text><svg:line x2="2581" y2="1500" x1="2621" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="2570"></svg:rect><svg:text y="1515" x="2581">t6</svg:text><svg:line x2="2652" y2="1500" x1="2621" y1="1430"></svg:line><svg:rect width="40" height="30" y="1500" x="2632"></svg:rect><svg:text y="1515" x="2652">(Nil)</svg:text><svg:line x2="3313" y2="1300" x1="2975" y1="1230"></svg:line><svg:rect width="730" height="30" y="1300" x="2948"></svg:rect><svg:text y="1315" x="3313">case (((app (rev u6)) (Cons x (Nil)))) of {Nil  -&gt; (Cons t6 (Nil)); Cons v3 v1 -&gt; (Cons v3 ((app v1) (Cons t6 (Nil))));}</svg:text>
    <svg:path d="M 186, 1315 C 0, 1315 0, 415 504, 415" style="stroke:black;"></svg:path><svg:path d="M 3678, 1315 C 3698, 1315 3698, 15 2229, 15" style="stroke:black;"></svg:path>
    </svg:svg>