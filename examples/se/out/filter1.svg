<svg:svg width="1818" height="1130" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="160" height="30" y="0" x="829"></svg:rect><svg:text y="15" x="909">((filter p) ((map f) xs))</svg:text><svg:line x2="909" y2="100" x1="909" y1="30"></svg:line><svg:rect width="988" height="30" y="100" x="415"></svg:rect><svg:text y="115" x="909">(((\v1 -&gt; (\w2 -&gt; case (w2) of {Nil  -&gt; (Nil); Cons u y1 -&gt; case ((v1 u)) of {True  -&gt; (Cons u ((filter v1) y1)); False  -&gt; ((filter v1) y1);};})) p) ((map f) xs))</svg:text><svg:line x2="909" y2="200" x1="909" y1="130"></svg:line><svg:rect width="892" height="30" y="200" x="463"></svg:rect><svg:text y="215" x="909">((\s1 -&gt; case (s1) of {Nil  -&gt; (Nil); Cons z p2 -&gt; case ((p z)) of {True  -&gt; (Cons z ((filter p) p2)); False  -&gt; ((filter p) p2);};}) ((map f) xs))</svg:text><svg:line x2="909" y2="300" x1="909" y1="230"></svg:line><svg:rect width="808" height="30" y="300" x="505"></svg:rect><svg:text y="315" x="909">case (((map f) xs)) of {Nil  -&gt; (Nil); Cons p1 t -&gt; case ((p p1)) of {True  -&gt; (Cons p1 ((filter p) t)); False  -&gt; ((filter p) t);};}</svg:text><svg:line x2="909" y2="400" x1="909" y1="330"></svg:line><svg:rect width="1306" height="30" y="400" x="256"></svg:rect><svg:text y="415" x="909">case ((((\r -&gt; (\y2 -&gt; case (y2) of {Nil  -&gt; (Nil); Cons u2 y -&gt; (Cons (r u2) ((map r) y));})) f) xs)) of {Nil  -&gt; (Nil); Cons p1 t -&gt; case ((p p1)) of {True  -&gt; (Cons p1 ((filter p) t)); False  -&gt; ((filter p) t);};}</svg:text><svg:line x2="909" y2="500" x1="909" y1="430"></svg:line><svg:rect width="1234" height="30" y="500" x="292"></svg:rect><svg:text y="515" x="909">case (((\v -&gt; case (v) of {Nil  -&gt; (Nil); Cons z1 r1 -&gt; (Cons (f z1) ((map f) r1));}) xs)) of {Nil  -&gt; (Nil); Cons w v2 -&gt; case ((p w)) of {True  -&gt; (Cons w ((filter p) v2)); False  -&gt; ((filter p) v2);};}</svg:text><svg:line x2="909" y2="600" x1="909" y1="530"></svg:line><svg:rect width="1162" height="30" y="600" x="328"></svg:rect><svg:text y="615" x="909">case (case (xs) of {Nil  -&gt; (Nil); Cons w1 x1 -&gt; (Cons (f w1) ((map f) x1));}) of {Nil  -&gt; (Nil); Cons s u1 -&gt; case ((p s)) of {True  -&gt; (Cons s ((filter p) u1)); False  -&gt; ((filter p) u1);};}</svg:text><svg:line x2="31" y2="700" x1="909" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">xs</svg:text><svg:line x2="465" y2="700" x1="909" y1="630"></svg:line><svg:rect width="766" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="465">case ((Nil)) of {Nil  -&gt; (Nil); Cons x z2 -&gt; case ((p x)) of {True  -&gt; (Cons x ((filter p) z2)); False  -&gt; ((filter p) z2);};}</svg:text><svg:line x2="465" y2="800" x1="465" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="445"></svg:rect><svg:text y="815" x="465">(Nil)</svg:text><svg:line x2="1343" y2="700" x1="909" y1="630"></svg:line><svg:rect width="910" height="30" y="700" x="888"></svg:rect><svg:text y="715" x="1343">case ((Cons (f w1) ((map f) x1))) of {Nil  -&gt; (Nil); Cons x2 t1 -&gt; case ((p x2)) of {True  -&gt; (Cons x2 ((filter p) t1)); False  -&gt; ((filter p) t1);};}</svg:text><svg:line x2="1343" y2="800" x1="1343" y1="730"></svg:line><svg:rect width="664" height="30" y="800" x="1011"></svg:rect><svg:text y="815" x="1343">case ((p (f w1))) of {True  -&gt; (Cons (f w1) ((filter p) ((map f) x1))); False  -&gt; ((filter p) ((map f) x1));}</svg:text><svg:line x2="1100" y2="900" x1="1343" y1="830"></svg:line><svg:rect width="70" height="30" y="900" x="1065"></svg:rect><svg:text y="915" x="1100">(p (f w1))</svg:text><svg:line x2="1100" y2="1000" x1="1100" y1="930"></svg:line><svg:rect width="46" height="30" y="1000" x="1077"></svg:rect><svg:text y="1015" x="1100">(f w1)</svg:text><svg:line x2="1100" y2="1100" x1="1100" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="1089"></svg:rect><svg:text y="1115" x="1100">w1</svg:text><svg:line x2="1298" y2="900" x1="1343" y1="830"></svg:line><svg:rect width="244" height="30" y="900" x="1176"></svg:rect><svg:text y="915" x="1298">(Cons (f w1) ((filter p) ((map f) x1)))</svg:text><svg:line x2="1198" y2="1000" x1="1298" y1="930"></svg:line><svg:rect width="46" height="30" y="1000" x="1175"></svg:rect><svg:text y="1015" x="1198">(f w1)</svg:text><svg:line x2="1198" y2="1100" x1="1198" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="1187"></svg:rect><svg:text y="1115" x="1198">w1</svg:text><svg:line x2="1341" y2="1000" x1="1298" y1="930"></svg:line><svg:rect width="160" height="30" y="1000" x="1261"></svg:rect><svg:text y="1015" x="1341">((filter p) ((map f) x1))</svg:text><svg:line x2="1541" y2="900" x1="1343" y1="830"></svg:line><svg:rect width="160" height="30" y="900" x="1461"></svg:rect><svg:text y="915" x="1541">((filter p) ((map f) x1))</svg:text>
    <svg:path d="M 1421, 1015 C 1818, 1015 1818, 15 989, 15" style="stroke:black;"></svg:path><svg:path d="M 1621, 915 C 1818, 915 1818, 15 989, 15" style="stroke:black;"></svg:path>
    </svg:svg>