<svg:svg width="1168" height="1230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="58" height="30" y="0" x="555"></svg:rect><svg:text y="15" x="584">(rev xs)</svg:text><svg:line x2="584" y2="100" x1="584" y1="30"></svg:line><svg:rect width="544" height="30" y="100" x="312"></svg:rect><svg:text y="115" x="584">((\r1 -&gt; case (r1) of {Nil  -&gt; (Nil); Cons z x2 -&gt; ((app (rev x2)) (Cons z (Nil)));}) xs)</svg:text><svg:line x2="584" y2="200" x1="584" y1="130"></svg:line><svg:rect width="460" height="30" y="200" x="354"></svg:rect><svg:text y="215" x="584">case (xs) of {Nil  -&gt; (Nil); Cons u1 s -&gt; ((app (rev s)) (Cons u1 (Nil)));}</svg:text><svg:line x2="31" y2="300" x1="584" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">xs</svg:text><svg:line x2="102" y2="300" x1="584" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="655" y2="300" x1="584" y1="230"></svg:line><svg:rect width="196" height="30" y="300" x="557"></svg:rect><svg:text y="315" x="655">((app (rev s)) (Cons u1 (Nil)))</svg:text><svg:line x2="655" y2="400" x1="655" y1="330"></svg:line><svg:rect width="652" height="30" y="400" x="329"></svg:rect><svg:text y="415" x="655">(((\x -&gt; (\t1 -&gt; case (x) of {Nil  -&gt; t1; Cons z2 w -&gt; (Cons z2 ((app w) t1));})) (rev s)) (Cons u1 (Nil)))</svg:text><svg:line x2="655" y2="500" x1="655" y1="430"></svg:line><svg:rect width="574" height="30" y="500" x="368"></svg:rect><svg:text y="515" x="655">((\r -&gt; case ((rev s)) of {Nil  -&gt; r; Cons y1 w1 -&gt; (Cons y1 ((app w1) r));}) (Cons u1 (Nil)))</svg:text><svg:line x2="655" y2="600" x1="655" y1="530"></svg:line><svg:rect width="658" height="30" y="600" x="326"></svg:rect><svg:text y="615" x="655">let y2=(rev s)
 in case (y2) of {Cons z1 p -&gt; (Cons z1 ((app p) (Cons u1 (Nil)))); Nil  -&gt; (Cons u1 (Nil));}</svg:text><svg:line x2="609" y2="700" x1="655" y1="630"></svg:line><svg:rect width="544" height="30" y="700" x="337"></svg:rect><svg:text y="715" x="609">case (y2) of {Cons z1 p -&gt; (Cons z1 ((app p) (Cons u1 (Nil)))); Nil  -&gt; (Cons u1 (Nil));}</svg:text><svg:line x2="173" y2="800" x1="609" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="162"></svg:rect><svg:text y="815" x="173">y2</svg:text><svg:line x2="569" y2="800" x1="609" y1="730"></svg:line><svg:rect width="220" height="30" y="800" x="459"></svg:rect><svg:text y="815" x="569">(Cons z1 ((app p) (Cons u1 (Nil))))</svg:text><svg:line x2="235" y2="900" x1="569" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="224"></svg:rect><svg:text y="915" x="235">z1</svg:text><svg:line x2="600" y2="900" x1="569" y1="830"></svg:line><svg:rect width="160" height="30" y="900" x="520"></svg:rect><svg:text y="915" x="600">((app p) (Cons u1 (Nil)))</svg:text><svg:line x2="600" y2="1000" x1="600" y1="930"></svg:line><svg:rect width="628" height="30" y="1000" x="286"></svg:rect><svg:text y="1015" x="600">(((\u -&gt; (\s1 -&gt; case (u) of {Nil  -&gt; s1; Cons u2 x1 -&gt; (Cons u2 ((app x1) s1));})) p) (Cons u1 (Nil)))</svg:text><svg:line x2="600" y2="1100" x1="600" y1="1030"></svg:line><svg:rect width="532" height="30" y="1100" x="334"></svg:rect><svg:text y="1115" x="600">((\v1 -&gt; case (p) of {Nil  -&gt; v1; Cons t v -&gt; (Cons t ((app v) v1));}) (Cons u1 (Nil)))</svg:text><svg:line x2="600" y2="1200" x1="600" y1="1130"></svg:line><svg:rect width="538" height="30" y="1200" x="331"></svg:rect><svg:text y="1215" x="600">case (p) of {Nil  -&gt; (Cons u1 (Nil)); Cons y p1 -&gt; (Cons y ((app p1) (Cons u1 (Nil))));}</svg:text><svg:line x2="1005" y2="800" x1="609" y1="730"></svg:line><svg:rect width="100" height="30" y="800" x="955"></svg:rect><svg:text y="815" x="1005">(Cons u1 (Nil))</svg:text><svg:line x2="965" y2="900" x1="1005" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="954"></svg:rect><svg:text y="915" x="965">u1</svg:text><svg:line x2="1036" y2="900" x1="1005" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="1016"></svg:rect><svg:text y="915" x="1036">(Nil)</svg:text><svg:line x2="1122" y2="700" x1="655" y1="630"></svg:line><svg:rect width="52" height="30" y="700" x="1096"></svg:rect><svg:text y="715" x="1122">(rev s)</svg:text>
    <svg:path d="M 331, 1215 C 142, 1215 142, 715 337, 715" style="stroke:black;"></svg:path><svg:path d="M 1148, 715 C 1168, 715 1168, 15 613, 15" style="stroke:black;"></svg:path>
    </svg:svg>