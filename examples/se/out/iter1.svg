<svg:svg width="1968" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="124" height="30" y="0" x="922"></svg:rect><svg:text y="15" x="984">((map f) (join xs))</svg:text><svg:line x2="984" y2="100" x1="984" y1="30"></svg:line><svg:rect width="634" height="30" y="100" x="667"></svg:rect><svg:text y="115" x="984">(((\p -&gt; (\s1 -&gt; case (s1) of {Nil  -&gt; (Nil); Cons y3 t2 -&gt; (Cons (p y3) ((map p) t2));})) f) (join xs))</svg:text><svg:line x2="984" y2="200" x1="984" y1="130"></svg:line><svg:rect width="550" height="30" y="200" x="709"></svg:rect><svg:text y="215" x="984">((\t1 -&gt; case (t1) of {Nil  -&gt; (Nil); Cons u p3 -&gt; (Cons (f u) ((map f) p3));}) (join xs))</svg:text><svg:line x2="984" y2="300" x1="984" y1="230"></svg:line><svg:rect width="478" height="30" y="300" x="745"></svg:rect><svg:text y="315" x="984">case ((join xs)) of {Nil  -&gt; (Nil); Cons r2 v1 -&gt; (Cons (f r2) ((map f) v1));}</svg:text><svg:line x2="984" y2="400" x1="984" y1="330"></svg:line><svg:rect width="904" height="30" y="400" x="532"></svg:rect><svg:text y="415" x="984">case (((\z3 -&gt; case (z3) of {Nil  -&gt; (Nil); Cons s3 w -&gt; ((append s3) (join w));}) xs)) of {Nil  -&gt; (Nil); Cons r2 v1 -&gt; (Cons (f r2) ((map f) v1));}</svg:text><svg:line x2="984" y2="500" x1="984" y1="430"></svg:line><svg:rect width="832" height="30" y="500" x="568"></svg:rect><svg:text y="515" x="984">case (case (xs) of {Nil  -&gt; (Nil); Cons w1 v2 -&gt; ((append w1) (join v2));}) of {Nil  -&gt; (Nil); Cons v3 x2 -&gt; (Cons (f v3) ((map f) x2));}</svg:text><svg:line x2="31" y2="600" x1="984" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="20"></svg:rect><svg:text y="615" x="31">xs</svg:text><svg:line x2="303" y2="600" x1="984" y1="530"></svg:line><svg:rect width="442" height="30" y="600" x="82"></svg:rect><svg:text y="615" x="303">case ((Nil)) of {Nil  -&gt; (Nil); Cons y z4 -&gt; (Cons (f y) ((map f) z4));}</svg:text><svg:line x2="303" y2="700" x1="303" y1="630"></svg:line><svg:rect width="40" height="30" y="700" x="283"></svg:rect><svg:text y="715" x="303">(Nil)</svg:text><svg:line x2="1256" y2="600" x1="984" y1="530"></svg:line><svg:rect width="562" height="30" y="600" x="975"></svg:rect><svg:text y="615" x="1256">case (((append w1) (join v2))) of {Nil  -&gt; (Nil); Cons s2 y1 -&gt; (Cons (f s2) ((map f) y1));}</svg:text><svg:line x2="1256" y2="700" x1="1256" y1="630"></svg:line><svg:rect width="1024" height="30" y="700" x="744"></svg:rect><svg:text y="715" x="1256">case ((((\u4 -&gt; (\z -&gt; case (u4) of {Nil  -&gt; z; Cons p1 w2 -&gt; (Cons p1 ((append w2) z));})) w1) (join v2))) of {Nil  -&gt; (Nil); Cons s2 y1 -&gt; (Cons (f s2) ((map f) y1));}</svg:text><svg:line x2="1256" y2="800" x1="1256" y1="730"></svg:line><svg:rect width="946" height="30" y="800" x="783"></svg:rect><svg:text y="815" x="1256">case (((\t3 -&gt; case (w1) of {Nil  -&gt; t3; Cons x1 x -&gt; (Cons x1 ((append x) t3));}) (join v2))) of {Nil  -&gt; (Nil); Cons v4 w3 -&gt; (Cons (f v4) ((map f) w3));}</svg:text><svg:line x2="1256" y2="900" x1="1256" y1="830"></svg:line><svg:rect width="892" height="30" y="900" x="810"></svg:rect><svg:text y="915" x="1256">case (case (w1) of {Nil  -&gt; (join v2); Cons t u2 -&gt; (Cons t ((append u2) (join v2)));}) of {Nil  -&gt; (Nil); Cons y4 r -&gt; (Cons (f y4) ((map f) r));}</svg:text><svg:line x2="575" y2="1000" x1="1256" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="564"></svg:rect><svg:text y="1015" x="575">w1</svg:text><svg:line x2="865" y2="1000" x1="1256" y1="930"></svg:line><svg:rect width="478" height="30" y="1000" x="626"></svg:rect><svg:text y="1015" x="865">case ((join v2)) of {Nil  -&gt; (Nil); Cons y2 p2 -&gt; (Cons (f y2) ((map f) p2));}</svg:text><svg:line x2="1546" y2="1000" x1="1256" y1="930"></svg:line><svg:rect width="604" height="30" y="1000" x="1244"></svg:rect><svg:text y="1015" x="1546">case ((Cons t ((append u2) (join v2)))) of {Nil  -&gt; (Nil); Cons r3 v -&gt; (Cons (f r3) ((map f) v));}</svg:text><svg:line x2="1546" y2="1100" x1="1546" y1="1030"></svg:line><svg:rect width="286" height="30" y="1100" x="1403"></svg:rect><svg:text y="1115" x="1546">(Cons (f t) ((map f) ((append u2) (join v2))))</svg:text><svg:line x2="1164" y2="1200" x1="1546" y1="1130"></svg:line><svg:rect width="40" height="30" y="1200" x="1144"></svg:rect><svg:text y="1215" x="1164">(f t)</svg:text><svg:line x2="1164" y2="1300" x1="1164" y1="1230"></svg:line><svg:rect width="16" height="30" y="1300" x="1156"></svg:rect><svg:text y="1315" x="1164">t</svg:text><svg:line x2="1586" y2="1200" x1="1546" y1="1130"></svg:line><svg:rect width="208" height="30" y="1200" x="1482"></svg:rect><svg:text y="1215" x="1586">((map f) ((append u2) (join v2)))</svg:text><svg:line x2="1586" y2="1300" x1="1586" y1="1230"></svg:line><svg:rect width="724" height="30" y="1300" x="1224"></svg:rect><svg:text y="1315" x="1586">(((\x4 -&gt; (\s -&gt; case (s) of {Nil  -&gt; (Nil); Cons u3 r1 -&gt; (Cons (x4 u3) ((map x4) r1));})) f) ((append u2) (join v2)))</svg:text><svg:line x2="1586" y2="1400" x1="1586" y1="1330"></svg:line><svg:rect width="646" height="30" y="1400" x="1263"></svg:rect><svg:text y="1415" x="1586">((\z2 -&gt; case (z2) of {Nil  -&gt; (Nil); Cons z1 u1 -&gt; (Cons (f z1) ((map f) u1));}) ((append u2) (join v2)))</svg:text><svg:line x2="1586" y2="1500" x1="1586" y1="1430"></svg:line><svg:rect width="562" height="30" y="1500" x="1305"></svg:rect><svg:text y="1515" x="1586">case (((append u2) (join v2))) of {Nil  -&gt; (Nil); Cons x3 w4 -&gt; (Cons (f x3) ((map f) w4));}</svg:text>
    <svg:path d="M 1867, 1515 C 1968, 1515 1968, 615 1537, 615" style="stroke:black;"></svg:path><svg:path d="M 626, 1015 C 0, 1015 0, 315 745, 315" style="stroke:black;"></svg:path>
    </svg:svg>