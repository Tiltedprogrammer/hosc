<svg:svg width="2090" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="676" height="30" y="0" x="707"></svg:rect><svg:text y="15" x="1045">let r1=(rev v3)
 in case (r1) of {Cons x2 s2 -&gt; (Cons x2 ((app s2) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="470" y2="100" x1="1045" y1="30"></svg:line><svg:rect width="556" height="30" y="100" x="192"></svg:rect><svg:text y="115" x="470">case (r1) of {Cons x2 s2 -&gt; (Cons x2 ((app s2) (Cons v2 (Nil)))); Nil  -&gt; (Cons v2 (Nil));}</svg:text><svg:line x2="31" y2="200" x1="470" y1="130"></svg:line><svg:rect width="22" height="30" y="200" x="20"></svg:rect><svg:text y="215" x="31">r1</svg:text><svg:line x2="430" y2="200" x1="470" y1="130"></svg:line><svg:rect width="226" height="30" y="200" x="317"></svg:rect><svg:text y="215" x="430">(Cons x2 ((app s2) (Cons v2 (Nil))))</svg:text><svg:line x2="93" y2="300" x1="430" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="93">x2</svg:text><svg:line x2="461" y2="300" x1="430" y1="230"></svg:line><svg:rect width="166" height="30" y="300" x="378"></svg:rect><svg:text y="315" x="461">((app s2) (Cons v2 (Nil)))</svg:text><svg:line x2="461" y2="400" x1="461" y1="330"></svg:line><svg:rect width="634" height="30" y="400" x="144"></svg:rect><svg:text y="415" x="461">(((\w2 -&gt; (\s1 -&gt; case (w2) of {Nil  -&gt; s1; Cons x1 u -&gt; (Cons x1 ((app u) s1));})) s2) (Cons v2 (Nil)))</svg:text><svg:line x2="461" y2="500" x1="461" y1="430"></svg:line><svg:rect width="550" height="30" y="500" x="186"></svg:rect><svg:text y="515" x="461">((\x3 -&gt; case (s2) of {Nil  -&gt; x3; Cons x z1 -&gt; (Cons x ((app z1) x3));}) (Cons v2 (Nil)))</svg:text><svg:line x2="461" y2="600" x1="461" y1="530"></svg:line><svg:rect width="556" height="30" y="600" x="183"></svg:rect><svg:text y="615" x="461">case (s2) of {Nil  -&gt; (Cons v2 (Nil)); Cons u2 r3 -&gt; (Cons u2 ((app r3) (Cons v2 (Nil))));}</svg:text><svg:line x2="869" y2="200" x1="470" y1="130"></svg:line><svg:rect width="100" height="30" y="200" x="819"></svg:rect><svg:text y="215" x="869">(Cons v2 (Nil))</svg:text><svg:line x2="829" y2="300" x1="869" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="818"></svg:rect><svg:text y="315" x="829">v2</svg:text><svg:line x2="900" y2="300" x1="869" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="880"></svg:rect><svg:text y="315" x="900">(Nil)</svg:text><svg:line x2="1515" y2="100" x1="1045" y1="30"></svg:line><svg:rect width="58" height="30" y="100" x="1486"></svg:rect><svg:text y="115" x="1515">(rev v3)</svg:text><svg:line x2="1515" y2="200" x1="1515" y1="130"></svg:line><svg:rect width="544" height="30" y="200" x="1243"></svg:rect><svg:text y="215" x="1515">((\z3 -&gt; case (z3) of {Nil  -&gt; (Nil); Cons t p2 -&gt; ((app (rev p2)) (Cons t (Nil)));}) v3)</svg:text><svg:line x2="1515" y2="300" x1="1515" y1="230"></svg:line><svg:rect width="460" height="30" y="300" x="1285"></svg:rect><svg:text y="315" x="1515">case (v3) of {Nil  -&gt; (Nil); Cons w3 w -&gt; ((app (rev w)) (Cons w3 (Nil)));}</svg:text><svg:line x2="971" y2="400" x1="1515" y1="330"></svg:line><svg:rect width="22" height="30" y="400" x="960"></svg:rect><svg:text y="415" x="971">v3</svg:text><svg:line x2="1042" y2="400" x1="1515" y1="330"></svg:line><svg:rect width="40" height="30" y="400" x="1022"></svg:rect><svg:text y="415" x="1042">(Nil)</svg:text><svg:line x2="1586" y2="400" x1="1515" y1="330"></svg:line><svg:rect width="196" height="30" y="400" x="1488"></svg:rect><svg:text y="415" x="1586">((app (rev w)) (Cons w3 (Nil)))</svg:text><svg:line x2="1586" y2="500" x1="1586" y1="430"></svg:line><svg:rect width="664" height="30" y="500" x="1254"></svg:rect><svg:text y="515" x="1586">(((\u1 -&gt; (\y3 -&gt; case (u1) of {Nil  -&gt; y3; Cons z2 p -&gt; (Cons z2 ((app p) y3));})) (rev w)) (Cons w3 (Nil)))</svg:text><svg:line x2="1586" y2="600" x1="1586" y1="530"></svg:line><svg:rect width="574" height="30" y="600" x="1299"></svg:rect><svg:text y="615" x="1586">((\s -&gt; case ((rev w)) of {Nil  -&gt; s; Cons r2 u3 -&gt; (Cons r2 ((app u3) s));}) (Cons w3 (Nil)))</svg:text><svg:line x2="1586" y2="700" x1="1586" y1="630"></svg:line><svg:rect width="658" height="30" y="700" x="1257"></svg:rect><svg:text y="715" x="1586">let r=(rev w)
 in case (r) of {Cons p1 t1 -&gt; (Cons p1 ((app t1) (Cons w3 (Nil)))); Nil  -&gt; (Cons w3 (Nil));}</svg:text><svg:line x2="1540" y2="800" x1="1586" y1="730"></svg:line><svg:rect width="550" height="30" y="800" x="1265"></svg:rect><svg:text y="815" x="1540">case (r) of {Cons p1 t1 -&gt; (Cons p1 ((app t1) (Cons w3 (Nil)))); Nil  -&gt; (Cons w3 (Nil));}</svg:text><svg:line x2="1110" y2="900" x1="1540" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="1102"></svg:rect><svg:text y="915" x="1110">r</svg:text><svg:line x2="1497" y2="900" x1="1540" y1="830"></svg:line><svg:rect width="226" height="30" y="900" x="1384"></svg:rect><svg:text y="915" x="1497">(Cons p1 ((app t1) (Cons w3 (Nil))))</svg:text><svg:line x2="1169" y2="1000" x1="1497" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="1158"></svg:rect><svg:text y="1015" x="1169">p1</svg:text><svg:line x2="1528" y2="1000" x1="1497" y1="930"></svg:line><svg:rect width="166" height="30" y="1000" x="1445"></svg:rect><svg:text y="1015" x="1528">((app t1) (Cons w3 (Nil)))</svg:text><svg:line x2="1528" y2="1100" x1="1528" y1="1030"></svg:line><svg:rect width="616" height="30" y="1100" x="1220"></svg:rect><svg:text y="1115" x="1528">(((\y1 -&gt; (\z -&gt; case (y1) of {Nil  -&gt; z; Cons t2 y -&gt; (Cons t2 ((app y) z));})) t1) (Cons w3 (Nil)))</svg:text><svg:line x2="1528" y2="1200" x1="1528" y1="1130"></svg:line><svg:rect width="562" height="30" y="1200" x="1247"></svg:rect><svg:text y="1215" x="1528">((\v1 -&gt; case (t1) of {Nil  -&gt; v1; Cons y2 p3 -&gt; (Cons y2 ((app p3) v1));}) (Cons w3 (Nil)))</svg:text><svg:line x2="1528" y2="1300" x1="1528" y1="1230"></svg:line><svg:rect width="544" height="30" y="1300" x="1256"></svg:rect><svg:text y="1315" x="1528">case (t1) of {Nil  -&gt; (Cons w3 (Nil)); Cons v w1 -&gt; (Cons v ((app w1) (Cons w3 (Nil))));}</svg:text><svg:line x2="1927" y2="900" x1="1540" y1="830"></svg:line><svg:rect width="100" height="30" y="900" x="1877"></svg:rect><svg:text y="915" x="1927">(Cons w3 (Nil))</svg:text><svg:line x2="1887" y2="1000" x1="1927" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="1876"></svg:rect><svg:text y="1015" x="1887">w3</svg:text><svg:line x2="1958" y2="1000" x1="1927" y1="930"></svg:line><svg:rect width="40" height="30" y="1000" x="1938"></svg:rect><svg:text y="1015" x="1958">(Nil)</svg:text><svg:line x2="2044" y2="800" x1="1586" y1="730"></svg:line><svg:rect width="52" height="30" y="800" x="2018"></svg:rect><svg:text y="815" x="2044">(rev w)</svg:text>
    <svg:path d="M 183, 615 C 0, 615 0, 115 192, 115" style="stroke:black;"></svg:path><svg:path d="M 1256, 1315 C 1082, 1315 1082, 815 1265, 815" style="stroke:black;"></svg:path><svg:path d="M 2070, 815 C 2090, 815 2090, 115 1544, 115" style="stroke:black;"></svg:path>
    </svg:svg>