<svg:svg width="1990" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="244" height="30" y="0" x="873"></svg:rect><svg:text y="15" x="995">((map f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="995" y2="100" x1="995" y1="30"></svg:line><svg:rect width="760" height="30" y="100" x="615"></svg:rect><svg:text y="115" x="995">(((\p1 -&gt; (\p3 -&gt; case (p3) of {Nil  -&gt; (Nil); Cons u r1 -&gt; (Cons (p1 u) ((map p1) r1));})) f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="995" y2="200" x1="995" y1="130"></svg:line><svg:rect width="682" height="30" y="200" x="654"></svg:rect><svg:text y="215" x="995">((\y3 -&gt; case (y3) of {Nil  -&gt; (Nil); Cons y4 y1 -&gt; (Cons (f y4) ((map f) y1));}) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="995" y2="300" x1="995" y1="230"></svg:line><svg:rect width="586" height="30" y="300" x="702"></svg:rect><svg:text y="315" x="995">case (((filter ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons v r3 -&gt; (Cons (f v) ((map f) r3));}</svg:text><svg:line x2="995" y2="400" x1="995" y1="330"></svg:line><svg:rect width="1432" height="30" y="400" x="279"></svg:rect><svg:text y="415" x="995">case ((((\t2 -&gt; (\r2 -&gt; case (r2) of {Nil  -&gt; (Nil); Cons s1 v3 -&gt; case ((t2 s1)) of {True  -&gt; (Cons s1 ((filter t2) v3)); False  -&gt; ((filter t2) v3);};})) ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons v r3 -&gt; (Cons (f v) ((map f) r3));}</svg:text><svg:line x2="995" y2="500" x1="995" y1="430"></svg:line><svg:rect width="1486" height="30" y="500" x="252"></svg:rect><svg:text y="515" x="995">case (((\z -&gt; case (z) of {Nil  -&gt; (Nil); Cons w1 s -&gt; case ((((compose p) f) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) s)); False  -&gt; ((filter ((compose p) f)) s);};}) xs)) of {Nil  -&gt; (Nil); Cons s3 u1 -&gt; (Cons (f s3) ((map f) u1));}</svg:text><svg:line x2="995" y2="600" x1="995" y1="530"></svg:line><svg:rect width="1414" height="30" y="600" x="288"></svg:rect><svg:text y="615" x="995">case (case (xs) of {Nil  -&gt; (Nil); Cons y z4 -&gt; case ((((compose p) f) y)) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);};}) of {Nil  -&gt; (Nil); Cons x3 u2 -&gt; (Cons (f x3) ((map f) u2));}</svg:text><svg:line x2="31" y2="700" x1="995" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">xs</svg:text><svg:line x2="309" y2="700" x1="995" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="309">case ((Nil)) of {Nil  -&gt; (Nil); Cons x1 x4 -&gt; (Cons (f x1) ((map f) x4));}</svg:text><svg:line x2="309" y2="800" x1="309" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="289"></svg:rect><svg:text y="815" x="309">(Nil)</svg:text><svg:line x2="1273" y2="700" x1="995" y1="630"></svg:line><svg:rect width="1138" height="30" y="700" x="704"></svg:rect><svg:text y="715" x="1273">case (case ((((compose p) f) y)) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);}) of {Nil  -&gt; (Nil); Cons t v1 -&gt; (Cons (f t) ((map f) v1));}</svg:text><svg:line x2="1273" y2="800" x1="1273" y1="730"></svg:line><svg:rect width="1318" height="30" y="800" x="614"></svg:rect><svg:text y="815" x="1273">case (case (((((\r -&gt; (\t1 -&gt; (\z3 -&gt; (r (t1 z3))))) p) f) y)) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);}) of {Nil  -&gt; (Nil); Cons t v1 -&gt; (Cons (f t) ((map f) v1));}</svg:text><svg:line x2="1273" y2="900" x1="1273" y1="830"></svg:line><svg:rect width="1246" height="30" y="900" x="650"></svg:rect><svg:text y="915" x="1273">case (case ((((\w2 -&gt; (\y2 -&gt; (p (w2 y2)))) f) y)) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);}) of {Nil  -&gt; (Nil); Cons w t3 -&gt; (Cons (f w) ((map f) t3));}</svg:text><svg:line x2="1273" y2="1000" x1="1273" y1="930"></svg:line><svg:rect width="1174" height="30" y="1000" x="686"></svg:rect><svg:text y="1015" x="1273">case (case (((\s2 -&gt; (p (f s2))) y)) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);}) of {Nil  -&gt; (Nil); Cons u3 z2 -&gt; (Cons (f u3) ((map f) z2));}</svg:text><svg:line x2="1273" y2="1100" x1="1273" y1="1030"></svg:line><svg:rect width="1078" height="30" y="1100" x="734"></svg:rect><svg:text y="1115" x="1273">case (case ((p (f y))) of {True  -&gt; (Cons y ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);}) of {Nil  -&gt; (Nil); Cons x w3 -&gt; (Cons (f x) ((map f) w3));}</svg:text><svg:line x2="608" y2="1200" x1="1273" y1="1130"></svg:line><svg:rect width="64" height="30" y="1200" x="576"></svg:rect><svg:text y="1215" x="608">(p (f y))</svg:text><svg:line x2="608" y2="1300" x1="608" y1="1230"></svg:line><svg:rect width="40" height="30" y="1300" x="588"></svg:rect><svg:text y="1315" x="608">(f y)</svg:text><svg:line x2="608" y2="1400" x1="608" y1="1330"></svg:line><svg:rect width="16" height="30" y="1400" x="600"></svg:rect><svg:text y="1415" x="608">y</svg:text><svg:line x2="1006" y2="1200" x1="1273" y1="1130"></svg:line><svg:rect width="652" height="30" y="1200" x="680"></svg:rect><svg:text y="1215" x="1006">case ((Cons y ((filter ((compose p) f)) z4))) of {Nil  -&gt; (Nil); Cons p2 z1 -&gt; (Cons (f p2) ((map f) z1));}</svg:text><svg:line x2="1006" y2="1300" x1="1006" y1="1230"></svg:line><svg:rect width="322" height="30" y="1300" x="845"></svg:rect><svg:text y="1315" x="1006">(Cons (f y) ((map f) ((filter ((compose p) f)) z4)))</svg:text><svg:line x2="864" y2="1400" x1="1006" y1="1330"></svg:line><svg:rect width="40" height="30" y="1400" x="844"></svg:rect><svg:text y="1415" x="864">(f y)</svg:text><svg:line x2="864" y2="1500" x1="864" y1="1430"></svg:line><svg:rect width="16" height="30" y="1500" x="856"></svg:rect><svg:text y="1515" x="864">y</svg:text><svg:line x2="1046" y2="1400" x1="1006" y1="1330"></svg:line><svg:rect width="244" height="30" y="1400" x="924"></svg:rect><svg:text y="1415" x="1046">((map f) ((filter ((compose p) f)) z4))</svg:text><svg:line x2="1671" y2="1200" x1="1273" y1="1130"></svg:line><svg:rect width="598" height="30" y="1200" x="1372"></svg:rect><svg:text y="1215" x="1671">case (((filter ((compose p) f)) z4)) of {Nil  -&gt; (Nil); Cons x2 v2 -&gt; (Cons (f x2) ((map f) v2));}</svg:text>
    <svg:path d="M 1168, 1415 C 1990, 1415 1990, 15 1117, 15" style="stroke:black;"></svg:path><svg:path d="M 1970, 1215 C 1990, 1215 1990, 315 1288, 315" style="stroke:black;"></svg:path>
    </svg:svg>