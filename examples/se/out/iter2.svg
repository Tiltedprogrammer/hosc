<svg:svg width="2218" height="2130" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="220" height="30" y="0" x="999"></svg:rect><svg:text y="15" x="1109">(((compose join) (map (map f))) xs)</svg:text><svg:line x2="1109" y2="100" x1="1109" y1="30"></svg:line><svg:rect width="412" height="30" y="100" x="903"></svg:rect><svg:text y="115" x="1109">((((\r1 -&gt; (\v3 -&gt; (\w4 -&gt; (r1 (v3 w4))))) join) (map (map f))) xs)</svg:text><svg:line x2="1109" y2="200" x1="1109" y1="130"></svg:line><svg:rect width="316" height="30" y="200" x="951"></svg:rect><svg:text y="215" x="1109">(((\v -&gt; (\s3 -&gt; (join (v s3)))) (map (map f))) xs)</svg:text><svg:line x2="1109" y2="300" x1="1109" y1="230"></svg:line><svg:rect width="244" height="30" y="300" x="987"></svg:rect><svg:text y="315" x="1109">((\x4 -&gt; (join ((map (map f)) x4))) xs)</svg:text><svg:line x2="1109" y2="400" x1="1109" y1="330"></svg:line><svg:rect width="160" height="30" y="400" x="1029"></svg:rect><svg:text y="415" x="1109">(join ((map (map f)) xs))</svg:text><svg:line x2="1109" y2="500" x1="1109" y1="430"></svg:line><svg:rect width="598" height="30" y="500" x="810"></svg:rect><svg:text y="515" x="1109">((\u2 -&gt; case (u2) of {Nil  -&gt; (Nil); Cons x1 p2 -&gt; ((append x1) (join p2));}) ((map (map f)) xs))</svg:text><svg:line x2="1109" y2="600" x1="1109" y1="530"></svg:line><svg:rect width="514" height="30" y="600" x="852"></svg:rect><svg:text y="615" x="1109">case (((map (map f)) xs)) of {Nil  -&gt; (Nil); Cons w3 z5 -&gt; ((append w3) (join z5));}</svg:text><svg:line x2="1109" y2="700" x1="1109" y1="630"></svg:line><svg:rect width="1030" height="30" y="700" x="594"></svg:rect><svg:text y="715" x="1109">case ((((\w1 -&gt; (\t2 -&gt; case (t2) of {Nil  -&gt; (Nil); Cons s4 u -&gt; (Cons (w1 s4) ((map w1) u));})) (map f)) xs)) of {Nil  -&gt; (Nil); Cons w3 z5 -&gt; ((append w3) (join z5));}</svg:text><svg:line x2="1109" y2="800" x1="1109" y1="730"></svg:line><svg:rect width="964" height="30" y="800" x="627"></svg:rect><svg:text y="815" x="1109">case (((\y -&gt; case (y) of {Nil  -&gt; (Nil); Cons y4 r2 -&gt; (Cons ((map f) y4) ((map (map f)) r2));}) xs)) of {Nil  -&gt; (Nil); Cons s z2 -&gt; ((append s) (join z2));}</svg:text><svg:line x2="1109" y2="900" x1="1109" y1="830"></svg:line><svg:rect width="904" height="30" y="900" x="657"></svg:rect><svg:text y="915" x="1109">case (case (xs) of {Nil  -&gt; (Nil); Cons v4 t4 -&gt; (Cons ((map f) v4) ((map (map f)) t4));}) of {Nil  -&gt; (Nil); Cons s1 z3 -&gt; ((append s1) (join z3));}</svg:text><svg:line x2="31" y2="1000" x1="1109" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="20"></svg:rect><svg:text y="1015" x="31">xs</svg:text><svg:line x2="300" y2="1000" x1="1109" y1="930"></svg:line><svg:rect width="436" height="30" y="1000" x="82"></svg:rect><svg:text y="1015" x="300">case ((Nil)) of {Nil  -&gt; (Nil); Cons p4 z1 -&gt; ((append p4) (join z1));}</svg:text><svg:line x2="300" y2="1100" x1="300" y1="1030"></svg:line><svg:rect width="40" height="30" y="1100" x="280"></svg:rect><svg:text y="1115" x="300">(Nil)</svg:text><svg:line x2="1378" y2="1000" x1="1109" y1="930"></svg:line><svg:rect width="622" height="30" y="1000" x="1067"></svg:rect><svg:text y="1015" x="1378">case ((Cons ((map f) v4) ((map (map f)) t4))) of {Nil  -&gt; (Nil); Cons x t3 -&gt; ((append x) (join t3));}</svg:text><svg:line x2="1378" y2="1100" x1="1378" y1="1030"></svg:line><svg:rect width="304" height="30" y="1100" x="1226"></svg:rect><svg:text y="1115" x="1378">((append ((map f) v4)) (join ((map (map f)) t4)))</svg:text><svg:line x2="1378" y2="1200" x1="1378" y1="1130"></svg:line><svg:rect width="766" height="30" y="1200" x="995"></svg:rect><svg:text y="1215" x="1378">(((\v2 -&gt; (\t -&gt; case (v2) of {Nil  -&gt; t; Cons y2 u4 -&gt; (Cons y2 ((append u4) t));})) ((map f) v4)) (join ((map (map f)) t4)))</svg:text><svg:line x2="1378" y2="1300" x1="1378" y1="1230"></svg:line><svg:rect width="682" height="30" y="1300" x="1037"></svg:rect><svg:text y="1315" x="1378">((\z -&gt; case (((map f) v4)) of {Nil  -&gt; z; Cons t1 y3 -&gt; (Cons t1 ((append y3) z));}) (join ((map (map f)) t4)))</svg:text><svg:line x2="1378" y2="1400" x1="1378" y1="1330"></svg:line><svg:rect width="754" height="30" y="1400" x="1001"></svg:rect><svg:text y="1415" x="1378">case (((map f) v4)) of {Nil  -&gt; (join ((map (map f)) t4)); Cons r3 u1 -&gt; (Cons r3 ((append u1) (join ((map (map f)) t4))));}</svg:text><svg:line x2="1378" y2="1500" x1="1378" y1="1430"></svg:line><svg:rect width="1270" height="30" y="1500" x="743"></svg:rect><svg:text y="1515" x="1378">case ((((\p1 -&gt; (\u3 -&gt; case (u3) of {Nil  -&gt; (Nil); Cons y5 p -&gt; (Cons (p1 y5) ((map p1) p));})) f) v4)) of {Nil  -&gt; (join ((map (map f)) t4)); Cons r3 u1 -&gt; (Cons r3 ((append u1) (join ((map (map f)) t4))));}</svg:text><svg:line x2="1378" y2="1600" x1="1378" y1="1530"></svg:line><svg:rect width="1180" height="30" y="1600" x="788"></svg:rect><svg:text y="1615" x="1378">case (((\u5 -&gt; case (u5) of {Nil  -&gt; (Nil); Cons s2 v1 -&gt; (Cons (f s2) ((map f) v1));}) v4)) of {Nil  -&gt; (join ((map (map f)) t4)); Cons r x2 -&gt; (Cons r ((append x2) (join ((map (map f)) t4))));}</svg:text><svg:line x2="1378" y2="1700" x1="1378" y1="1630"></svg:line><svg:rect width="1108" height="30" y="1700" x="824"></svg:rect><svg:text y="1715" x="1378">case (case (v4) of {Nil  -&gt; (Nil); Cons z4 y1 -&gt; (Cons (f z4) ((map f) y1));}) of {Nil  -&gt; (join ((map (map f)) t4)); Cons w2 p3 -&gt; (Cons w2 ((append p3) (join ((map (map f)) t4))));}</svg:text><svg:line x2="569" y2="1800" x1="1378" y1="1730"></svg:line><svg:rect width="22" height="30" y="1800" x="558"></svg:rect><svg:text y="1815" x="569">v4</svg:text><svg:line x2="970" y2="1800" x1="1378" y1="1730"></svg:line><svg:rect width="700" height="30" y="1800" x="620"></svg:rect><svg:text y="1815" x="970">case ((Nil)) of {Nil  -&gt; (join ((map (map f)) t4)); Cons x5 w -&gt; (Cons x5 ((append w) (join ((map (map f)) t4))));}</svg:text><svg:line x2="970" y2="1900" x1="970" y1="1830"></svg:line><svg:rect width="160" height="30" y="1900" x="890"></svg:rect><svg:text y="1915" x="970">(join ((map (map f)) t4))</svg:text><svg:line x2="1779" y2="1800" x1="1378" y1="1730"></svg:line><svg:rect width="838" height="30" y="1800" x="1360"></svg:rect><svg:text y="1815" x="1779">case ((Cons (f z4) ((map f) y1))) of {Nil  -&gt; (join ((map (map f)) t4)); Cons r4 x3 -&gt; (Cons r4 ((append x3) (join ((map (map f)) t4))));}</svg:text><svg:line x2="1779" y2="1900" x1="1779" y1="1830"></svg:line><svg:rect width="388" height="30" y="1900" x="1585"></svg:rect><svg:text y="1915" x="1779">(Cons (f z4) ((append ((map f) y1)) (join ((map (map f)) t4))))</svg:text><svg:line x2="1607" y2="2000" x1="1779" y1="1930"></svg:line><svg:rect width="46" height="30" y="2000" x="1584"></svg:rect><svg:text y="2015" x="1607">(f z4)</svg:text><svg:line x2="1607" y2="2100" x1="1607" y1="2030"></svg:line><svg:rect width="22" height="30" y="2100" x="1596"></svg:rect><svg:text y="2115" x="1607">z4</svg:text><svg:line x2="1822" y2="2000" x1="1779" y1="1930"></svg:line><svg:rect width="304" height="30" y="2000" x="1670"></svg:rect><svg:text y="2015" x="1822">((append ((map f) y1)) (join ((map (map f)) t4)))</svg:text>
    <svg:path d="M 890, 1915 C 0, 1915 0, 415 1029, 415" style="stroke:black;"></svg:path><svg:path d="M 1974, 2015 C 2218, 2015 2218, 1115 1530, 1115" style="stroke:black;"></svg:path>
    </svg:svg>