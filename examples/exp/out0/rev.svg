<svg:svg width="1570" height="1430" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="58" height="30" y="0" x="756"></svg:rect><svg:text y="15" x="785">(rev xs)</svg:text><svg:line x2="785" y2="100" x1="785" y1="30"></svg:line><svg:rect width="532" height="30" y="100" x="519"></svg:rect><svg:text y="115" x="785">((\v1 -&gt; case (v1) of {Nil  -&gt; (Nil); Cons r y -&gt; ((app (rev y)) (Cons r (Nil)));}) xs)</svg:text><svg:line x2="785" y2="200" x1="785" y1="130"></svg:line><svg:rect width="472" height="30" y="200" x="549"></svg:rect><svg:text y="215" x="785">case (xs) of {Nil  -&gt; (Nil); Cons r1 p1 -&gt; ((app (rev p1)) (Cons r1 (Nil)));}</svg:text><svg:line x2="31" y2="300" x1="785" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">xs</svg:text><svg:line x2="102" y2="300" x1="785" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="856" y2="300" x1="785" y1="230"></svg:line><svg:rect width="202" height="30" y="300" x="755"></svg:rect><svg:text y="315" x="856">((app (rev p1)) (Cons r1 (Nil)))</svg:text><svg:line x2="856" y2="400" x1="856" y1="330"></svg:line><svg:rect width="658" height="30" y="400" x="527"></svg:rect><svg:text y="415" x="856">(((\v -&gt; (\x3 -&gt; case (v) of {Nil  -&gt; x3; Cons u2 s -&gt; (Cons u2 ((app s) x3));})) (rev p1)) (Cons r1 (Nil)))</svg:text><svg:line x2="856" y2="500" x1="856" y1="430"></svg:line><svg:rect width="598" height="30" y="500" x="557"></svg:rect><svg:text y="515" x="856">((\z2 -&gt; case ((rev p1)) of {Nil  -&gt; z2; Cons y2 w1 -&gt; (Cons y2 ((app w1) z2));}) (Cons r1 (Nil)))</svg:text><svg:line x2="856" y2="600" x1="856" y1="530"></svg:line><svg:rect width="568" height="30" y="600" x="572"></svg:rect><svg:text y="615" x="856">case ((rev p1)) of {Nil  -&gt; (Cons r1 (Nil)); Cons p x -&gt; (Cons p ((app x) (Cons r1 (Nil))));}</svg:text><svg:line x2="856" y2="700" x1="856" y1="630"></svg:line><svg:rect width="1054" height="30" y="700" x="329"></svg:rect><svg:text y="715" x="856">case (((\r2 -&gt; case (r2) of {Nil  -&gt; (Nil); Cons t1 z -&gt; ((app (rev z)) (Cons t1 (Nil)));}) p1)) of {Nil  -&gt; (Cons r1 (Nil)); Cons p x -&gt; (Cons p ((app x) (Cons r1 (Nil))));}</svg:text><svg:line x2="856" y2="800" x1="856" y1="730"></svg:line><svg:rect width="1078" height="30" y="800" x="317"></svg:rect><svg:text y="815" x="856">let t=case (p1) of {Nil  -&gt; (Nil); Cons s2 v2 -&gt; ((app (rev v2)) (Cons s2 (Nil)));}
 in case (t) of {Cons s1 p2 -&gt; (Cons s1 ((app p2) (Cons r1 (Nil)))); Nil  -&gt; (Cons r1 (Nil));}</svg:text><svg:line x2="600" y2="900" x1="856" y1="830"></svg:line><svg:rect width="550" height="30" y="900" x="325"></svg:rect><svg:text y="915" x="600">case (t) of {Cons s1 p2 -&gt; (Cons s1 ((app p2) (Cons r1 (Nil)))); Nil  -&gt; (Cons r1 (Nil));}</svg:text><svg:line x2="170" y2="1000" x1="600" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="162"></svg:rect><svg:text y="1015" x="170">t</svg:text><svg:line x2="557" y2="1000" x1="600" y1="930"></svg:line><svg:rect width="226" height="30" y="1000" x="444"></svg:rect><svg:text y="1015" x="557">(Cons s1 ((app p2) (Cons r1 (Nil))))</svg:text><svg:line x2="229" y2="1100" x1="557" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="218"></svg:rect><svg:text y="1115" x="229">s1</svg:text><svg:line x2="588" y2="1100" x1="557" y1="1030"></svg:line><svg:rect width="166" height="30" y="1100" x="505"></svg:rect><svg:text y="1115" x="588">((app p2) (Cons r1 (Nil)))</svg:text><svg:line x2="588" y2="1200" x1="588" y1="1130"></svg:line><svg:rect width="616" height="30" y="1200" x="280"></svg:rect><svg:text y="1215" x="588">(((\w -&gt; (\u -&gt; case (w) of {Nil  -&gt; u; Cons t2 x2 -&gt; (Cons t2 ((app x2) u));})) p2) (Cons r1 (Nil)))</svg:text><svg:line x2="588" y2="1300" x1="588" y1="1230"></svg:line><svg:rect width="562" height="30" y="1300" x="307"></svg:rect><svg:text y="1315" x="588">((\z1 -&gt; case (p2) of {Nil  -&gt; z1; Cons y1 u1 -&gt; (Cons y1 ((app u1) z1));}) (Cons r1 (Nil)))</svg:text><svg:line x2="588" y2="1400" x1="588" y1="1330"></svg:line><svg:rect width="556" height="30" y="1400" x="310"></svg:rect><svg:text y="1415" x="588">case (p2) of {Nil  -&gt; (Cons r1 (Nil)); Cons w2 x1 -&gt; (Cons w2 ((app x1) (Cons r1 (Nil))));}</svg:text><svg:line x2="987" y2="1000" x1="600" y1="930"></svg:line><svg:rect width="100" height="30" y="1000" x="937"></svg:rect><svg:text y="1015" x="987">(Cons r1 (Nil))</svg:text><svg:line x2="947" y2="1100" x1="987" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="936"></svg:rect><svg:text y="1115" x="947">r1</svg:text><svg:line x2="1018" y2="1100" x1="987" y1="1030"></svg:line><svg:rect width="40" height="30" y="1100" x="998"></svg:rect><svg:text y="1115" x="1018">(Nil)</svg:text><svg:line x2="1314" y2="900" x1="856" y1="830"></svg:line><svg:rect width="472" height="30" y="900" x="1078"></svg:rect><svg:text y="915" x="1314">case (p1) of {Nil  -&gt; (Nil); Cons s2 v2 -&gt; ((app (rev v2)) (Cons s2 (Nil)));}</svg:text>
    <svg:path d="M 310, 1415 C 142, 1415 142, 915 325, 915" style="stroke:black;"></svg:path><svg:path d="M 1550, 915 C 1570, 915 1570, 215 1021, 215" style="stroke:black;"></svg:path>
    </svg:svg>