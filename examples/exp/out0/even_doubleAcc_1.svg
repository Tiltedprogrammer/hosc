<svg:svg width="1746" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="166" height="30" y="0" x="790"></svg:rect><svg:text y="15" x="873">(even ((doubleAcc x) (Z)))</svg:text><svg:line x2="873" y2="100" x1="873" y1="30"></svg:line><svg:rect width="472" height="30" y="100" x="637"></svg:rect><svg:text y="115" x="873">((\t1 -&gt; case (t1) of {Z  -&gt; (True); S v2 -&gt; (odd v2);}) ((doubleAcc x) (Z)))</svg:text><svg:line x2="873" y2="200" x1="873" y1="130"></svg:line><svg:rect width="388" height="30" y="200" x="679"></svg:rect><svg:text y="215" x="873">case (((doubleAcc x) (Z))) of {Z  -&gt; (True); S p2 -&gt; (odd p2);}</svg:text><svg:line x2="873" y2="300" x1="873" y1="230"></svg:line><svg:rect width="796" height="30" y="300" x="475"></svg:rect><svg:text y="315" x="873">case ((((\r1 -&gt; (\u1 -&gt; case (r1) of {Z  -&gt; u1; S s -&gt; ((doubleAcc s) (S (S u1)));})) x) (Z))) of {Z  -&gt; (True); S p2 -&gt; (odd p2);}</svg:text><svg:line x2="873" y2="400" x1="873" y1="330"></svg:line><svg:rect width="712" height="30" y="400" x="517"></svg:rect><svg:text y="415" x="873">case (((\u2 -&gt; case (x) of {Z  -&gt; u2; S w1 -&gt; ((doubleAcc w1) (S (S u2)));}) (Z))) of {Z  -&gt; (True); S z -&gt; (odd z);}</svg:text><svg:line x2="873" y2="500" x1="873" y1="430"></svg:line><svg:rect width="724" height="30" y="500" x="511"></svg:rect><svg:text y="515" x="873">let v=(Z), p=x
 in case (case (p) of {S t -&gt; ((doubleAcc t) (S (S v))); Z  -&gt; v;}) of {S v1 -&gt; (odd v1); Z  -&gt; (True);}</svg:text><svg:line x2="811" y2="600" x1="873" y1="530"></svg:line><svg:rect width="610" height="30" y="600" x="506"></svg:rect><svg:text y="615" x="811">case (case (p) of {S t -&gt; ((doubleAcc t) (S (S v))); Z  -&gt; v;}) of {S v1 -&gt; (odd v1); Z  -&gt; (True);}</svg:text><svg:line x2="28" y2="700" x1="811" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="28">p</svg:text><svg:line x2="492" y2="700" x1="811" y1="630"></svg:line><svg:rect width="424" height="30" y="700" x="280"></svg:rect><svg:text y="715" x="492">case (((doubleAcc t) (S (S v)))) of {S y2 -&gt; (odd y2); Z  -&gt; (True);}</svg:text><svg:line x2="492" y2="800" x1="492" y1="730"></svg:line><svg:rect width="832" height="30" y="800" x="76"></svg:rect><svg:text y="815" x="492">case ((((\s1 -&gt; (\z1 -&gt; case (s1) of {Z  -&gt; z1; S u -&gt; ((doubleAcc u) (S (S z1)));})) t) (S (S v)))) of {S y2 -&gt; (odd y2); Z  -&gt; (True);}</svg:text><svg:line x2="492" y2="900" x1="492" y1="830"></svg:line><svg:rect width="760" height="30" y="900" x="112"></svg:rect><svg:text y="915" x="492">case (((\z2 -&gt; case (t) of {Z  -&gt; z2; S p1 -&gt; ((doubleAcc p1) (S (S z2)));}) (S (S v)))) of {S y1 -&gt; (odd y1); Z  -&gt; (True);}</svg:text><svg:line x2="492" y2="1000" x1="492" y1="930"></svg:line><svg:rect width="772" height="30" y="1000" x="106"></svg:rect><svg:text y="1015" x="492">let w2=t, w=(S (S v))
 in case (case (w2) of {S t -&gt; ((doubleAcc t) (S (S w))); Z  -&gt; w;}) of {S v1 -&gt; (odd v1); Z  -&gt; (True);}</svg:text><svg:line x2="412" y2="1100" x1="492" y1="1030"></svg:line><svg:rect width="616" height="30" y="1100" x="104"></svg:rect><svg:text y="1115" x="412">case (case (w2) of {S t -&gt; ((doubleAcc t) (S (S w))); Z  -&gt; w;}) of {S v1 -&gt; (odd v1); Z  -&gt; (True);}</svg:text><svg:line x2="768" y2="1100" x1="492" y1="1030"></svg:line><svg:rect width="16" height="30" y="1100" x="760"></svg:rect><svg:text y="1115" x="768">t</svg:text><svg:line x2="848" y2="1100" x1="492" y1="1030"></svg:line><svg:rect width="64" height="30" y="1100" x="816"></svg:rect><svg:text y="1115" x="848">(S (S v))</svg:text><svg:line x2="848" y2="1200" x1="848" y1="1130"></svg:line><svg:rect width="40" height="30" y="1200" x="828"></svg:rect><svg:text y="1215" x="848">(S v)</svg:text><svg:line x2="848" y2="1300" x1="848" y1="1230"></svg:line><svg:rect width="16" height="30" y="1300" x="840"></svg:rect><svg:text y="1315" x="848">v</svg:text><svg:line x2="1275" y2="700" x1="811" y1="630"></svg:line><svg:rect width="280" height="30" y="700" x="1135"></svg:rect><svg:text y="715" x="1275">case (v) of {S s2 -&gt; (odd s2); Z  -&gt; (True);}</svg:text><svg:line x2="956" y2="800" x1="1275" y1="730"></svg:line><svg:rect width="16" height="30" y="800" x="948"></svg:rect><svg:text y="815" x="956">v</svg:text><svg:line x2="1260" y2="800" x1="1275" y1="730"></svg:line><svg:rect width="58" height="30" y="800" x="1231"></svg:rect><svg:text y="815" x="1260">(odd s2)</svg:text><svg:line x2="1260" y2="900" x1="1260" y1="830"></svg:line><svg:rect width="370" height="30" y="900" x="1075"></svg:rect><svg:text y="915" x="1260">((\y -&gt; case (y) of {Z  -&gt; (False); S x1 -&gt; (even x1);}) s2)</svg:text><svg:line x2="1260" y2="1000" x1="1260" y1="930"></svg:line><svg:rect width="298" height="30" y="1000" x="1111"></svg:rect><svg:text y="1015" x="1260">case (s2) of {Z  -&gt; (False); S x2 -&gt; (even x2);}</svg:text><svg:line x2="1015" y2="1100" x1="1260" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="1004"></svg:rect><svg:text y="1115" x="1015">s2</svg:text><svg:line x2="1092" y2="1100" x1="1260" y1="1030"></svg:line><svg:rect width="52" height="30" y="1100" x="1066"></svg:rect><svg:text y="1115" x="1092">(False)</svg:text><svg:line x2="1337" y2="1100" x1="1260" y1="1030"></svg:line><svg:rect width="64" height="30" y="1100" x="1305"></svg:rect><svg:text y="1115" x="1337">(even x2)</svg:text><svg:line x2="1337" y2="1200" x1="1337" y1="1130"></svg:line><svg:rect width="358" height="30" y="1200" x="1158"></svg:rect><svg:text y="1215" x="1337">((\r2 -&gt; case (r2) of {Z  -&gt; (True); S r -&gt; (odd r);}) x2)</svg:text><svg:line x2="1337" y2="1300" x1="1337" y1="1230"></svg:line><svg:rect width="286" height="30" y="1300" x="1194"></svg:rect><svg:text y="1315" x="1337">case (x2) of {Z  -&gt; (True); S t2 -&gt; (odd t2);}</svg:text><svg:line x2="1579" y2="800" x1="1275" y1="730"></svg:line><svg:rect width="46" height="30" y="800" x="1556"></svg:rect><svg:text y="815" x="1579">(True)</svg:text><svg:line x2="1656" y2="600" x1="873" y1="530"></svg:line><svg:rect width="28" height="30" y="600" x="1642"></svg:rect><svg:text y="615" x="1656">(Z)</svg:text><svg:line x2="1718" y2="600" x1="873" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="1710"></svg:rect><svg:text y="615" x="1718">x</svg:text>
    <svg:path d="M 104, 1115 C 0, 1115 0, 615 506, 615" style="stroke:black;"></svg:path><svg:path d="M 1480, 1315 C 1622, 1315 1622, 715 1415, 715" style="stroke:black;"></svg:path>
    </svg:svg>