<svg:svg width="1420" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="346" height="30" y="0" x="537"></svg:rect><svg:text y="15" x="710">((choice{map1; map2;} choice{change1; id;}) (P (A) (B)))</svg:text><svg:line x2="358" y2="100" x1="710" y1="30"></svg:line><svg:rect width="256" height="30" y="100" x="230"></svg:rect><svg:text y="115" x="358">((map1 choice{change1; id;}) (P (A) (B)))</svg:text><svg:line x2="358" y2="200" x1="358" y1="130"></svg:line><svg:rect width="562" height="30" y="200" x="77"></svg:rect><svg:text y="215" x="358">(((\v1 -&gt; (\y2 -&gt; case (y2) of {P t u -&gt; (P (v1 t) u);})) choice{change1; id;}) (P (A) (B)))</svg:text><svg:line x2="358" y2="300" x1="358" y1="230"></svg:line><svg:rect width="490" height="30" y="300" x="113"></svg:rect><svg:text y="315" x="358">((\z2 -&gt; case (z2) of {P p1 s -&gt; (P (choice{change1; id;} p1) s);}) (P (A) (B)))</svg:text><svg:line x2="358" y2="400" x1="358" y1="330"></svg:line><svg:rect width="418" height="30" y="400" x="149"></svg:rect><svg:text y="415" x="358">case ((P (A) (B))) of {P r1 w2 -&gt; (P (choice{change1; id;} r1) w2);}</svg:text><svg:line x2="358" y2="500" x1="358" y1="430"></svg:line><svg:rect width="214" height="30" y="500" x="251"></svg:rect><svg:text y="515" x="358">(P (choice{change1; id;} (A)) (B))</svg:text><svg:line x2="324" y2="600" x1="358" y1="530"></svg:line><svg:rect width="166" height="30" y="600" x="241"></svg:rect><svg:text y="615" x="324">(choice{change1; id;} (A))</svg:text><svg:line x2="254" y2="700" x1="324" y1="630"></svg:line><svg:rect width="88" height="30" y="700" x="210"></svg:rect><svg:text y="715" x="254">(change1 (A))</svg:text><svg:line x2="254" y2="800" x1="254" y1="730"></svg:line><svg:rect width="256" height="30" y="800" x="126"></svg:rect><svg:text y="815" x="254">((\v -&gt; choice{(change v); (id v);}) (A))</svg:text><svg:line x2="254" y2="900" x1="254" y1="830"></svg:line><svg:rect width="196" height="30" y="900" x="156"></svg:rect><svg:text y="915" x="254">choice{(change (A)); (id (A));}</svg:text><svg:line x2="178" y2="1000" x1="254" y1="930"></svg:line><svg:rect width="82" height="30" y="1000" x="137"></svg:rect><svg:text y="1015" x="178">(change (A))</svg:text><svg:line x2="178" y2="1100" x1="178" y1="1030"></svg:line><svg:rect width="316" height="30" y="1100" x="20"></svg:rect><svg:text y="1115" x="178">((\u2 -&gt; case (u2) of {A  -&gt; (B); B  -&gt; (A);}) (A))</svg:text><svg:line x2="178" y2="1200" x1="178" y1="1130"></svg:line><svg:rect width="232" height="30" y="1200" x="62"></svg:rect><svg:text y="1215" x="178">case ((A)) of {A  -&gt; (B); B  -&gt; (A);}</svg:text><svg:line x2="178" y2="1300" x1="178" y1="1230"></svg:line><svg:rect width="28" height="30" y="1300" x="164"></svg:rect><svg:text y="1315" x="178">(B)</svg:text><svg:line x2="432" y2="1000" x1="254" y1="930"></svg:line><svg:rect width="58" height="30" y="1000" x="403"></svg:rect><svg:text y="1015" x="432">(id (A))</svg:text><svg:line x2="432" y2="1100" x1="432" y1="1030"></svg:line><svg:rect width="112" height="30" y="1100" x="376"></svg:rect><svg:text y="1115" x="432">((\w1 -&gt; w1) (A))</svg:text><svg:line x2="432" y2="1200" x1="432" y1="1130"></svg:line><svg:rect width="28" height="30" y="1200" x="418"></svg:rect><svg:text y="1215" x="432">(A)</svg:text><svg:line x2="578" y2="700" x1="324" y1="630"></svg:line><svg:rect width="58" height="30" y="700" x="549"></svg:rect><svg:text y="715" x="578">(id (A))</svg:text><svg:line x2="578" y2="800" x1="578" y1="730"></svg:line><svg:rect width="100" height="30" y="800" x="528"></svg:rect><svg:text y="815" x="578">((\x -&gt; x) (A))</svg:text><svg:line x2="578" y2="900" x1="578" y1="830"></svg:line><svg:rect width="28" height="30" y="900" x="564"></svg:rect><svg:text y="915" x="578">(A)</svg:text><svg:line x2="682" y2="600" x1="358" y1="530"></svg:line><svg:rect width="28" height="30" y="600" x="668"></svg:rect><svg:text y="615" x="682">(B)</svg:text><svg:line x2="1068" y2="100" x1="710" y1="30"></svg:line><svg:rect width="256" height="30" y="100" x="940"></svg:rect><svg:text y="115" x="1068">((map2 choice{change1; id;}) (P (A) (B)))</svg:text><svg:line x2="1068" y2="200" x1="1068" y1="130"></svg:line><svg:rect width="574" height="30" y="200" x="781"></svg:rect><svg:text y="215" x="1068">(((\x2 -&gt; (\z -&gt; case (z) of {P u1 v2 -&gt; (P (x2 u1) v2);})) choice{change1; id;}) (P (A) (B)))</svg:text><svg:line x2="1068" y2="300" x1="1068" y1="230"></svg:line><svg:rect width="478" height="30" y="300" x="829"></svg:rect><svg:text y="315" x="1068">((\r -&gt; case (r) of {P y t1 -&gt; (P (choice{change1; id;} y) t1);}) (P (A) (B)))</svg:text><svg:line x2="1068" y2="400" x1="1068" y1="330"></svg:line><svg:rect width="418" height="30" y="400" x="859"></svg:rect><svg:text y="415" x="1068">case ((P (A) (B))) of {P z1 y1 -&gt; (P (choice{change1; id;} z1) y1);}</svg:text><svg:line x2="1068" y2="500" x1="1068" y1="430"></svg:line><svg:rect width="214" height="30" y="500" x="961"></svg:rect><svg:text y="515" x="1068">(P (choice{change1; id;} (A)) (B))</svg:text><svg:line x2="1034" y2="600" x1="1068" y1="530"></svg:line><svg:rect width="166" height="30" y="600" x="951"></svg:rect><svg:text y="615" x="1034">(choice{change1; id;} (A))</svg:text><svg:line x2="964" y2="700" x1="1034" y1="630"></svg:line><svg:rect width="88" height="30" y="700" x="920"></svg:rect><svg:text y="715" x="964">(change1 (A))</svg:text><svg:line x2="964" y2="800" x1="964" y1="730"></svg:line><svg:rect width="274" height="30" y="800" x="827"></svg:rect><svg:text y="815" x="964">((\s1 -&gt; choice{(change s1); (id s1);}) (A))</svg:text><svg:line x2="964" y2="900" x1="964" y1="830"></svg:line><svg:rect width="196" height="30" y="900" x="866"></svg:rect><svg:text y="915" x="964">choice{(change (A)); (id (A));}</svg:text><svg:line x2="894" y2="1000" x1="964" y1="930"></svg:line><svg:rect width="82" height="30" y="1000" x="853"></svg:rect><svg:text y="1015" x="894">(change (A))</svg:text><svg:line x2="894" y2="1100" x1="894" y1="1030"></svg:line><svg:rect width="316" height="30" y="1100" x="736"></svg:rect><svg:text y="1115" x="894">((\x1 -&gt; case (x1) of {A  -&gt; (B); B  -&gt; (A);}) (A))</svg:text><svg:line x2="894" y2="1200" x1="894" y1="1130"></svg:line><svg:rect width="232" height="30" y="1200" x="778"></svg:rect><svg:text y="1215" x="894">case ((A)) of {A  -&gt; (B); B  -&gt; (A);}</svg:text><svg:line x2="894" y2="1300" x1="894" y1="1230"></svg:line><svg:rect width="28" height="30" y="1300" x="880"></svg:rect><svg:text y="1315" x="894">(B)</svg:text><svg:line x2="1142" y2="1000" x1="964" y1="930"></svg:line><svg:rect width="58" height="30" y="1000" x="1113"></svg:rect><svg:text y="1015" x="1142">(id (A))</svg:text><svg:line x2="1142" y2="1100" x1="1142" y1="1030"></svg:line><svg:rect width="100" height="30" y="1100" x="1092"></svg:rect><svg:text y="1115" x="1142">((\p -&gt; p) (A))</svg:text><svg:line x2="1142" y2="1200" x1="1142" y1="1130"></svg:line><svg:rect width="28" height="30" y="1200" x="1128"></svg:rect><svg:text y="1215" x="1142">(A)</svg:text><svg:line x2="1282" y2="700" x1="1034" y1="630"></svg:line><svg:rect width="58" height="30" y="700" x="1253"></svg:rect><svg:text y="715" x="1282">(id (A))</svg:text><svg:line x2="1282" y2="800" x1="1282" y1="730"></svg:line><svg:rect width="100" height="30" y="800" x="1232"></svg:rect><svg:text y="815" x="1282">((\w -&gt; w) (A))</svg:text><svg:line x2="1282" y2="900" x1="1282" y1="830"></svg:line><svg:rect width="28" height="30" y="900" x="1268"></svg:rect><svg:text y="915" x="1282">(A)</svg:text><svg:line x2="1386" y2="600" x1="1068" y1="530"></svg:line><svg:rect width="28" height="30" y="600" x="1372"></svg:rect><svg:text y="615" x="1386">(B)</svg:text>
    
    </svg:svg>