<svg:svg width="3400" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="58" height="30" y="0" x="1671"></svg:rect><svg:text y="15" x="1700">(eval t)</svg:text><svg:line x2="1700" y2="100" x1="1700" y1="30"></svg:line><svg:rect width="898" height="30" y="100" x="1251"></svg:rect><svg:text y="115" x="1700">((\u1 -&gt; case (u1) of {Lit r5 -&gt; (Lit r5); Oper u6 u w2 -&gt; case ((eval u)) of {Lit t6 -&gt; case ((eval w2)) of {Lit x2 -&gt; (Lit ((u6 t6) x2));};};}) t)</svg:text><svg:line x2="1700" y2="200" x1="1700" y1="130"></svg:line><svg:rect width="802" height="30" y="200" x="1299"></svg:rect><svg:text y="215" x="1700">case (t) of {Lit x4 -&gt; (Lit x4); Oper u3 v7 s -&gt; case ((eval v7)) of {Lit w6 -&gt; case ((eval s)) of {Lit x -&gt; (Lit ((u3 w6) x));};};}</svg:text><svg:line x2="28" y2="300" x1="1700" y1="230"></svg:line><svg:rect width="16" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="28">t</svg:text><svg:line x2="105" y2="300" x1="1700" y1="230"></svg:line><svg:rect width="58" height="30" y="300" x="76"></svg:rect><svg:text y="315" x="105">(Lit x4)</svg:text><svg:line x2="105" y2="400" x1="105" y1="330"></svg:line><svg:rect width="22" height="30" y="400" x="94"></svg:rect><svg:text y="415" x="105">x4</svg:text><svg:line x2="1777" y2="300" x1="1700" y1="230"></svg:line><svg:rect width="508" height="30" y="300" x="1523"></svg:rect><svg:text y="315" x="1777">case ((eval v7)) of {Lit z1 -&gt; case ((eval s)) of {Lit t5 -&gt; (Lit ((u3 z1) t5));};}</svg:text><svg:line x2="1777" y2="400" x1="1777" y1="330"></svg:line><svg:rect width="1360" height="30" y="400" x="1097"></svg:rect><svg:text y="415" x="1777">case (((\t1 -&gt; case (t1) of {Lit t3 -&gt; (Lit t3); Oper s5 t4 r4 -&gt; case ((eval t4)) of {Lit v3 -&gt; case ((eval r4)) of {Lit x1 -&gt; (Lit ((s5 v3) x1));};};}) v7)) of {Lit z1 -&gt; case ((eval s)) of {Lit t5 -&gt; (Lit ((u3 z1) t5));};}</svg:text><svg:line x2="1777" y2="500" x1="1777" y1="430"></svg:line><svg:rect width="1264" height="30" y="500" x="1145"></svg:rect><svg:text y="515" x="1777">case (case (v7) of {Lit v -&gt; (Lit v); Oper r1 u2 p7 -&gt; case ((eval u2)) of {Lit p5 -&gt; case ((eval p7)) of {Lit z6 -&gt; (Lit ((r1 p5) z6));};};}) of {Lit s4 -&gt; case ((eval s)) of {Lit z2 -&gt; (Lit ((u3 s4) z2));};}</svg:text><svg:line x2="185" y2="600" x1="1777" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="174"></svg:rect><svg:text y="615" x="185">v7</svg:text><svg:line x2="852" y2="600" x1="1777" y1="530"></svg:line><svg:rect width="484" height="30" y="600" x="610"></svg:rect><svg:text y="615" x="852">case ((Lit v)) of {Lit p1 -&gt; case ((eval s)) of {Lit r -&gt; (Lit ((u3 p1) r));};}</svg:text><svg:line x2="852" y2="700" x1="852" y1="630"></svg:line><svg:rect width="304" height="30" y="700" x="700"></svg:rect><svg:text y="715" x="852">case ((eval s)) of {Lit z5 -&gt; (Lit ((u3 v) z5));}</svg:text><svg:line x2="852" y2="800" x1="852" y1="730"></svg:line><svg:rect width="1156" height="30" y="800" x="274"></svg:rect><svg:text y="815" x="852">case (((\r6 -&gt; case (r6) of {Lit v6 -&gt; (Lit v6); Oper t2 p2 p3 -&gt; case ((eval p2)) of {Lit s3 -&gt; case ((eval p3)) of {Lit v4 -&gt; (Lit ((t2 s3) v4));};};}) s)) of {Lit z5 -&gt; (Lit ((u3 v) z5));}</svg:text><svg:line x2="852" y2="900" x1="852" y1="830"></svg:line><svg:rect width="1060" height="30" y="900" x="322"></svg:rect><svg:text y="915" x="852">case (case (s) of {Lit y3 -&gt; (Lit y3); Oper r2 w4 x5 -&gt; case ((eval w4)) of {Lit x6 -&gt; case ((eval x5)) of {Lit y -&gt; (Lit ((r2 x6) y));};};}) of {Lit s6 -&gt; (Lit ((u3 v) s6));}</svg:text><svg:line x2="244" y2="1000" x1="852" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="236"></svg:rect><svg:text y="1015" x="244">s</svg:text><svg:line x2="438" y2="1000" x1="852" y1="930"></svg:line><svg:rect width="292" height="30" y="1000" x="292"></svg:rect><svg:text y="1015" x="438">case ((Lit y3)) of {Lit w -&gt; (Lit ((u3 v) w));}</svg:text><svg:line x2="438" y2="1100" x1="438" y1="1030"></svg:line><svg:rect width="112" height="30" y="1100" x="382"></svg:rect><svg:text y="1115" x="438">(Lit ((u3 v) y3))</svg:text><svg:line x2="438" y2="1200" x1="438" y1="1130"></svg:line><svg:rect width="76" height="30" y="1200" x="400"></svg:rect><svg:text y="1215" x="438">((u3 v) y3)</svg:text><svg:line x2="407" y2="1300" x1="438" y1="1230"></svg:line><svg:rect width="16" height="30" y="1300" x="399"></svg:rect><svg:text y="1315" x="407">v</svg:text><svg:line x2="466" y2="1300" x1="438" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="455"></svg:rect><svg:text y="1315" x="466">y3</svg:text><svg:line x2="1046" y2="1000" x1="852" y1="930"></svg:line><svg:rect width="844" height="30" y="1000" x="624"></svg:rect><svg:text y="1015" x="1046">let y1=case ((eval w4)) of {Lit y6 -&gt; case ((eval x5)) of {Lit x7 -&gt; (Lit ((r2 y6) x7));};}
 in case (y1) of {Lit u5 -&gt; (Lit ((u3 v) u5));}</svg:text><svg:line x2="769" y2="1100" x1="1046" y1="1030"></svg:line><svg:rect width="268" height="30" y="1100" x="635"></svg:rect><svg:text y="1115" x="769">case (y1) of {Lit u5 -&gt; (Lit ((u3 v) u5));}</svg:text><svg:line x2="693" y2="1200" x1="769" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="682"></svg:rect><svg:text y="1215" x="693">y1</svg:text><svg:line x2="800" y2="1200" x1="769" y1="1130"></svg:line><svg:rect width="112" height="30" y="1200" x="744"></svg:rect><svg:text y="1215" x="800">(Lit ((u3 v) u5))</svg:text><svg:line x2="800" y2="1300" x1="800" y1="1230"></svg:line><svg:rect width="76" height="30" y="1300" x="762"></svg:rect><svg:text y="1315" x="800">((u3 v) u5)</svg:text><svg:line x2="769" y2="1400" x1="800" y1="1330"></svg:line><svg:rect width="16" height="30" y="1400" x="761"></svg:rect><svg:text y="1415" x="769">v</svg:text><svg:line x2="828" y2="1400" x1="800" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="817"></svg:rect><svg:text y="1415" x="828">u5</svg:text><svg:line x2="1200" y2="1100" x1="1046" y1="1030"></svg:line><svg:rect width="514" height="30" y="1100" x="943"></svg:rect><svg:text y="1115" x="1200">case ((eval w4)) of {Lit y6 -&gt; case ((eval x5)) of {Lit x7 -&gt; (Lit ((r2 y6) x7));};}</svg:text><svg:line x2="2444" y2="600" x1="1777" y1="530"></svg:line><svg:rect width="1042" height="30" y="600" x="1923"></svg:rect><svg:text y="615" x="2444">let z4=case ((eval u2)) of {Lit y5 -&gt; case ((eval p7)) of {Lit z3 -&gt; (Lit ((r1 y5) z3));};}
 in case (z4) of {Lit u4 -&gt; case ((eval s)) of {Lit w3 -&gt; (Lit ((u3 u4) w3));};}</svg:text><svg:line x2="2167" y2="700" x1="2444" y1="630"></svg:line><svg:rect width="466" height="30" y="700" x="1934"></svg:rect><svg:text y="715" x="2167">case (z4) of {Lit u4 -&gt; case ((eval s)) of {Lit w3 -&gt; (Lit ((u3 u4) w3));};}</svg:text><svg:line x2="1519" y2="800" x1="2167" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="1508"></svg:rect><svg:text y="815" x="1519">z4</svg:text><svg:line x2="2198" y2="800" x1="2167" y1="730"></svg:line><svg:rect width="310" height="30" y="800" x="2043"></svg:rect><svg:text y="815" x="2198">case ((eval s)) of {Lit v5 -&gt; (Lit ((u3 u4) v5));}</svg:text><svg:line x2="2198" y2="900" x1="2198" y1="830"></svg:line><svg:rect width="1150" height="30" y="900" x="1623"></svg:rect><svg:text y="915" x="2198">case (((\w7 -&gt; case (w7) of {Lit r7 -&gt; (Lit r7); Oper s1 p6 w1 -&gt; case ((eval p6)) of {Lit x3 -&gt; case ((eval w1)) of {Lit p -&gt; (Lit ((s1 x3) p));};};}) s)) of {Lit v5 -&gt; (Lit ((u3 u4) v5));}</svg:text><svg:line x2="2198" y2="1000" x1="2198" y1="930"></svg:line><svg:rect width="1066" height="30" y="1000" x="1665"></svg:rect><svg:text y="1015" x="2198">case (case (s) of {Lit r3 -&gt; (Lit r3); Oper v2 u7 z7 -&gt; case ((eval u7)) of {Lit y2 -&gt; case ((eval z7)) of {Lit y7 -&gt; (Lit ((v2 y2) y7));};};}) of {Lit z -&gt; (Lit ((u3 u4) z));}</svg:text><svg:line x2="1578" y2="1100" x1="2198" y1="1030"></svg:line><svg:rect width="16" height="30" y="1100" x="1570"></svg:rect><svg:text y="1115" x="1578">s</svg:text><svg:line x2="1781" y2="1100" x1="2198" y1="1030"></svg:line><svg:rect width="310" height="30" y="1100" x="1626"></svg:rect><svg:text y="1115" x="1781">case ((Lit r3)) of {Lit s2 -&gt; (Lit ((u3 u4) s2));}</svg:text><svg:line x2="1781" y2="1200" x1="1781" y1="1130"></svg:line><svg:rect width="118" height="30" y="1200" x="1722"></svg:rect><svg:text y="1215" x="1781">(Lit ((u3 u4) r3))</svg:text><svg:line x2="1781" y2="1300" x1="1781" y1="1230"></svg:line><svg:rect width="82" height="30" y="1300" x="1740"></svg:rect><svg:text y="1315" x="1781">((u3 u4) r3)</svg:text><svg:line x2="1750" y2="1400" x1="1781" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="1739"></svg:rect><svg:text y="1415" x="1750">u4</svg:text><svg:line x2="1812" y2="1400" x1="1781" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="1801"></svg:rect><svg:text y="1415" x="1812">r3</svg:text><svg:line x2="2401" y2="1100" x1="2198" y1="1030"></svg:line><svg:rect width="850" height="30" y="1100" x="1976"></svg:rect><svg:text y="1115" x="2401">let w5=case ((eval u7)) of {Lit v1 -&gt; case ((eval z7)) of {Lit y4 -&gt; (Lit ((v2 v1) y4));};}
 in case (w5) of {Lit p4 -&gt; (Lit ((u3 u4) p4));}</svg:text><svg:line x2="2124" y2="1200" x1="2401" y1="1130"></svg:line><svg:rect width="274" height="30" y="1200" x="1987"></svg:rect><svg:text y="1215" x="2124">case (w5) of {Lit p4 -&gt; (Lit ((u3 u4) p4));}</svg:text><svg:line x2="2045" y2="1300" x1="2124" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="2034"></svg:rect><svg:text y="1315" x="2045">w5</svg:text><svg:line x2="2155" y2="1300" x1="2124" y1="1230"></svg:line><svg:rect width="118" height="30" y="1300" x="2096"></svg:rect><svg:text y="1315" x="2155">(Lit ((u3 u4) p4))</svg:text><svg:line x2="2155" y2="1400" x1="2155" y1="1330"></svg:line><svg:rect width="82" height="30" y="1400" x="2114"></svg:rect><svg:text y="1415" x="2155">((u3 u4) p4)</svg:text><svg:line x2="2124" y2="1500" x1="2155" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="2113"></svg:rect><svg:text y="1515" x="2124">u4</svg:text><svg:line x2="2186" y2="1500" x1="2155" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="2175"></svg:rect><svg:text y="1515" x="2186">p4</svg:text><svg:line x2="2558" y2="1200" x1="2401" y1="1130"></svg:line><svg:rect width="514" height="30" y="1200" x="2301"></svg:rect><svg:text y="1215" x="2558">case ((eval u7)) of {Lit v1 -&gt; case ((eval z7)) of {Lit y4 -&gt; (Lit ((v2 v1) y4));};}</svg:text><svg:line x2="3123" y2="700" x1="2444" y1="630"></svg:line><svg:rect width="514" height="30" y="700" x="2866"></svg:rect><svg:text y="715" x="3123">case ((eval u2)) of {Lit y5 -&gt; case ((eval p7)) of {Lit z3 -&gt; (Lit ((r1 y5) z3));};}</svg:text>
    <svg:path d="M 943, 1115 C 154, 1115 154, 315 1523, 315" style="stroke:black;"></svg:path><svg:path d="M 2815, 1215 C 3400, 1215 3400, 315 2031, 315" style="stroke:black;"></svg:path><svg:path d="M 3380, 715 C 3400, 715 3400, 315 2031, 315" style="stroke:black;"></svg:path>
    </svg:svg>