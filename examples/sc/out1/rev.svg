<svg:svg width="1132" height="1230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="58" height="30" y="0" x="537"></svg:rect><svg:text y="15" x="566">(rev xs)</svg:text><svg:line x2="566" y2="100" x1="566" y1="30"></svg:line><svg:rect width="556" height="30" y="100" x="288"></svg:rect><svg:text y="115" x="566">((\z1 -&gt; case (z1) of {Nil  -&gt; (Nil); Cons v1 u2 -&gt; ((app (rev u2)) (Cons v1 (Nil)));}) xs)</svg:text><svg:line x2="566" y2="200" x1="566" y1="130"></svg:line><svg:rect width="472" height="30" y="200" x="330"></svg:rect><svg:text y="215" x="566">case (xs) of {Nil  -&gt; (Nil); Cons s1 x1 -&gt; ((app (rev x1)) (Cons s1 (Nil)));}</svg:text><svg:line x2="31" y2="300" x1="566" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">xs</svg:text><svg:line x2="102" y2="300" x1="566" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="637" y2="300" x1="566" y1="230"></svg:line><svg:rect width="202" height="30" y="300" x="536"></svg:rect><svg:text y="315" x="637">((app (rev x1)) (Cons s1 (Nil)))</svg:text><svg:line x2="637" y2="400" x1="637" y1="330"></svg:line><svg:rect width="652" height="30" y="400" x="311"></svg:rect><svg:text y="415" x="637">(((\y1 -&gt; (\u -&gt; case (y1) of {Nil  -&gt; u; Cons p r1 -&gt; (Cons p ((app r1) u));})) (rev x1)) (Cons s1 (Nil)))</svg:text><svg:line x2="637" y2="500" x1="637" y1="430"></svg:line><svg:rect width="586" height="30" y="500" x="344"></svg:rect><svg:text y="515" x="637">((\z2 -&gt; case ((rev x1)) of {Nil  -&gt; z2; Cons s w1 -&gt; (Cons s ((app w1) z2));}) (Cons s1 (Nil)))</svg:text><svg:line x2="637" y2="600" x1="637" y1="530"></svg:line><svg:rect width="664" height="30" y="600" x="305"></svg:rect><svg:text y="615" x="637">let u1=(rev x1)
 in case (u1) of {Cons v y2 -&gt; (Cons v ((app y2) (Cons s1 (Nil)))); Nil  -&gt; (Cons s1 (Nil));}</svg:text><svg:line x2="588" y2="700" x1="637" y1="630"></svg:line><svg:rect width="544" height="30" y="700" x="316"></svg:rect><svg:text y="715" x="588">case (u1) of {Cons v y2 -&gt; (Cons v ((app y2) (Cons s1 (Nil)))); Nil  -&gt; (Cons s1 (Nil));}</svg:text><svg:line x2="173" y2="800" x1="588" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="162"></svg:rect><svg:text y="815" x="173">u1</svg:text><svg:line x2="548" y2="800" x1="588" y1="730"></svg:line><svg:rect width="220" height="30" y="800" x="438"></svg:rect><svg:text y="815" x="548">(Cons v ((app y2) (Cons s1 (Nil))))</svg:text><svg:line x2="232" y2="900" x1="548" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="224"></svg:rect><svg:text y="915" x="232">v</svg:text><svg:line x2="576" y2="900" x1="548" y1="830"></svg:line><svg:rect width="166" height="30" y="900" x="493"></svg:rect><svg:text y="915" x="576">((app y2) (Cons s1 (Nil)))</svg:text><svg:line x2="576" y2="1000" x1="576" y1="930"></svg:line><svg:rect width="592" height="30" y="1000" x="280"></svg:rect><svg:text y="1015" x="576">(((\z -&gt; (\r -&gt; case (z) of {Nil  -&gt; r; Cons w t -&gt; (Cons w ((app t) r));})) y2) (Cons s1 (Nil)))</svg:text><svg:line x2="576" y2="1100" x1="576" y1="1030"></svg:line><svg:rect width="538" height="30" y="1100" x="307"></svg:rect><svg:text y="1115" x="576">((\t1 -&gt; case (y2) of {Nil  -&gt; t1; Cons x y -&gt; (Cons x ((app y) t1));}) (Cons s1 (Nil)))</svg:text><svg:line x2="576" y2="1200" x1="576" y1="1130"></svg:line><svg:rect width="556" height="30" y="1200" x="298"></svg:rect><svg:text y="1215" x="576">case (y2) of {Nil  -&gt; (Cons s1 (Nil)); Cons x2 p1 -&gt; (Cons x2 ((app p1) (Cons s1 (Nil))));}</svg:text><svg:line x2="963" y2="800" x1="588" y1="730"></svg:line><svg:rect width="100" height="30" y="800" x="913"></svg:rect><svg:text y="815" x="963">(Cons s1 (Nil))</svg:text><svg:line x2="923" y2="900" x1="963" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="912"></svg:rect><svg:text y="915" x="923">s1</svg:text><svg:line x2="994" y2="900" x1="963" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="974"></svg:rect><svg:text y="915" x="994">(Nil)</svg:text><svg:line x2="1083" y2="700" x1="637" y1="630"></svg:line><svg:rect width="58" height="30" y="700" x="1054"></svg:rect><svg:text y="715" x="1083">(rev x1)</svg:text>
    <svg:path d="M 298, 1215 C 142, 1215 142, 715 316, 715" style="stroke:black;"></svg:path><svg:path d="M 1112, 715 C 1132, 715 1132, 15 595, 15" style="stroke:black;"></svg:path>
    </svg:svg>