<svg:svg width="2002" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="244" height="30" y="0" x="879"></svg:rect><svg:text y="15" x="1001">((map f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1001" y2="100" x1="1001" y1="30"></svg:line><svg:rect width="772" height="30" y="100" x="615"></svg:rect><svg:text y="115" x="1001">(((\x1 -&gt; (\u1 -&gt; case (u1) of {Nil  -&gt; (Nil); Cons y3 v3 -&gt; (Cons (x1 y3) ((map x1) v3));})) f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1001" y2="200" x1="1001" y1="130"></svg:line><svg:rect width="658" height="30" y="200" x="672"></svg:rect><svg:text y="215" x="1001">((\y4 -&gt; case (y4) of {Nil  -&gt; (Nil); Cons w t -&gt; (Cons (f w) ((map f) t));}) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1001" y2="300" x1="1001" y1="230"></svg:line><svg:rect width="586" height="30" y="300" x="708"></svg:rect><svg:text y="315" x="1001">case (((filter ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons x3 y -&gt; (Cons (f x3) ((map f) y));}</svg:text><svg:line x2="1001" y2="400" x1="1001" y1="330"></svg:line><svg:rect width="1432" height="30" y="400" x="285"></svg:rect><svg:text y="415" x="1001">case ((((\r3 -&gt; (\v2 -&gt; case (v2) of {Nil  -&gt; (Nil); Cons y1 v1 -&gt; case ((r3 y1)) of {True  -&gt; (Cons y1 ((filter r3) v1)); False  -&gt; ((filter r3) v1);};})) ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons x3 y -&gt; (Cons (f x3) ((map f) y));}</svg:text><svg:line x2="1001" y2="500" x1="1001" y1="430"></svg:line><svg:rect width="1504" height="30" y="500" x="249"></svg:rect><svg:text y="515" x="1001">case (((\r2 -&gt; case (r2) of {Nil  -&gt; (Nil); Cons u2 z4 -&gt; case ((((compose p) f) u2)) of {True  -&gt; (Cons u2 ((filter ((compose p) f)) z4)); False  -&gt; ((filter ((compose p) f)) z4);};}) xs)) of {Nil  -&gt; (Nil); Cons v s1 -&gt; (Cons (f v) ((map f) s1));}</svg:text><svg:line x2="1001" y2="600" x1="1001" y1="530"></svg:line><svg:rect width="1420" height="30" y="600" x="291"></svg:rect><svg:text y="615" x="1001">case (case (xs) of {Nil  -&gt; (Nil); Cons w1 x4 -&gt; case ((((compose p) f) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);};}) of {Nil  -&gt; (Nil); Cons u p1 -&gt; (Cons (f u) ((map f) p1));}</svg:text><svg:line x2="31" y2="700" x1="1001" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">xs</svg:text><svg:line x2="309" y2="700" x1="1001" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="309">case ((Nil)) of {Nil  -&gt; (Nil); Cons z3 w2 -&gt; (Cons (f z3) ((map f) w2));}</svg:text><svg:line x2="309" y2="800" x1="309" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="289"></svg:rect><svg:text y="815" x="309">(Nil)</svg:text><svg:line x2="1279" y2="700" x1="1001" y1="630"></svg:line><svg:rect width="1162" height="30" y="700" x="698"></svg:rect><svg:text y="715" x="1279">case (case ((((compose p) f) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);}) of {Nil  -&gt; (Nil); Cons z1 t1 -&gt; (Cons (f z1) ((map f) t1));}</svg:text><svg:line x2="1279" y2="800" x1="1279" y1="730"></svg:line><svg:rect width="1330" height="30" y="800" x="614"></svg:rect><svg:text y="815" x="1279">case (case (((((\r -&gt; (\z -&gt; (\z2 -&gt; (r (z z2))))) p) f) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);}) of {Nil  -&gt; (Nil); Cons z1 t1 -&gt; (Cons (f z1) ((map f) t1));}</svg:text><svg:line x2="1279" y2="900" x1="1279" y1="830"></svg:line><svg:rect width="1258" height="30" y="900" x="650"></svg:rect><svg:text y="915" x="1279">case (case ((((\t2 -&gt; (\w3 -&gt; (p (t2 w3)))) f) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);}) of {Nil  -&gt; (Nil); Cons p3 x -&gt; (Cons (f p3) ((map f) x));}</svg:text><svg:line x2="1279" y2="1000" x1="1279" y1="930"></svg:line><svg:rect width="1186" height="30" y="1000" x="686"></svg:rect><svg:text y="1015" x="1279">case (case (((\u3 -&gt; (p (f u3))) w1)) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);}) of {Nil  -&gt; (Nil); Cons s3 p2 -&gt; (Cons (f s3) ((map f) p2));}</svg:text><svg:line x2="1279" y2="1100" x1="1279" y1="1030"></svg:line><svg:rect width="1090" height="30" y="1100" x="734"></svg:rect><svg:text y="1115" x="1279">case (case ((p (f w1))) of {True  -&gt; (Cons w1 ((filter ((compose p) f)) x4)); False  -&gt; ((filter ((compose p) f)) x4);}) of {Nil  -&gt; (Nil); Cons x2 s -&gt; (Cons (f x2) ((map f) s));}</svg:text><svg:line x2="611" y2="1200" x1="1279" y1="1130"></svg:line><svg:rect width="70" height="30" y="1200" x="576"></svg:rect><svg:text y="1215" x="611">(p (f w1))</svg:text><svg:line x2="611" y2="1300" x1="611" y1="1230"></svg:line><svg:rect width="46" height="30" y="1300" x="588"></svg:rect><svg:text y="1315" x="611">(f w1)</svg:text><svg:line x2="611" y2="1400" x1="611" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="600"></svg:rect><svg:text y="1415" x="611">w1</svg:text><svg:line x2="1015" y2="1200" x1="1279" y1="1130"></svg:line><svg:rect width="658" height="30" y="1200" x="686"></svg:rect><svg:text y="1215" x="1015">case ((Cons w1 ((filter ((compose p) f)) x4))) of {Nil  -&gt; (Nil); Cons y2 s2 -&gt; (Cons (f y2) ((map f) s2));}</svg:text><svg:line x2="1015" y2="1300" x1="1015" y1="1230"></svg:line><svg:rect width="328" height="30" y="1300" x="851"></svg:rect><svg:text y="1315" x="1015">(Cons (f w1) ((map f) ((filter ((compose p) f)) x4)))</svg:text><svg:line x2="873" y2="1400" x1="1015" y1="1330"></svg:line><svg:rect width="46" height="30" y="1400" x="850"></svg:rect><svg:text y="1415" x="873">(f w1)</svg:text><svg:line x2="873" y2="1500" x1="873" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="862"></svg:rect><svg:text y="1515" x="873">w1</svg:text><svg:line x2="1058" y2="1400" x1="1015" y1="1330"></svg:line><svg:rect width="244" height="30" y="1400" x="936"></svg:rect><svg:text y="1415" x="1058">((map f) ((filter ((compose p) f)) x4))</svg:text><svg:line x2="1683" y2="1200" x1="1279" y1="1130"></svg:line><svg:rect width="598" height="30" y="1200" x="1384"></svg:rect><svg:text y="1215" x="1683">case (((filter ((compose p) f)) x4)) of {Nil  -&gt; (Nil); Cons t3 r1 -&gt; (Cons (f t3) ((map f) r1));}</svg:text>
    <svg:path d="M 1180, 1415 C 2002, 1415 2002, 15 1123, 15" style="stroke:black;"></svg:path><svg:path d="M 1982, 1215 C 2002, 1215 2002, 315 1294, 315" style="stroke:black;"></svg:path>
    </svg:svg>