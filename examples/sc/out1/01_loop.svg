<svg:svg width="910" height="1030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="94" height="30" y="0" x="408"></svg:rect><svg:text y="15" x="455">(((f1 x) y) d)</svg:text><svg:line x2="455" y2="100" x1="455" y1="30"></svg:line><svg:rect width="592" height="30" y="100" x="159"></svg:rect><svg:text y="115" x="455">((((\w -&gt; (\t -&gt; (\z1 -&gt; case ((g w)) of {Z  -&gt; (z1 t); S v1 -&gt; (((f v1) (S t)) z1);}))) x) y) d)</svg:text><svg:line x2="455" y2="200" x1="455" y1="130"></svg:line><svg:rect width="502" height="30" y="200" x="204"></svg:rect><svg:text y="215" x="455">(((\z -&gt; (\r -&gt; case ((g x)) of {Z  -&gt; (r z); S x1 -&gt; (((f x1) (S z)) r);})) y) d)</svg:text><svg:line x2="455" y2="300" x1="455" y1="230"></svg:line><svg:rect width="436" height="30" y="300" x="237"></svg:rect><svg:text y="315" x="455">((\u1 -&gt; case ((g x)) of {Z  -&gt; (u1 y); S v -&gt; (((f v) (S y)) u1);}) d)</svg:text><svg:line x2="455" y2="400" x1="455" y1="330"></svg:line><svg:rect width="346" height="30" y="400" x="282"></svg:rect><svg:text y="415" x="455">case ((g x)) of {Z  -&gt; (d y); S s -&gt; (((f s) (S y)) d);}</svg:text><svg:line x2="455" y2="500" x1="455" y1="430"></svg:line><svg:rect width="406" height="30" y="500" x="252"></svg:rect><svg:text y="515" x="455">case (((\w1 -&gt; w1) x)) of {Z  -&gt; (d y); S s -&gt; (((f s) (S y)) d);}</svg:text><svg:line x2="455" y2="600" x1="455" y1="530"></svg:line><svg:rect width="334" height="30" y="600" x="288"></svg:rect><svg:text y="615" x="455">case (x) of {Z  -&gt; (d y); S y1 -&gt; (((f y1) (S y)) d);}</svg:text><svg:line x2="28" y2="700" x1="455" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="28">x</svg:text><svg:line x2="96" y2="700" x1="455" y1="630"></svg:line><svg:rect width="40" height="30" y="700" x="76"></svg:rect><svg:text y="715" x="96">(d y)</svg:text><svg:line x2="96" y2="800" x1="96" y1="730"></svg:line><svg:rect width="16" height="30" y="800" x="88"></svg:rect><svg:text y="815" x="96">y</svg:text><svg:line x2="523" y2="700" x1="455" y1="630"></svg:line><svg:rect width="118" height="30" y="700" x="464"></svg:rect><svg:text y="715" x="523">(((f y1) (S y)) d)</svg:text><svg:line x2="523" y2="800" x1="523" y1="730"></svg:line><svg:rect width="724" height="30" y="800" x="161"></svg:rect><svg:text y="815" x="523">let p=y1, u=(S y)
 in ((((\w -&gt; (\t -&gt; (\z1 -&gt; case ((g w)) of {Z  -&gt; (z1 t); S v1 -&gt; (((f v1) (S t)) z1);}))) p) u) d)</svg:text><svg:line x2="452" y2="900" x1="523" y1="830"></svg:line><svg:rect width="592" height="30" y="900" x="156"></svg:rect><svg:text y="915" x="452">((((\w -&gt; (\t -&gt; (\z1 -&gt; case ((g w)) of {Z  -&gt; (z1 t); S v1 -&gt; (((f v1) (S t)) z1);}))) p) u) d)</svg:text><svg:line x2="799" y2="900" x1="523" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="788"></svg:rect><svg:text y="915" x="799">y1</svg:text><svg:line x2="870" y2="900" x1="523" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="850"></svg:rect><svg:text y="915" x="870">(S y)</svg:text><svg:line x2="870" y2="1000" x1="870" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="862"></svg:rect><svg:text y="1015" x="870">y</svg:text>
    <svg:path d="M 156, 915 C 0, 915 0, 115 159, 115" style="stroke:black;"></svg:path>
    </svg:svg>