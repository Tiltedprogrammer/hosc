<svg:svg width="5006" height="3630" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="358" height="30" y="0" x="2324"></svg:rect><svg:text y="15" x="2503">(((compose ((compose join) join)) (map (map (map f)))) xs)</svg:text><svg:line x2="2503" y2="100" x1="2503" y1="30"></svg:line><svg:rect width="550" height="30" y="100" x="2228"></svg:rect><svg:text y="115" x="2503">((((\p8 -&gt; (\r5 -&gt; (\v2 -&gt; (p8 (r5 v2))))) ((compose join) join)) (map (map (map f)))) xs)</svg:text><svg:line x2="2503" y2="200" x1="2503" y1="130"></svg:line><svg:rect width="466" height="30" y="200" x="2270"></svg:rect><svg:text y="215" x="2503">(((\x1 -&gt; (\w4 -&gt; (((compose join) join) (x1 w4)))) (map (map (map f)))) xs)</svg:text><svg:line x2="2503" y2="300" x1="2503" y1="230"></svg:line><svg:rect width="382" height="30" y="300" x="2312"></svg:rect><svg:text y="315" x="2503">((\v6 -&gt; (((compose join) join) ((map (map (map f))) v6))) xs)</svg:text><svg:line x2="2503" y2="400" x1="2503" y1="330"></svg:line><svg:rect width="298" height="30" y="400" x="2354"></svg:rect><svg:text y="415" x="2503">(((compose join) join) ((map (map (map f))) xs))</svg:text><svg:line x2="2503" y2="500" x1="2503" y1="430"></svg:line><svg:rect width="490" height="30" y="500" x="2258"></svg:rect><svg:text y="515" x="2503">((((\s9 -&gt; (\t2 -&gt; (\r6 -&gt; (s9 (t2 r6))))) join) join) ((map (map (map f))) xs))</svg:text><svg:line x2="2503" y2="600" x1="2503" y1="530"></svg:line><svg:rect width="418" height="30" y="600" x="2294"></svg:rect><svg:text y="615" x="2503">(((\p10 -&gt; (\r8 -&gt; (join (p10 r8)))) join) ((map (map (map f))) xs))</svg:text><svg:line x2="2503" y2="700" x1="2503" y1="630"></svg:line><svg:rect width="322" height="30" y="700" x="2342"></svg:rect><svg:text y="715" x="2503">((\v7 -&gt; (join (join v7))) ((map (map (map f))) xs))</svg:text><svg:line x2="2503" y2="800" x1="2503" y1="730"></svg:line><svg:rect width="238" height="30" y="800" x="2384"></svg:rect><svg:text y="815" x="2503">(join (join ((map (map (map f))) xs)))</svg:text><svg:line x2="2503" y2="900" x1="2503" y1="830"></svg:line><svg:rect width="664" height="30" y="900" x="2171"></svg:rect><svg:text y="915" x="2503">((\x4 -&gt; case (x4) of {Nil  -&gt; (Nil); Cons t s2 -&gt; ((append t) (join s2));}) (join ((map (map (map f))) xs)))</svg:text><svg:line x2="2503" y2="1000" x1="2503" y1="930"></svg:line><svg:rect width="592" height="30" y="1000" x="2207"></svg:rect><svg:text y="1015" x="2503">case ((join ((map (map (map f))) xs))) of {Nil  -&gt; (Nil); Cons x5 z6 -&gt; ((append x5) (join z6));}</svg:text><svg:line x2="2503" y2="1100" x1="2503" y1="1030"></svg:line><svg:rect width="1042" height="30" y="1100" x="1982"></svg:rect><svg:text y="1115" x="2503">case (((\v12 -&gt; case (v12) of {Nil  -&gt; (Nil); Cons s x12 -&gt; ((append s) (join x12));}) ((map (map (map f))) xs))) of {Nil  -&gt; (Nil); Cons x5 z6 -&gt; ((append x5) (join z6));}</svg:text><svg:line x2="2503" y2="1200" x1="2503" y1="1130"></svg:line><svg:rect width="958" height="30" y="1200" x="2024"></svg:rect><svg:text y="1215" x="2503">case (case (((map (map (map f))) xs)) of {Nil  -&gt; (Nil); Cons z10 w8 -&gt; ((append z10) (join w8));}) of {Nil  -&gt; (Nil); Cons p7 r4 -&gt; ((append p7) (join r4));}</svg:text><svg:line x2="2503" y2="1300" x1="2503" y1="1230"></svg:line><svg:rect width="1468" height="30" y="1300" x="1769"></svg:rect><svg:text y="1315" x="2503">case (case ((((\x -&gt; (\u2 -&gt; case (u2) of {Nil  -&gt; (Nil); Cons u4 w6 -&gt; (Cons (x u4) ((map x) w6));})) (map (map f))) xs)) of {Nil  -&gt; (Nil); Cons z10 w8 -&gt; ((append z10) (join w8));}) of {Nil  -&gt; (Nil); Cons p7 r4 -&gt; ((append p7) (join r4));}</svg:text><svg:line x2="2503" y2="1400" x1="2503" y1="1330"></svg:line><svg:rect width="1456" height="30" y="1400" x="1775"></svg:rect><svg:text y="1415" x="2503">case (case (((\w12 -&gt; case (w12) of {Nil  -&gt; (Nil); Cons z r7 -&gt; (Cons ((map (map f)) z) ((map (map (map f))) r7));}) xs)) of {Nil  -&gt; (Nil); Cons s1 x2 -&gt; ((append s1) (join x2));}) of {Nil  -&gt; (Nil); Cons s5 t8 -&gt; ((append s5) (join t8));}</svg:text><svg:line x2="2503" y2="1500" x1="2503" y1="1430"></svg:line><svg:rect width="1396" height="30" y="1500" x="1805"></svg:rect><svg:text y="1515" x="2503">case (case (case (xs) of {Nil  -&gt; (Nil); Cons s11 y10 -&gt; (Cons ((map (map f)) s11) ((map (map (map f))) y10));}) of {Nil  -&gt; (Nil); Cons s8 v5 -&gt; ((append s8) (join v5));}) of {Nil  -&gt; (Nil); Cons p r10 -&gt; ((append p) (join r10));}</svg:text><svg:line x2="31" y2="1600" x1="2503" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="20"></svg:rect><svg:text y="1615" x="31">xs</svg:text><svg:line x2="492" y2="1600" x1="2503" y1="1530"></svg:line><svg:rect width="820" height="30" y="1600" x="82"></svg:rect><svg:text y="1615" x="492">case (case ((Nil)) of {Nil  -&gt; (Nil); Cons y7 t3 -&gt; ((append y7) (join t3));}) of {Nil  -&gt; (Nil); Cons y9 w -&gt; ((append y9) (join w));}</svg:text><svg:line x2="492" y2="1700" x1="492" y1="1630"></svg:line><svg:rect width="448" height="30" y="1700" x="268"></svg:rect><svg:text y="1715" x="492">case ((Nil)) of {Nil  -&gt; (Nil); Cons t4 z11 -&gt; ((append t4) (join z11));}</svg:text><svg:line x2="492" y2="1800" x1="492" y1="1730"></svg:line><svg:rect width="40" height="30" y="1800" x="472"></svg:rect><svg:text y="1815" x="492">(Nil)</svg:text><svg:line x2="2964" y2="1600" x1="2503" y1="1530"></svg:line><svg:rect width="1114" height="30" y="1600" x="2407"></svg:rect><svg:text y="1615" x="2964">case (case ((Cons ((map (map f)) s11) ((map (map (map f))) y10))) of {Nil  -&gt; (Nil); Cons t5 y8 -&gt; ((append t5) (join y8));}) of {Nil  -&gt; (Nil); Cons t9 w2 -&gt; ((append t9) (join w2));}</svg:text><svg:line x2="2964" y2="1700" x1="2964" y1="1630"></svg:line><svg:rect width="796" height="30" y="1700" x="2566"></svg:rect><svg:text y="1715" x="2964">case (((append ((map (map f)) s11)) (join ((map (map (map f))) y10)))) of {Nil  -&gt; (Nil); Cons y5 w10 -&gt; ((append y5) (join w10));}</svg:text><svg:line x2="2964" y2="1800" x1="2964" y1="1730"></svg:line><svg:rect width="1288" height="30" y="1800" x="2320"></svg:rect><svg:text y="1815" x="2964">case ((((\p11 -&gt; (\s7 -&gt; case (p11) of {Nil  -&gt; s7; Cons p1 y6 -&gt; (Cons p1 ((append y6) s7));})) ((map (map f)) s11)) (join ((map (map (map f))) y10)))) of {Nil  -&gt; (Nil); Cons y5 w10 -&gt; ((append y5) (join w10));}</svg:text><svg:line x2="2964" y2="1900" x1="2964" y1="1830"></svg:line><svg:rect width="1180" height="30" y="1900" x="2374"></svg:rect><svg:text y="1915" x="2964">case (((\r9 -&gt; case (((map (map f)) s11)) of {Nil  -&gt; r9; Cons r p4 -&gt; (Cons r ((append p4) r9));}) (join ((map (map (map f))) y10)))) of {Nil  -&gt; (Nil); Cons z7 v10 -&gt; ((append z7) (join v10));}</svg:text><svg:line x2="2964" y2="2000" x1="2964" y1="1930"></svg:line><svg:rect width="1288" height="30" y="2000" x="2320"></svg:rect><svg:text y="2015" x="2964">case (case (((map (map f)) s11)) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons p2 s3 -&gt; (Cons p2 ((append s3) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons z8 v11 -&gt; ((append z8) (join v11));}</svg:text><svg:line x2="2964" y2="2100" x1="2964" y1="2030"></svg:line><svg:rect width="1828" height="30" y="2100" x="2050"></svg:rect><svg:text y="2115" x="2964">case (case ((((\p3 -&gt; (\y11 -&gt; case (y11) of {Nil  -&gt; (Nil); Cons x9 u8 -&gt; (Cons (p3 x9) ((map p3) u8));})) (map f)) s11)) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons p2 s3 -&gt; (Cons p2 ((append s3) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons z8 v11 -&gt; ((append z8) (join v11));}</svg:text><svg:line x2="2964" y2="2200" x1="2964" y1="2130"></svg:line><svg:rect width="1774" height="30" y="2200" x="2077"></svg:rect><svg:text y="2215" x="2964">case (case (((\s10 -&gt; case (s10) of {Nil  -&gt; (Nil); Cons v1 u3 -&gt; (Cons ((map f) v1) ((map (map f)) u3));}) s11)) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons t11 v9 -&gt; (Cons t11 ((append v9) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons z5 u6 -&gt; ((append z5) (join u6));}</svg:text><svg:line x2="2964" y2="2300" x1="2964" y1="2230"></svg:line><svg:rect width="1690" height="30" y="2300" x="2119"></svg:rect><svg:text y="2315" x="2964">case (case (case (s11) of {Nil  -&gt; (Nil); Cons w3 w11 -&gt; (Cons ((map f) w3) ((map (map f)) w11));}) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons t10 t7 -&gt; (Cons t10 ((append t7) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons u10 u -&gt; ((append u10) (join u));}</svg:text><svg:line x2="956" y2="2400" x1="2964" y1="2330"></svg:line><svg:rect width="28" height="30" y="2400" x="942"></svg:rect><svg:text y="2415" x="956">s11</svg:text><svg:line x2="1606" y2="2400" x1="2964" y1="2330"></svg:line><svg:rect width="1192" height="30" y="2400" x="1010"></svg:rect><svg:text y="2415" x="1606">case (case ((Nil)) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons v x10 -&gt; (Cons v ((append x10) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons x8 y4 -&gt; ((append x8) (join y4));}</svg:text><svg:line x2="1606" y2="2500" x1="1606" y1="2430"></svg:line><svg:rect width="598" height="30" y="2500" x="1307"></svg:rect><svg:text y="2515" x="1606">case ((join ((map (map (map f))) y10))) of {Nil  -&gt; (Nil); Cons z1 z3 -&gt; ((append z1) (join z3));}</svg:text><svg:line x2="3614" y2="2400" x1="2964" y1="2330"></svg:line><svg:rect width="1408" height="30" y="2400" x="2910"></svg:rect><svg:text y="2415" x="3614">case (case ((Cons ((map f) w3) ((map (map f)) w11))) of {Nil  -&gt; (join ((map (map (map f))) y10)); Cons z9 x6 -&gt; (Cons z9 ((append x6) (join ((map (map (map f))) y10))));}) of {Nil  -&gt; (Nil); Cons z2 u11 -&gt; ((append z2) (join u11));}</svg:text><svg:line x2="3614" y2="2500" x1="3614" y1="2430"></svg:line><svg:rect width="904" height="30" y="2500" x="3162"></svg:rect><svg:text y="2515" x="3614">case ((Cons ((map f) w3) ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))) of {Nil  -&gt; (Nil); Cons v8 w7 -&gt; ((append v8) (join w7));}</svg:text><svg:line x2="3614" y2="2600" x1="3614" y1="2530"></svg:line><svg:rect width="574" height="30" y="2600" x="3327"></svg:rect><svg:text y="2615" x="3614">((append ((map f) w3)) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))))</svg:text><svg:line x2="3614" y2="2700" x1="3614" y1="2630"></svg:line><svg:rect width="1054" height="30" y="2700" x="3087"></svg:rect><svg:text y="2715" x="3614">(((\y -&gt; (\y1 -&gt; case (y) of {Nil  -&gt; y1; Cons y12 u7 -&gt; (Cons y12 ((append u7) y1));})) ((map f) w3)) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))))</svg:text><svg:line x2="3614" y2="2800" x1="3614" y1="2730"></svg:line><svg:rect width="970" height="30" y="2800" x="3129"></svg:rect><svg:text y="2815" x="3614">((\v4 -&gt; case (((map f) w3)) of {Nil  -&gt; v4; Cons p9 u5 -&gt; (Cons p9 ((append u5) v4));}) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))))</svg:text><svg:line x2="3614" y2="2900" x1="3614" y1="2830"></svg:line><svg:rect width="1306" height="30" y="2900" x="2961"></svg:rect><svg:text y="2915" x="3614">case (((map f) w3)) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons t1 x11 -&gt; (Cons t1 ((append x11) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="3614" y2="3000" x1="3614" y1="2930"></svg:line><svg:rect width="1834" height="30" y="3000" x="2697"></svg:rect><svg:text y="3015" x="3614">case ((((\z4 -&gt; (\s4 -&gt; case (s4) of {Nil  -&gt; (Nil); Cons y3 x7 -&gt; (Cons (z4 y3) ((map z4) x7));})) f) w3)) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons t1 x11 -&gt; (Cons t1 ((append x11) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="3614" y2="3100" x1="3614" y1="3030"></svg:line><svg:rect width="1744" height="30" y="3100" x="2742"></svg:rect><svg:text y="3115" x="3614">case (((\z12 -&gt; case (z12) of {Nil  -&gt; (Nil); Cons r2 p5 -&gt; (Cons (f r2) ((map f) p5));}) w3)) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons w9 p6 -&gt; (Cons w9 ((append p6) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="3614" y2="3200" x1="3614" y1="3130"></svg:line><svg:rect width="1648" height="30" y="3200" x="2790"></svg:rect><svg:text y="3215" x="3614">case (case (w3) of {Nil  -&gt; (Nil); Cons v3 w1 -&gt; (Cons (f v3) ((map f) w1));}) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons r1 u1 -&gt; (Cons r1 ((append u1) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="2253" y2="3300" x1="3614" y1="3230"></svg:line><svg:rect width="22" height="30" y="3300" x="2242"></svg:rect><svg:text y="3315" x="2253">w3</svg:text><svg:line x2="2930" y2="3300" x1="3614" y1="3230"></svg:line><svg:rect width="1252" height="30" y="3300" x="2304"></svg:rect><svg:text y="3315" x="2930">case ((Nil)) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons r3 t6 -&gt; (Cons r3 ((append t6) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="2930" y2="3400" x1="2930" y1="3330"></svg:line><svg:rect width="430" height="30" y="3400" x="2715"></svg:rect><svg:text y="3415" x="2930">(join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))</svg:text><svg:line x2="2930" y2="3500" x1="2930" y1="3430"></svg:line><svg:rect width="868" height="30" y="3500" x="2496"></svg:rect><svg:text y="3515" x="2930">((\s6 -&gt; case (s6) of {Nil  -&gt; (Nil); Cons x3 w5 -&gt; ((append x3) (join w5));}) ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))</svg:text><svg:line x2="2930" y2="3600" x1="2930" y1="3530"></svg:line><svg:rect width="796" height="30" y="3600" x="2532"></svg:rect><svg:text y="3615" x="2930">case (((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))) of {Nil  -&gt; (Nil); Cons u9 u12 -&gt; ((append u9) (join u12));}</svg:text><svg:line x2="4291" y2="3300" x1="3614" y1="3230"></svg:line><svg:rect width="1390" height="30" y="3300" x="3596"></svg:rect><svg:text y="3315" x="4291">case ((Cons (f v3) ((map f) w1))) of {Nil  -&gt; (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))); Cons r11 y2 -&gt; (Cons r11 ((append y2) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))));}</svg:text><svg:line x2="4291" y2="3400" x1="4291" y1="3330"></svg:line><svg:rect width="658" height="30" y="3400" x="3962"></svg:rect><svg:text y="3415" x="4291">(Cons (f v3) ((append ((map f) w1)) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10))))))</svg:text><svg:line x2="3984" y2="3500" x1="4291" y1="3430"></svg:line><svg:rect width="46" height="30" y="3500" x="3961"></svg:rect><svg:text y="3515" x="3984">(f v3)</svg:text><svg:line x2="3984" y2="3600" x1="3984" y1="3530"></svg:line><svg:rect width="22" height="30" y="3600" x="3973"></svg:rect><svg:text y="3615" x="3984">v3</svg:text><svg:line x2="4334" y2="3500" x1="4291" y1="3430"></svg:line><svg:rect width="574" height="30" y="3500" x="4047"></svg:rect><svg:text y="3515" x="4334">((append ((map f) w1)) (join ((append ((map (map f)) w11)) (join ((map (map (map f))) y10)))))</svg:text>
    <svg:path d="M 1307, 2515 C 0, 2515 0, 1015 2207, 1015" style="stroke:black;"></svg:path><svg:path d="M 2532, 3615 C 922, 3615 922, 1715 2566, 1715" style="stroke:black;"></svg:path><svg:path d="M 4621, 3515 C 5006, 3515 5006, 2615 3901, 2615" style="stroke:black;"></svg:path>
    </svg:svg>