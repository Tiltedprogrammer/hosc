<svg:svg width="836" height="1030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="88" height="30" y="0" x="374"></svg:rect><svg:text y="15" x="418">(((f y) z) x)</svg:text><svg:line x2="418" y2="100" x1="418" y1="30"></svg:line><svg:rect width="670" height="30" y="100" x="83"></svg:rect><svg:text y="115" x="418">((((\p -&gt; (\t -&gt; (\w2 -&gt; case (w2) of {Nil  -&gt; ((g t) p); Cons w1 s1 -&gt; (Cons w1 (((f p) t) s1));}))) y) z) x)</svg:text><svg:line x2="418" y2="200" x1="418" y1="130"></svg:line><svg:rect width="592" height="30" y="200" x="122"></svg:rect><svg:text y="215" x="418">(((\v1 -&gt; (\s -&gt; case (s) of {Nil  -&gt; ((g v1) y); Cons u y1 -&gt; (Cons u (((f y) v1) y1));})) z) x)</svg:text><svg:line x2="418" y2="300" x1="418" y1="230"></svg:line><svg:rect width="514" height="30" y="300" x="161"></svg:rect><svg:text y="315" x="418">((\r1 -&gt; case (r1) of {Nil  -&gt; ((g z) y); Cons z2 w -&gt; (Cons z2 (((f y) z) w));}) x)</svg:text><svg:line x2="418" y2="400" x1="418" y1="330"></svg:line><svg:rect width="442" height="30" y="400" x="197"></svg:rect><svg:text y="415" x="418">case (x) of {Nil  -&gt; ((g z) y); Cons z1 u2 -&gt; (Cons z1 (((f y) z) u2));}</svg:text><svg:line x2="28" y2="500" x1="418" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="28">x</svg:text><svg:line x2="348" y2="500" x1="418" y1="430"></svg:line><svg:rect width="64" height="30" y="500" x="316"></svg:rect><svg:text y="515" x="348">((g z) y)</svg:text><svg:line x2="348" y2="600" x1="348" y1="530"></svg:line><svg:rect width="544" height="30" y="600" x="76"></svg:rect><svg:text y="615" x="348">(((\v2 -&gt; (\t1 -&gt; case (t1) of {Nil  -&gt; v2; Cons u1 y2 -&gt; (Cons u1 ((g v2) y2));})) z) y)</svg:text><svg:line x2="348" y2="700" x1="348" y1="630"></svg:line><svg:rect width="442" height="30" y="700" x="127"></svg:rect><svg:text y="715" x="348">((\v -&gt; case (v) of {Nil  -&gt; z; Cons x1 p1 -&gt; (Cons x1 ((g z) p1));}) y)</svg:text><svg:line x2="348" y2="800" x1="348" y1="730"></svg:line><svg:rect width="358" height="30" y="800" x="169"></svg:rect><svg:text y="815" x="348">case (y) of {Nil  -&gt; z; Cons x2 r -&gt; (Cons x2 ((g z) r));}</svg:text><svg:line x2="237" y2="900" x1="348" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="229"></svg:rect><svg:text y="915" x="237">y</svg:text><svg:line x2="293" y2="900" x1="348" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="285"></svg:rect><svg:text y="915" x="293">z</svg:text><svg:line x2="404" y2="900" x1="348" y1="830"></svg:line><svg:rect width="124" height="30" y="900" x="342"></svg:rect><svg:text y="915" x="404">(Cons x2 ((g z) r))</svg:text><svg:line x2="352" y2="1000" x1="404" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="341"></svg:rect><svg:text y="1015" x="352">x2</svg:text><svg:line x2="435" y2="1000" x1="404" y1="930"></svg:line><svg:rect width="64" height="30" y="1000" x="403"></svg:rect><svg:text y="1015" x="435">((g z) r)</svg:text><svg:line x2="738" y2="500" x1="418" y1="430"></svg:line><svg:rect width="154" height="30" y="500" x="661"></svg:rect><svg:text y="515" x="738">(Cons z1 (((f y) z) u2))</svg:text><svg:line x2="671" y2="600" x1="738" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="660"></svg:rect><svg:text y="615" x="671">z1</svg:text><svg:line x2="769" y2="600" x1="738" y1="530"></svg:line><svg:rect width="94" height="30" y="600" x="722"></svg:rect><svg:text y="615" x="769">(((f y) z) u2)</svg:text>
    <svg:path d="M 467, 1015 C 640, 1015 640, 515 380, 515" style="stroke:black;"></svg:path><svg:path d="M 816, 615 C 836, 615 836, 15 462, 15" style="stroke:black;"></svg:path>
    </svg:svg>