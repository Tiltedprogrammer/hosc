<svg:svg width="738" height="830" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="250" height="30" y="0" x="244"></svg:rect><svg:text y="15" x="369">let u1=x, z1=(Z)
 in (((f u1) (S z1)) d)</svg:text><svg:line x2="307" y2="100" x1="369" y1="30"></svg:line><svg:rect width="124" height="30" y="100" x="245"></svg:rect><svg:text y="115" x="307">(((f u1) (S z1)) d)</svg:text><svg:line x2="307" y2="200" x1="307" y1="130"></svg:line><svg:rect width="574" height="30" y="200" x="20"></svg:rect><svg:text y="215" x="307">((((\t -&gt; (\z -&gt; (\p -&gt; case (t) of {Z  -&gt; (p z); S s -&gt; (((f s) (S z)) p);}))) u1) (S z1)) d)</svg:text><svg:line x2="307" y2="300" x1="307" y1="230"></svg:line><svg:rect width="520" height="30" y="300" x="47"></svg:rect><svg:text y="315" x="307">(((\y1 -&gt; (\u -&gt; case (u1) of {Z  -&gt; (u y1); S w -&gt; (((f w) (S y1)) u);})) (S z1)) d)</svg:text><svg:line x2="307" y2="400" x1="307" y1="330"></svg:line><svg:rect width="460" height="30" y="400" x="77"></svg:rect><svg:text y="415" x="307">((\r -&gt; case (u1) of {Z  -&gt; (r (S z1)); S v -&gt; (((f v) (S (S z1))) r);}) d)</svg:text><svg:line x2="307" y2="500" x1="307" y1="430"></svg:line><svg:rect width="388" height="30" y="500" x="113"></svg:rect><svg:text y="515" x="307">case (u1) of {Z  -&gt; (d (S z1)); S y -&gt; (((f y) (S (S z1))) d);}</svg:text><svg:line x2="98" y2="600" x1="307" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="87"></svg:rect><svg:text y="615" x="98">u1</svg:text><svg:line x2="184" y2="600" x1="307" y1="530"></svg:line><svg:rect width="70" height="30" y="600" x="149"></svg:rect><svg:text y="615" x="184">(d (S z1))</svg:text><svg:line x2="184" y2="700" x1="184" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="161"></svg:rect><svg:text y="715" x="184">(S z1)</svg:text><svg:line x2="184" y2="800" x1="184" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="173"></svg:rect><svg:text y="815" x="184">z1</svg:text><svg:line x2="393" y2="600" x1="307" y1="530"></svg:line><svg:rect width="268" height="30" y="600" x="259"></svg:rect><svg:text y="615" x="393">let x1=y, v1=(S z1)
 in (((f x1) (S v1)) d)</svg:text><svg:line x2="322" y2="700" x1="393" y1="630"></svg:line><svg:rect width="124" height="30" y="700" x="260"></svg:rect><svg:text y="715" x="322">(((f x1) (S v1)) d)</svg:text><svg:line x2="432" y2="700" x1="393" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="424"></svg:rect><svg:text y="715" x="432">y</svg:text><svg:line x2="503" y2="700" x1="393" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="480"></svg:rect><svg:text y="715" x="503">(S z1)</svg:text><svg:line x2="503" y2="800" x1="503" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="492"></svg:rect><svg:text y="815" x="503">z1</svg:text><svg:line x2="642" y2="100" x1="369" y1="30"></svg:line><svg:rect width="16" height="30" y="100" x="634"></svg:rect><svg:text y="115" x="642">x</svg:text><svg:line x2="704" y2="100" x1="369" y1="30"></svg:line><svg:rect width="28" height="30" y="100" x="690"></svg:rect><svg:text y="115" x="704">(Z)</svg:text>
    <svg:path d="M 384, 715 C 614, 715 614, 115 369, 115" style="stroke:black;"></svg:path>
    </svg:svg>