<svg:svg width="1658" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="196" height="30" y="0" x="731"></svg:rect><svg:text y="15" x="829">(even ((double n) (S (S (Z)))))</svg:text><svg:line x2="829" y2="100" x1="829" y1="30"></svg:line><svg:rect width="730" height="30" y="100" x="464"></svg:rect><svg:text y="115" x="829">((\z2 -&gt; case (z2) of {Z  -&gt; (True); S y1 -&gt; case (y1) of {Z  -&gt; (False); S u -&gt; (even u);};}) ((double n) (S (S (Z)))))</svg:text><svg:line x2="829" y2="200" x1="829" y1="130"></svg:line><svg:rect width="772" height="30" y="200" x="443"></svg:rect><svg:text y="215" x="829">let w=n, z1=(Z)
 in case (((double w) (S (S z1)))) of {S r2 -&gt; case (r2) of {S x2 -&gt; (even x2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="767" y2="300" x1="829" y1="230"></svg:line><svg:rect width="652" height="30" y="300" x="441"></svg:rect><svg:text y="315" x="767">case (((double w) (S (S z1)))) of {S r2 -&gt; case (r2) of {S x2 -&gt; (even x2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="767" y2="400" x1="767" y1="330"></svg:line><svg:rect width="1060" height="30" y="400" x="237"></svg:rect><svg:text y="415" x="767">case ((((\t1 -&gt; (\x1 -&gt; case (t1) of {Z  -&gt; x1; S x -&gt; ((double x) (S (S x1)));})) w) (S (S z1)))) of {S r2 -&gt; case (r2) of {S x2 -&gt; (even x2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="767" y2="500" x1="767" y1="430"></svg:line><svg:rect width="970" height="30" y="500" x="282"></svg:rect><svg:text y="515" x="767">case (((\p -&gt; case (w) of {Z  -&gt; p; S u1 -&gt; ((double u1) (S (S p)));}) (S (S z1)))) of {S w1 -&gt; case (w1) of {S u2 -&gt; (even u2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="767" y2="600" x1="767" y1="530"></svg:line><svg:rect width="928" height="30" y="600" x="303"></svg:rect><svg:text y="615" x="767">case (case (w) of {Z  -&gt; (S (S z1)); S y -&gt; ((double y) (S (S (S (S z1)))));}) of {S r -&gt; case (r) of {S v2 -&gt; (even v2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="28" y2="700" x1="767" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="28">w</svg:text><svg:line x2="369" y2="700" x1="767" y1="630"></svg:line><svg:rect width="574" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="369">case ((S (S z1))) of {S y2 -&gt; case (y2) of {S p1 -&gt; (even p1); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="369" y2="800" x1="369" y1="730"></svg:line><svg:rect width="322" height="30" y="800" x="208"></svg:rect><svg:text y="815" x="369">case ((S z1)) of {S s1 -&gt; (even s1); Z  -&gt; (False);}</svg:text><svg:line x2="369" y2="900" x1="369" y1="830"></svg:line><svg:rect width="64" height="30" y="900" x="337"></svg:rect><svg:text y="915" x="369">(even z1)</svg:text><svg:line x2="369" y2="1000" x1="369" y1="930"></svg:line><svg:rect width="586" height="30" y="1000" x="76"></svg:rect><svg:text y="1015" x="369">((\p2 -&gt; case (p2) of {Z  -&gt; (True); S v -&gt; case (v) of {Z  -&gt; (False); S t -&gt; (even t);};}) z1)</svg:text><svg:line x2="369" y2="1100" x1="369" y1="1030"></svg:line><svg:rect width="526" height="30" y="1100" x="106"></svg:rect><svg:text y="1115" x="369">case (z1) of {Z  -&gt; (True); S w2 -&gt; case (w2) of {Z  -&gt; (False); S r1 -&gt; (even r1);};}</svg:text><svg:line x2="157" y2="1200" x1="369" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="146"></svg:rect><svg:text y="1215" x="157">z1</svg:text><svg:line x2="231" y2="1200" x1="369" y1="1130"></svg:line><svg:rect width="46" height="30" y="1200" x="208"></svg:rect><svg:text y="1215" x="231">(True)</svg:text><svg:line x2="443" y2="1200" x1="369" y1="1130"></svg:line><svg:rect width="298" height="30" y="1200" x="294"></svg:rect><svg:text y="1215" x="443">case (w2) of {Z  -&gt; (False); S v1 -&gt; (even v1);}</svg:text><svg:line x2="345" y2="1300" x1="443" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="334"></svg:rect><svg:text y="1315" x="345">w2</svg:text><svg:line x2="422" y2="1300" x1="443" y1="1230"></svg:line><svg:rect width="52" height="30" y="1300" x="396"></svg:rect><svg:text y="1315" x="422">(False)</svg:text><svg:line x2="520" y2="1300" x1="443" y1="1230"></svg:line><svg:rect width="64" height="30" y="1300" x="488"></svg:rect><svg:text y="1315" x="520">(even v1)</svg:text><svg:line x2="1108" y2="700" x1="767" y1="630"></svg:line><svg:rect width="802" height="30" y="700" x="707"></svg:rect><svg:text y="715" x="1108">let z=(S (S z1)), s=y
 in case (((double s) (S (S z)))) of {S r2 -&gt; case (r2) of {S x2 -&gt; (even x2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="1025" y2="800" x1="1108" y1="730"></svg:line><svg:rect width="646" height="30" y="800" x="702"></svg:rect><svg:text y="815" x="1025">case (((double s) (S (S z)))) of {S r2 -&gt; case (r2) of {S x2 -&gt; (even x2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="1423" y2="800" x1="1108" y1="730"></svg:line><svg:rect width="70" height="30" y="800" x="1388"></svg:rect><svg:text y="815" x="1423">(S (S z1))</svg:text><svg:line x2="1423" y2="900" x1="1423" y1="830"></svg:line><svg:rect width="46" height="30" y="900" x="1400"></svg:rect><svg:text y="915" x="1423">(S z1)</svg:text><svg:line x2="1423" y2="1000" x1="1423" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="1412"></svg:rect><svg:text y="1015" x="1423">z1</svg:text><svg:line x2="1506" y2="800" x1="1108" y1="730"></svg:line><svg:rect width="16" height="30" y="800" x="1498"></svg:rect><svg:text y="815" x="1506">y</svg:text><svg:line x2="1562" y2="300" x1="829" y1="230"></svg:line><svg:rect width="16" height="30" y="300" x="1554"></svg:rect><svg:text y="315" x="1562">n</svg:text><svg:line x2="1624" y2="300" x1="829" y1="230"></svg:line><svg:rect width="28" height="30" y="300" x="1610"></svg:rect><svg:text y="315" x="1624">(Z)</svg:text>
    <svg:path d="M 552, 1315 C 682, 1315 682, 915 401, 915" style="stroke:black;"></svg:path><svg:path d="M 1348, 815 C 1534, 815 1534, 315 1093, 315" style="stroke:black;"></svg:path>
    </svg:svg>