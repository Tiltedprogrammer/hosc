<svg:svg width="1250" height="2930" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="130" height="30" y="0" x="560"></svg:rect><svg:text y="15" x="625">(((u pp) qq) states)</svg:text><svg:line x2="625" y2="100" x1="625" y1="30"></svg:line><svg:rect width="442" height="30" y="100" x="404"></svg:rect><svg:text y="115" x="625">((((\s -&gt; (\w1 -&gt; ((or1 w1) ((and1 s) (x ((u s) w1)))))) pp) qq) states)</svg:text><svg:line x2="625" y2="200" x1="625" y1="130"></svg:line><svg:rect width="376" height="30" y="200" x="437"></svg:rect><svg:text y="215" x="625">(((\w2 -&gt; ((or1 w2) ((and1 pp) (x ((u pp) w2))))) qq) states)</svg:text><svg:line x2="625" y2="300" x1="625" y1="230"></svg:line><svg:rect width="292" height="30" y="300" x="479"></svg:rect><svg:text y="315" x="625">(((or1 qq) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="625" y2="400" x1="625" y1="330"></svg:line><svg:rect width="598" height="30" y="400" x="326"></svg:rect><svg:text y="415" x="625">((((\w -&gt; (\r1 -&gt; (\p1 -&gt; (not ((and (w p1)) (r1 p1)))))) qq) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="625" y2="500" x1="625" y1="430"></svg:line><svg:rect width="496" height="30" y="500" x="377"></svg:rect><svg:text y="515" x="625">(((\t -&gt; (\y -&gt; (not ((and (qq y)) (t y))))) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="625" y2="600" x1="625" y1="530"></svg:line><svg:rect width="442" height="30" y="600" x="404"></svg:rect><svg:text y="615" x="625">((\s2 -&gt; (not ((and (qq s2)) (((and1 pp) (x ((u pp) qq))) s2)))) states)</svg:text><svg:line x2="625" y2="700" x1="625" y1="630"></svg:line><svg:rect width="382" height="30" y="700" x="434"></svg:rect><svg:text y="715" x="625">(not ((and (qq states)) (((and1 pp) (x ((u pp) qq))) states)))</svg:text><svg:line x2="625" y2="800" x1="625" y1="730"></svg:line><svg:rect width="718" height="30" y="800" x="266"></svg:rect><svg:text y="815" x="625">((\s1 -&gt; case (s1) of {True  -&gt; (False); False  -&gt; (True);}) ((and (qq states)) (((and1 pp) (x ((u pp) qq))) states)))</svg:text><svg:line x2="625" y2="900" x1="625" y1="830"></svg:line><svg:rect width="718" height="30" y="900" x="266"></svg:rect><svg:text y="915" x="625">let z2=((and (qq states)) (((and1 pp) (x ((u pp) qq))) states))
 in case (z2) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="175" y2="1000" x1="625" y1="930"></svg:line><svg:rect width="310" height="30" y="1000" x="20"></svg:rect><svg:text y="1015" x="175">case (z2) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="86" y2="1100" x1="175" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="75"></svg:rect><svg:text y="1115" x="86">z2</svg:text><svg:line x2="160" y2="1100" x1="175" y1="1030"></svg:line><svg:rect width="46" height="30" y="1100" x="137"></svg:rect><svg:text y="1115" x="160">(True)</svg:text><svg:line x2="249" y2="1100" x1="175" y1="1030"></svg:line><svg:rect width="52" height="30" y="1100" x="223"></svg:rect><svg:text y="1115" x="249">(False)</svg:text><svg:line x2="800" y2="1000" x1="625" y1="930"></svg:line><svg:rect width="346" height="30" y="1000" x="627"></svg:rect><svg:text y="1015" x="800">((and (qq states)) (((and1 pp) (x ((u pp) qq))) states))</svg:text><svg:line x2="800" y2="1100" x1="800" y1="1030"></svg:line><svg:rect width="712" height="30" y="1100" x="444"></svg:rect><svg:text y="1115" x="800">(((\v1 -&gt; (\y1 -&gt; case (v1) of {True  -&gt; y1; False  -&gt; (False);})) (qq states)) (((and1 pp) (x ((u pp) qq))) states))</svg:text><svg:line x2="800" y2="1200" x1="800" y1="1130"></svg:line><svg:rect width="628" height="30" y="1200" x="486"></svg:rect><svg:text y="1215" x="800">((\x3 -&gt; case ((qq states)) of {True  -&gt; x3; False  -&gt; (False);}) (((and1 pp) (x ((u pp) qq))) states))</svg:text><svg:line x2="800" y2="1300" x1="800" y1="1230"></svg:line><svg:rect width="544" height="30" y="1300" x="528"></svg:rect><svg:text y="1315" x="800">case ((qq states)) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) states); False  -&gt; (False);}</svg:text><svg:line x2="408" y2="1400" x1="800" y1="1330"></svg:line><svg:rect width="76" height="30" y="1400" x="370"></svg:rect><svg:text y="1415" x="408">(qq states)</svg:text><svg:line x2="408" y2="1500" x1="408" y1="1430"></svg:line><svg:rect width="46" height="30" y="1500" x="385"></svg:rect><svg:text y="1515" x="408">states</svg:text><svg:line x2="812" y2="1400" x1="800" y1="1330"></svg:line><svg:rect width="226" height="30" y="1400" x="699"></svg:rect><svg:text y="1415" x="812">(((and1 pp) (x ((u pp) qq))) states)</svg:text><svg:line x2="812" y2="1500" x1="812" y1="1430"></svg:line><svg:rect width="484" height="30" y="1500" x="570"></svg:rect><svg:text y="1515" x="812">((((\y2 -&gt; (\u3 -&gt; (\v -&gt; ((and (y2 v)) (u3 v))))) pp) (x ((u pp) qq))) states)</svg:text><svg:line x2="812" y2="1600" x1="812" y1="1530"></svg:line><svg:rect width="400" height="30" y="1600" x="612"></svg:rect><svg:text y="1615" x="812">(((\x1 -&gt; (\z -&gt; ((and (pp z)) (x1 z)))) (x ((u pp) qq))) states)</svg:text><svg:line x2="812" y2="1700" x1="812" y1="1630"></svg:line><svg:rect width="334" height="30" y="1700" x="645"></svg:rect><svg:text y="1715" x="812">((\p2 -&gt; ((and (pp p2)) ((x ((u pp) qq)) p2))) states)</svg:text><svg:line x2="812" y2="1800" x1="812" y1="1730"></svg:line><svg:rect width="274" height="30" y="1800" x="675"></svg:rect><svg:text y="1815" x="812">((and (pp states)) ((x ((u pp) qq)) states))</svg:text><svg:line x2="812" y2="1900" x1="812" y1="1830"></svg:line><svg:rect width="640" height="30" y="1900" x="492"></svg:rect><svg:text y="1915" x="812">(((\y3 -&gt; (\z1 -&gt; case (y3) of {True  -&gt; z1; False  -&gt; (False);})) (pp states)) ((x ((u pp) qq)) states))</svg:text><svg:line x2="812" y2="2000" x1="812" y1="1930"></svg:line><svg:rect width="544" height="30" y="2000" x="540"></svg:rect><svg:text y="2015" x="812">((\p -&gt; case ((pp states)) of {True  -&gt; p; False  -&gt; (False);}) ((x ((u pp) qq)) states))</svg:text><svg:line x2="812" y2="2100" x1="812" y1="2030"></svg:line><svg:rect width="472" height="30" y="2100" x="576"></svg:rect><svg:text y="2115" x="812">case ((pp states)) of {True  -&gt; ((x ((u pp) qq)) states); False  -&gt; (False);}</svg:text><svg:line x2="524" y2="2200" x1="812" y1="2130"></svg:line><svg:rect width="76" height="30" y="2200" x="486"></svg:rect><svg:text y="2215" x="524">(pp states)</svg:text><svg:line x2="524" y2="2300" x1="524" y1="2230"></svg:line><svg:rect width="46" height="30" y="2300" x="501"></svg:rect><svg:text y="2315" x="524">states</svg:text><svg:line x2="824" y2="2200" x1="812" y1="2130"></svg:line><svg:rect width="154" height="30" y="2200" x="747"></svg:rect><svg:text y="2215" x="824">((x ((u pp) qq)) states)</svg:text><svg:line x2="824" y2="2300" x1="824" y1="2230"></svg:line><svg:rect width="340" height="30" y="2300" x="654"></svg:rect><svg:text y="2315" x="824">(((\z3 -&gt; (\t1 -&gt; (z3 (tail t1)))) ((u pp) qq)) states)</svg:text><svg:line x2="824" y2="2400" x1="824" y1="2330"></svg:line><svg:rect width="256" height="30" y="2400" x="696"></svg:rect><svg:text y="2415" x="824">((\u2 -&gt; (((u pp) qq) (tail u2))) states)</svg:text><svg:line x2="824" y2="2500" x1="824" y1="2430"></svg:line><svg:rect width="256" height="30" y="2500" x="696"></svg:rect><svg:text y="2515" x="824">let r2=(tail states)
 in (((u pp) qq) r2)</svg:text><svg:line x2="655" y2="2600" x1="824" y1="2530"></svg:line><svg:rect width="106" height="30" y="2600" x="602"></svg:rect><svg:text y="2615" x="655">(((u pp) qq) r2)</svg:text><svg:line x2="897" y2="2600" x1="824" y1="2530"></svg:line><svg:rect width="88" height="30" y="2600" x="853"></svg:rect><svg:text y="2615" x="897">(tail states)</svg:text><svg:line x2="897" y2="2700" x1="897" y1="2630"></svg:line><svg:rect width="298" height="30" y="2700" x="748"></svg:rect><svg:text y="2715" x="897">((\x2 -&gt; case (x2) of {Cons u1 r -&gt; r;}) states)</svg:text><svg:line x2="897" y2="2800" x1="897" y1="2730"></svg:line><svg:rect width="226" height="30" y="2800" x="784"></svg:rect><svg:text y="2815" x="897">case (states) of {Cons t2 v2 -&gt; v2;}</svg:text><svg:line x2="866" y2="2900" x1="897" y1="2830"></svg:line><svg:rect width="46" height="30" y="2900" x="843"></svg:rect><svg:text y="2915" x="866">states</svg:text><svg:line x2="940" y2="2900" x1="897" y1="2830"></svg:line><svg:rect width="22" height="30" y="2900" x="929"></svg:rect><svg:text y="2915" x="940">v2</svg:text><svg:line x2="1112" y2="2200" x1="812" y1="2130"></svg:line><svg:rect width="52" height="30" y="2200" x="1086"></svg:rect><svg:text y="2215" x="1112">(False)</svg:text><svg:line x2="1204" y2="1400" x1="800" y1="1330"></svg:line><svg:rect width="52" height="30" y="1400" x="1178"></svg:rect><svg:text y="1415" x="1204">(False)</svg:text>
    <svg:path d="M 708, 2615 C 1250, 2615 1250, 15 690, 15" style="stroke:black;"></svg:path>
    </svg:svg>