<svg:svg width="1378" height="1030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="520" height="30" y="0" x="429"></svg:rect><svg:text y="15" x="689">(((\w1 -&gt; (\p1 -&gt; case (w1) of {Z  -&gt; (g p1); S y1 -&gt; ((f y1) (S (S p1)));})) t) (Z))</svg:text><svg:line x2="689" y2="100" x1="689" y1="30"></svg:line><svg:rect width="436" height="30" y="100" x="471"></svg:rect><svg:text y="115" x="689">((\s1 -&gt; case (t) of {Z  -&gt; (g s1); S v1 -&gt; ((f v1) (S (S s1)));}) (Z))</svg:text><svg:line x2="689" y2="200" x1="689" y1="130"></svg:line><svg:rect width="466" height="30" y="200" x="456"></svg:rect><svg:text y="215" x="689">let t1=(Z), v=t
 in case (v) of {S x1 -&gt; ((f x1) (S (S t1))); Z  -&gt; (g t1);}</svg:text><svg:line x2="627" y2="300" x1="689" y1="230"></svg:line><svg:rect width="346" height="30" y="300" x="454"></svg:rect><svg:text y="315" x="627">case (v) of {S x1 -&gt; ((f x1) (S (S t1))); Z  -&gt; (g t1);}</svg:text><svg:line x2="28" y2="400" x1="627" y1="330"></svg:line><svg:rect width="16" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="28">v</svg:text><svg:line x2="345" y2="400" x1="627" y1="330"></svg:line><svg:rect width="124" height="30" y="400" x="283"></svg:rect><svg:text y="415" x="345">((f x1) (S (S t1)))</svg:text><svg:line x2="345" y2="500" x1="345" y1="430"></svg:line><svg:rect width="538" height="30" y="500" x="76"></svg:rect><svg:text y="515" x="345">(((\y2 -&gt; (\w -&gt; case (y2) of {Z  -&gt; (g w); S z -&gt; ((f z) (S (S w)));})) x1) (S (S t1)))</svg:text><svg:line x2="345" y2="600" x1="345" y1="530"></svg:line><svg:rect width="466" height="30" y="600" x="112"></svg:rect><svg:text y="615" x="345">((\x -&gt; case (x1) of {Z  -&gt; (g x); S z1 -&gt; ((f z1) (S (S x)));}) (S (S t1)))</svg:text><svg:line x2="345" y2="700" x1="345" y1="630"></svg:line><svg:rect width="508" height="30" y="700" x="91"></svg:rect><svg:text y="715" x="345">let p=(S (S t1)), u1=x1
 in case (u1) of {S x1 -&gt; ((f x1) (S (S p))); Z  -&gt; (g p);}</svg:text><svg:line x2="259" y2="800" x1="345" y1="730"></svg:line><svg:rect width="340" height="30" y="800" x="89"></svg:rect><svg:text y="815" x="259">case (u1) of {S x1 -&gt; ((f x1) (S (S p))); Z  -&gt; (g p);}</svg:text><svg:line x2="504" y2="800" x1="345" y1="730"></svg:line><svg:rect width="70" height="30" y="800" x="469"></svg:rect><svg:text y="815" x="504">(S (S t1))</svg:text><svg:line x2="504" y2="900" x1="504" y1="830"></svg:line><svg:rect width="46" height="30" y="900" x="481"></svg:rect><svg:text y="915" x="504">(S t1)</svg:text><svg:line x2="504" y2="1000" x1="504" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="493"></svg:rect><svg:text y="1015" x="504">t1</svg:text><svg:line x2="590" y2="800" x1="345" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="579"></svg:rect><svg:text y="815" x="590">x1</svg:text><svg:line x2="944" y2="400" x1="627" y1="330"></svg:line><svg:rect width="46" height="30" y="400" x="921"></svg:rect><svg:text y="415" x="944">(g t1)</svg:text><svg:line x2="944" y2="500" x1="944" y1="430"></svg:line><svg:rect width="580" height="30" y="500" x="654"></svg:rect><svg:text y="515" x="944">((\s -&gt; case (s) of {Z  -&gt; (True); S x2 -&gt; case (x2) of {Z  -&gt; (False); S r1 -&gt; (g r1);};}) t1)</svg:text><svg:line x2="944" y2="600" x1="944" y1="530"></svg:line><svg:rect width="484" height="30" y="600" x="702"></svg:rect><svg:text y="615" x="944">case (t1) of {Z  -&gt; (True); S r -&gt; case (r) of {Z  -&gt; (False); S u -&gt; (g u);};}</svg:text><svg:line x2="750" y2="700" x1="944" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="739"></svg:rect><svg:text y="715" x="750">t1</svg:text><svg:line x2="824" y2="700" x1="944" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="801"></svg:rect><svg:text y="715" x="824">(True)</svg:text><svg:line x2="1018" y2="700" x1="944" y1="630"></svg:line><svg:rect width="262" height="30" y="700" x="887"></svg:rect><svg:text y="715" x="1018">case (r) of {Z  -&gt; (False); S y -&gt; (g y);}</svg:text><svg:line x2="932" y2="800" x1="1018" y1="730"></svg:line><svg:rect width="16" height="30" y="800" x="924"></svg:rect><svg:text y="815" x="932">r</svg:text><svg:line x2="1006" y2="800" x1="1018" y1="730"></svg:line><svg:rect width="52" height="30" y="800" x="980"></svg:rect><svg:text y="815" x="1006">(False)</svg:text><svg:line x2="1092" y2="800" x1="1018" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="1072"></svg:rect><svg:text y="815" x="1092">(g y)</svg:text><svg:line x2="1288" y2="300" x1="689" y1="230"></svg:line><svg:rect width="28" height="30" y="300" x="1274"></svg:rect><svg:text y="315" x="1288">(Z)</svg:text><svg:line x2="1350" y2="300" x1="689" y1="230"></svg:line><svg:rect width="16" height="30" y="300" x="1342"></svg:rect><svg:text y="315" x="1350">t</svg:text>
    <svg:path d="M 89, 815 C 0, 815 0, 315 454, 315" style="stroke:black;"></svg:path><svg:path d="M 1112, 815 C 1254, 815 1254, 415 967, 415" style="stroke:black;"></svg:path>
    </svg:svg>