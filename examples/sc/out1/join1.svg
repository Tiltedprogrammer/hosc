<svg:svg width="4048" height="3030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="286" height="30" y="0" x="1881"></svg:rect><svg:text y="15" x="2024">(((compose (map f)) ((compose join) join)) xs)</svg:text><svg:line x2="2024" y2="100" x1="2024" y1="30"></svg:line><svg:rect width="478" height="30" y="100" x="1785"></svg:rect><svg:text y="115" x="2024">((((\v9 -&gt; (\p2 -&gt; (\w2 -&gt; (v9 (p2 w2))))) (map f)) ((compose join) join)) xs)</svg:text><svg:line x2="2024" y2="200" x1="2024" y1="130"></svg:line><svg:rect width="406" height="30" y="200" x="1821"></svg:rect><svg:text y="215" x="2024">(((\t10 -&gt; (\p8 -&gt; ((map f) (t10 p8)))) ((compose join) join)) xs)</svg:text><svg:line x2="2024" y2="300" x1="2024" y1="230"></svg:line><svg:rect width="298" height="30" y="300" x="1875"></svg:rect><svg:text y="315" x="2024">((\y -&gt; ((map f) (((compose join) join) y))) xs)</svg:text><svg:line x2="2024" y2="400" x1="2024" y1="330"></svg:line><svg:rect width="226" height="30" y="400" x="1911"></svg:rect><svg:text y="415" x="2024">((map f) (((compose join) join) xs))</svg:text><svg:line x2="2024" y2="500" x1="2024" y1="430"></svg:line><svg:rect width="766" height="30" y="500" x="1641"></svg:rect><svg:text y="515" x="2024">(((\u3 -&gt; (\y6 -&gt; case (y6) of {Nil  -&gt; (Nil); Cons x11 z2 -&gt; (Cons (u3 x11) ((map u3) z2));})) f) (((compose join) join) xs))</svg:text><svg:line x2="2024" y2="600" x1="2024" y1="530"></svg:line><svg:rect width="664" height="30" y="600" x="1692"></svg:rect><svg:text y="615" x="2024">((\x9 -&gt; case (x9) of {Nil  -&gt; (Nil); Cons v1 z1 -&gt; (Cons (f v1) ((map f) z1));}) (((compose join) join) xs))</svg:text><svg:line x2="2024" y2="700" x1="2024" y1="630"></svg:line><svg:rect width="592" height="30" y="700" x="1728"></svg:rect><svg:text y="715" x="2024">case ((((compose join) join) xs)) of {Nil  -&gt; (Nil); Cons s1 p10 -&gt; (Cons (f s1) ((map f) p10));}</svg:text><svg:line x2="2024" y2="800" x1="2024" y1="730"></svg:line><svg:rect width="772" height="30" y="800" x="1638"></svg:rect><svg:text y="815" x="2024">case (((((\r8 -&gt; (\r -&gt; (\t7 -&gt; (r8 (r t7))))) join) join) xs)) of {Nil  -&gt; (Nil); Cons s1 p10 -&gt; (Cons (f s1) ((map f) p10));}</svg:text><svg:line x2="2024" y2="900" x1="2024" y1="830"></svg:line><svg:rect width="700" height="30" y="900" x="1674"></svg:rect><svg:text y="915" x="2024">case ((((\t5 -&gt; (\y11 -&gt; (join (t5 y11)))) join) xs)) of {Nil  -&gt; (Nil); Cons s2 z8 -&gt; (Cons (f s2) ((map f) z8));}</svg:text><svg:line x2="2024" y2="1000" x1="2024" y1="930"></svg:line><svg:rect width="616" height="30" y="1000" x="1716"></svg:rect><svg:text y="1015" x="2024">case (((\t1 -&gt; (join (join t1))) xs)) of {Nil  -&gt; (Nil); Cons z11 u7 -&gt; (Cons (f z11) ((map f) u7));}</svg:text><svg:line x2="2024" y2="1100" x1="2024" y1="1030"></svg:line><svg:rect width="520" height="30" y="1100" x="1764"></svg:rect><svg:text y="1115" x="2024">case ((join (join xs))) of {Nil  -&gt; (Nil); Cons r5 z3 -&gt; (Cons (f r5) ((map f) z3));}</svg:text><svg:line x2="2024" y2="1200" x1="2024" y1="1130"></svg:line><svg:rect width="970" height="30" y="1200" x="1539"></svg:rect><svg:text y="1215" x="2024">case (((\p3 -&gt; case (p3) of {Nil  -&gt; (Nil); Cons s6 s10 -&gt; ((append s6) (join s10));}) (join xs))) of {Nil  -&gt; (Nil); Cons r5 z3 -&gt; (Cons (f r5) ((map f) z3));}</svg:text><svg:line x2="2024" y2="1300" x1="2024" y1="1230"></svg:line><svg:rect width="862" height="30" y="1300" x="1593"></svg:rect><svg:text y="1315" x="2024">case (case ((join xs)) of {Nil  -&gt; (Nil); Cons p p4 -&gt; ((append p) (join p4));}) of {Nil  -&gt; (Nil); Cons s3 p1 -&gt; (Cons (f s3) ((map f) p1));}</svg:text><svg:line x2="2024" y2="1400" x1="2024" y1="1330"></svg:line><svg:rect width="1312" height="30" y="1400" x="1368"></svg:rect><svg:text y="1415" x="2024">case (case (((\z10 -&gt; case (z10) of {Nil  -&gt; (Nil); Cons p7 s5 -&gt; ((append p7) (join s5));}) xs)) of {Nil  -&gt; (Nil); Cons p p4 -&gt; ((append p) (join p4));}) of {Nil  -&gt; (Nil); Cons s3 p1 -&gt; (Cons (f s3) ((map f) p1));}</svg:text><svg:line x2="2024" y2="1500" x1="2024" y1="1430"></svg:line><svg:rect width="1240" height="30" y="1500" x="1404"></svg:rect><svg:text y="1515" x="2024">case (case (case (xs) of {Nil  -&gt; (Nil); Cons v2 u5 -&gt; ((append v2) (join u5));}) of {Nil  -&gt; (Nil); Cons x7 r10 -&gt; ((append x7) (join r10));}) of {Nil  -&gt; (Nil); Cons z w10 -&gt; (Cons (f z) ((map f) w10));}</svg:text><svg:line x2="31" y2="1600" x1="2024" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="20"></svg:rect><svg:text y="1615" x="31">xs</svg:text><svg:line x2="507" y2="1600" x1="2024" y1="1530"></svg:line><svg:rect width="850" height="30" y="1600" x="82"></svg:rect><svg:text y="1615" x="507">case (case ((Nil)) of {Nil  -&gt; (Nil); Cons w4 r1 -&gt; ((append w4) (join r1));}) of {Nil  -&gt; (Nil); Cons r9 y8 -&gt; (Cons (f r9) ((map f) y8));}</svg:text><svg:line x2="507" y2="1700" x1="507" y1="1630"></svg:line><svg:rect width="454" height="30" y="1700" x="280"></svg:rect><svg:text y="1715" x="507">case ((Nil)) of {Nil  -&gt; (Nil); Cons u9 s4 -&gt; (Cons (f u9) ((map f) s4));}</svg:text><svg:line x2="507" y2="1800" x1="507" y1="1730"></svg:line><svg:rect width="40" height="30" y="1800" x="487"></svg:rect><svg:text y="1815" x="507">(Nil)</svg:text><svg:line x2="2500" y2="1600" x1="2024" y1="1530"></svg:line><svg:rect width="946" height="30" y="1600" x="2027"></svg:rect><svg:text y="1615" x="2500">case (case (((append v2) (join u5))) of {Nil  -&gt; (Nil); Cons w7 t -&gt; ((append w7) (join t));}) of {Nil  -&gt; (Nil); Cons u4 z6 -&gt; (Cons (f u4) ((map f) z6));}</svg:text><svg:line x2="2500" y2="1700" x1="2500" y1="1630"></svg:line><svg:rect width="1438" height="30" y="1700" x="1781"></svg:rect><svg:text y="1715" x="2500">case (case ((((\s7 -&gt; (\y4 -&gt; case (s7) of {Nil  -&gt; y4; Cons w1 v10 -&gt; (Cons w1 ((append v10) y4));})) v2) (join u5))) of {Nil  -&gt; (Nil); Cons w7 t -&gt; ((append w7) (join t));}) of {Nil  -&gt; (Nil); Cons u4 z6 -&gt; (Cons (f u4) ((map f) z6));}</svg:text><svg:line x2="2500" y2="1800" x1="2500" y1="1730"></svg:line><svg:rect width="1366" height="30" y="1800" x="1817"></svg:rect><svg:text y="1815" x="2500">case (case (((\v8 -&gt; case (v2) of {Nil  -&gt; v8; Cons t4 t3 -&gt; (Cons t4 ((append t3) v8));}) (join u5))) of {Nil  -&gt; (Nil); Cons t2 y10 -&gt; ((append t2) (join y10));}) of {Nil  -&gt; (Nil); Cons z7 v5 -&gt; (Cons (f z7) ((map f) v5));}</svg:text><svg:line x2="2500" y2="1900" x1="2500" y1="1830"></svg:line><svg:rect width="1300" height="30" y="1900" x="1850"></svg:rect><svg:text y="1915" x="2500">case (case (case (v2) of {Nil  -&gt; (join u5); Cons r3 x1 -&gt; (Cons r3 ((append x1) (join u5)));}) of {Nil  -&gt; (Nil); Cons s8 p6 -&gt; ((append s8) (join p6));}) of {Nil  -&gt; (Nil); Cons w9 u -&gt; (Cons (f w9) ((map f) u));}</svg:text><svg:line x2="983" y2="2000" x1="2500" y1="1930"></svg:line><svg:rect width="22" height="30" y="2000" x="972"></svg:rect><svg:text y="2015" x="983">v2</svg:text><svg:line x2="1477" y2="2000" x1="2500" y1="1930"></svg:line><svg:rect width="886" height="30" y="2000" x="1034"></svg:rect><svg:text y="2015" x="1477">case (case ((join u5)) of {Nil  -&gt; (Nil); Cons r4 x2 -&gt; ((append r4) (join x2));}) of {Nil  -&gt; (Nil); Cons u10 v7 -&gt; (Cons (f u10) ((map f) v7));}</svg:text><svg:line x2="2994" y2="2000" x1="2500" y1="1930"></svg:line><svg:rect width="1018" height="30" y="2000" x="2485"></svg:rect><svg:text y="2015" x="2994">case (case ((Cons r3 ((append x1) (join u5)))) of {Nil  -&gt; (Nil); Cons y5 x3 -&gt; ((append y5) (join x3));}) of {Nil  -&gt; (Nil); Cons y1 z9 -&gt; (Cons (f y1) ((map f) z9));}</svg:text><svg:line x2="2994" y2="2100" x1="2994" y1="2030"></svg:line><svg:rect width="688" height="30" y="2100" x="2650"></svg:rect><svg:text y="2115" x="2994">case (((append r3) (join ((append x1) (join u5))))) of {Nil  -&gt; (Nil); Cons p5 w8 -&gt; (Cons (f p5) ((map f) w8));}</svg:text><svg:line x2="2994" y2="2200" x1="2994" y1="2130"></svg:line><svg:rect width="1168" height="30" y="2200" x="2410"></svg:rect><svg:text y="2215" x="2994">case ((((\w3 -&gt; (\y3 -&gt; case (w3) of {Nil  -&gt; y3; Cons s9 x5 -&gt; (Cons s9 ((append x5) y3));})) r3) (join ((append x1) (join u5))))) of {Nil  -&gt; (Nil); Cons p5 w8 -&gt; (Cons (f p5) ((map f) w8));}</svg:text><svg:line x2="2994" y2="2300" x1="2994" y1="2230"></svg:line><svg:rect width="1084" height="30" y="2300" x="2452"></svg:rect><svg:text y="2315" x="2994">case (((\y7 -&gt; case (r3) of {Nil  -&gt; y7; Cons x6 u8 -&gt; (Cons x6 ((append u8) y7));}) (join ((append x1) (join u5))))) of {Nil  -&gt; (Nil); Cons z4 u1 -&gt; (Cons (f z4) ((map f) u1));}</svg:text><svg:line x2="2994" y2="2400" x1="2994" y1="2330"></svg:line><svg:rect width="1156" height="30" y="2400" x="2416"></svg:rect><svg:text y="2415" x="2994">case (case (r3) of {Nil  -&gt; (join ((append x1) (join u5))); Cons p9 r6 -&gt; (Cons p9 ((append r6) (join ((append x1) (join u5)))));}) of {Nil  -&gt; (Nil); Cons v3 w -&gt; (Cons (f v3) ((map f) w));}</svg:text><svg:line x2="1971" y2="2500" x1="2994" y1="2430"></svg:line><svg:rect width="22" height="30" y="2500" x="1960"></svg:rect><svg:text y="2515" x="1971">r3</svg:text><svg:line x2="2531" y2="2500" x1="2994" y1="2430"></svg:line><svg:rect width="604" height="30" y="2500" x="2229"></svg:rect><svg:text y="2515" x="2531">case ((join ((append x1) (join u5)))) of {Nil  -&gt; (Nil); Cons t9 w5 -&gt; (Cons (f t9) ((map f) w5));}</svg:text><svg:line x2="2531" y2="2600" x1="2531" y1="2530"></svg:line><svg:rect width="1018" height="30" y="2600" x="2022"></svg:rect><svg:text y="2615" x="2531">case (((\x -&gt; case (x) of {Nil  -&gt; (Nil); Cons v v4 -&gt; ((append v) (join v4));}) ((append x1) (join u5)))) of {Nil  -&gt; (Nil); Cons t9 w5 -&gt; (Cons (f t9) ((map f) w5));}</svg:text><svg:line x2="2531" y2="2700" x1="2531" y1="2630"></svg:line><svg:rect width="958" height="30" y="2700" x="2052"></svg:rect><svg:text y="2715" x="2531">case (case (((append x1) (join u5))) of {Nil  -&gt; (Nil); Cons w6 t8 -&gt; ((append w6) (join t8));}) of {Nil  -&gt; (Nil); Cons r2 v6 -&gt; (Cons (f r2) ((map f) v6));}</svg:text><svg:line x2="3554" y2="2500" x1="2994" y1="2430"></svg:line><svg:rect width="760" height="30" y="2500" x="3174"></svg:rect><svg:text y="2515" x="3554">case ((Cons p9 ((append r6) (join ((append x1) (join u5)))))) of {Nil  -&gt; (Nil); Cons x8 x10 -&gt; (Cons (f x8) ((map f) x10));}</svg:text><svg:line x2="3554" y2="2600" x1="3554" y1="2530"></svg:line><svg:rect width="418" height="30" y="2600" x="3345"></svg:rect><svg:text y="2615" x="3554">(Cons (f p9) ((map f) ((append r6) (join ((append x1) (join u5))))))</svg:text><svg:line x2="3103" y2="2700" x1="3554" y1="2630"></svg:line><svg:rect width="46" height="30" y="2700" x="3080"></svg:rect><svg:text y="2715" x="3103">(f p9)</svg:text><svg:line x2="3103" y2="2800" x1="3103" y1="2730"></svg:line><svg:rect width="22" height="30" y="2800" x="3092"></svg:rect><svg:text y="2815" x="3103">p9</svg:text><svg:line x2="3597" y2="2700" x1="3554" y1="2630"></svg:line><svg:rect width="334" height="30" y="2700" x="3430"></svg:rect><svg:text y="2715" x="3597">((map f) ((append r6) (join ((append x1) (join u5)))))</svg:text><svg:line x2="3597" y2="2800" x1="3597" y1="2730"></svg:line><svg:rect width="862" height="30" y="2800" x="3166"></svg:rect><svg:text y="2815" x="3597">(((\u2 -&gt; (\t6 -&gt; case (t6) of {Nil  -&gt; (Nil); Cons y9 y2 -&gt; (Cons (u2 y9) ((map u2) y2));})) f) ((append r6) (join ((append x1) (join u5)))))</svg:text><svg:line x2="3597" y2="2900" x1="3597" y1="2830"></svg:line><svg:rect width="772" height="30" y="2900" x="3211"></svg:rect><svg:text y="2915" x="3597">((\z5 -&gt; case (z5) of {Nil  -&gt; (Nil); Cons r7 x4 -&gt; (Cons (f r7) ((map f) x4));}) ((append r6) (join ((append x1) (join u5)))))</svg:text><svg:line x2="3597" y2="3000" x1="3597" y1="2930"></svg:line><svg:rect width="676" height="30" y="3000" x="3259"></svg:rect><svg:text y="3015" x="3597">case (((append r6) (join ((append x1) (join u5))))) of {Nil  -&gt; (Nil); Cons s u6 -&gt; (Cons (f s) ((map f) u6));}</svg:text>
    <svg:path d="M 3010, 2715 C 4048, 2715 4048, 1615 2973, 1615" style="stroke:black;"></svg:path><svg:path d="M 3935, 3015 C 4048, 3015 4048, 2115 3338, 2115" style="stroke:black;"></svg:path><svg:path d="M 1034, 2015 C 0, 2015 0, 1315 1593, 1315" style="stroke:black;"></svg:path>
    </svg:svg>