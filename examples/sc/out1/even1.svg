<svg:svg width="1378" height="930" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="190" height="30" y="0" x="594"></svg:rect><svg:text y="15" x="689">let r=n, s1=(Z)
 in ((f r) s1)</svg:text><svg:line x2="627" y2="100" x1="689" y1="30"></svg:line><svg:rect width="70" height="30" y="100" x="592"></svg:rect><svg:text y="115" x="627">((f r) s1)</svg:text><svg:line x2="627" y2="200" x1="627" y1="130"></svg:line><svg:rect width="940" height="30" y="200" x="157"></svg:rect><svg:text y="215" x="627">(((\t -&gt; (\w1 -&gt; case (t) of {Z  -&gt; case (w1) of {S z -&gt; case (z) of {S v -&gt; (g v); Z  -&gt; (False);}; Z  -&gt; (True);}; S z2 -&gt; ((f z2) (S (S w1)));})) r) s1)</svg:text><svg:line x2="627" y2="300" x1="627" y1="230"></svg:line><svg:rect width="892" height="30" y="300" x="181"></svg:rect><svg:text y="315" x="627">((\z1 -&gt; case (r) of {Z  -&gt; case (z1) of {S x1 -&gt; case (x1) of {S y2 -&gt; (g y2); Z  -&gt; (False);}; Z  -&gt; (True);}; S v1 -&gt; ((f v1) (S (S z1)));}) s1)</svg:text><svg:line x2="627" y2="400" x1="627" y1="330"></svg:line><svg:rect width="796" height="30" y="400" x="229"></svg:rect><svg:text y="415" x="627">case (r) of {Z  -&gt; case (s1) of {S w -&gt; case (w) of {S t1 -&gt; (g t1); Z  -&gt; (False);}; Z  -&gt; (True);}; S p1 -&gt; ((f p1) (S (S s1)));}</svg:text><svg:line x2="28" y2="500" x1="627" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="28">r</svg:text><svg:line x2="514" y2="500" x1="627" y1="430"></svg:line><svg:rect width="496" height="30" y="500" x="266"></svg:rect><svg:text y="515" x="514">case (s1) of {S r1 -&gt; case (r1) of {S u -&gt; (g u); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="87" y2="600" x1="514" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="76"></svg:rect><svg:text y="615" x="87">s1</svg:text><svg:line x2="502" y2="600" x1="514" y1="530"></svg:line><svg:rect width="268" height="30" y="600" x="368"></svg:rect><svg:text y="615" x="502">case (r1) of {S s -&gt; (g s); Z  -&gt; (False);}</svg:text><svg:line x2="149" y2="700" x1="502" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="138"></svg:rect><svg:text y="715" x="149">r1</svg:text><svg:line x2="487" y2="700" x1="502" y1="630"></svg:line><svg:rect width="40" height="30" y="700" x="467"></svg:rect><svg:text y="715" x="487">(g s)</svg:text><svg:line x2="487" y2="800" x1="487" y1="730"></svg:line><svg:rect width="574" height="30" y="800" x="200"></svg:rect><svg:text y="815" x="487">((\y -&gt; case (y) of {Z  -&gt; (True); S u2 -&gt; case (u2) of {Z  -&gt; (False); S u1 -&gt; (g u1);};}) s)</svg:text><svg:line x2="487" y2="900" x1="487" y1="830"></svg:line><svg:rect width="490" height="30" y="900" x="242"></svg:rect><svg:text y="915" x="487">case (s) of {Z  -&gt; (True); S x -&gt; case (x) of {Z  -&gt; (False); S y1 -&gt; (g y1);};}</svg:text><svg:line x2="840" y2="700" x1="502" y1="630"></svg:line><svg:rect width="52" height="30" y="700" x="814"></svg:rect><svg:text y="715" x="840">(False)</svg:text><svg:line x2="929" y2="600" x1="514" y1="530"></svg:line><svg:rect width="46" height="30" y="600" x="906"></svg:rect><svg:text y="615" x="929">(True)</svg:text><svg:line x2="1113" y2="500" x1="627" y1="430"></svg:line><svg:rect width="238" height="30" y="500" x="994"></svg:rect><svg:text y="515" x="1113">let p=(S (S s1)), x2=p1
 in ((f x2) p)</svg:text><svg:line x2="1027" y2="600" x1="1113" y1="530"></svg:line><svg:rect width="70" height="30" y="600" x="992"></svg:rect><svg:text y="615" x="1027">((f x2) p)</svg:text><svg:line x2="1137" y2="600" x1="1113" y1="530"></svg:line><svg:rect width="70" height="30" y="600" x="1102"></svg:rect><svg:text y="615" x="1137">(S (S s1))</svg:text><svg:line x2="1137" y2="700" x1="1137" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="1114"></svg:rect><svg:text y="715" x="1137">(S s1)</svg:text><svg:line x2="1137" y2="800" x1="1137" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="1126"></svg:rect><svg:text y="815" x="1137">s1</svg:text><svg:line x2="1223" y2="600" x1="1113" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="1212"></svg:rect><svg:text y="615" x="1223">p1</svg:text><svg:line x2="1282" y2="100" x1="689" y1="30"></svg:line><svg:rect width="16" height="30" y="100" x="1274"></svg:rect><svg:text y="115" x="1282">n</svg:text><svg:line x2="1344" y2="100" x1="689" y1="30"></svg:line><svg:rect width="28" height="30" y="100" x="1330"></svg:rect><svg:text y="115" x="1344">(Z)</svg:text>
    <svg:path d="M 242, 915 C 56, 915 56, 515 266, 515" style="stroke:black;"></svg:path><svg:path d="M 1062, 615 C 1254, 615 1254, 115 662, 115" style="stroke:black;"></svg:path>
    </svg:svg>