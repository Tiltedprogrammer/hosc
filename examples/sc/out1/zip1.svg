<svg:svg width="2418" height="1730" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="238" height="30" y="0" x="1090"></svg:rect><svg:text y="15" x="1209">((map (fp (P f1 f2))) (zip (P l1 l2)))</svg:text><svg:line x2="1209" y2="100" x1="1209" y1="30"></svg:line><svg:rect width="766" height="30" y="100" x="826"></svg:rect><svg:text y="115" x="1209">(((\y2 -&gt; (\y1 -&gt; case (y1) of {Nil  -&gt; (Nil); Cons v5 w2 -&gt; (Cons (y2 v5) ((map y2) w2));})) (fp (P f1 f2))) (zip (P l1 l2)))</svg:text><svg:line x2="1209" y2="200" x1="1209" y1="130"></svg:line><svg:rect width="730" height="30" y="200" x="844"></svg:rect><svg:text y="215" x="1209">((\y -&gt; case (y) of {Nil  -&gt; (Nil); Cons s x3 -&gt; (Cons ((fp (P f1 f2)) s) ((map (fp (P f1 f2))) x3));}) (zip (P l1 l2)))</svg:text><svg:line x2="1209" y2="300" x1="1209" y1="230"></svg:line><svg:rect width="670" height="30" y="300" x="874"></svg:rect><svg:text y="315" x="1209">case ((zip (P l1 l2))) of {Nil  -&gt; (Nil); Cons s3 x5 -&gt; (Cons ((fp (P f1 f2)) s3) ((map (fp (P f1 f2))) x5));}</svg:text><svg:line x2="1209" y2="400" x1="1209" y1="330"></svg:line><svg:rect width="1588" height="30" y="400" x="415"></svg:rect><svg:text y="415" x="1209">case (((\r4 -&gt; case (r4) of {P v3 u1 -&gt; case (v3) of {Nil  -&gt; (Nil); Cons t4 t3 -&gt; case (u1) of {Nil  -&gt; (Nil); Cons w u2 -&gt; (Cons (P t4 w) (zip (P t3 u2)));};};}) (P l1 l2))) of {Nil  -&gt; (Nil); Cons s3 x5 -&gt; (Cons ((fp (P f1 f2)) s3) ((map (fp (P f1 f2))) x5));}</svg:text><svg:line x2="1209" y2="500" x1="1209" y1="430"></svg:line><svg:rect width="1504" height="30" y="500" x="457"></svg:rect><svg:text y="515" x="1209">case (case ((P l1 l2)) of {P r2 x1 -&gt; case (r2) of {Nil  -&gt; (Nil); Cons w5 p3 -&gt; case (x1) of {Nil  -&gt; (Nil); Cons w4 x -&gt; (Cons (P w5 w4) (zip (P p3 x)));};};}) of {Nil  -&gt; (Nil); Cons s1 u4 -&gt; (Cons ((fp (P f1 f2)) s1) ((map (fp (P f1 f2))) u4));}</svg:text><svg:line x2="1209" y2="600" x1="1209" y1="530"></svg:line><svg:rect width="1288" height="30" y="600" x="565"></svg:rect><svg:text y="615" x="1209">case (case (l1) of {Nil  -&gt; (Nil); Cons u5 u -&gt; case (l2) of {Nil  -&gt; (Nil); Cons z2 t1 -&gt; (Cons (P u5 z2) (zip (P u t1)));};}) of {Nil  -&gt; (Nil); Cons v r1 -&gt; (Cons ((fp (P f1 f2)) v) ((map (fp (P f1 f2))) r1));}</svg:text><svg:line x2="31" y2="700" x1="1209" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">l1</svg:text><svg:line x2="387" y2="700" x1="1209" y1="630"></svg:line><svg:rect width="610" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="387">case ((Nil)) of {Nil  -&gt; (Nil); Cons w3 v4 -&gt; (Cons ((fp (P f1 f2)) w3) ((map (fp (P f1 f2))) v4));}</svg:text><svg:line x2="387" y2="800" x1="387" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="367"></svg:rect><svg:text y="815" x="387">(Nil)</svg:text><svg:line x2="1565" y2="700" x1="1209" y1="630"></svg:line><svg:rect width="1024" height="30" y="700" x="1053"></svg:rect><svg:text y="715" x="1565">case (case (l2) of {Nil  -&gt; (Nil); Cons p v2 -&gt; (Cons (P u5 p) (zip (P u v2)));}) of {Nil  -&gt; (Nil); Cons z4 z5 -&gt; (Cons ((fp (P f1 f2)) z4) ((map (fp (P f1 f2))) z5));}</svg:text><svg:line x2="743" y2="800" x1="1565" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="732"></svg:rect><svg:text y="815" x="743">l2</svg:text><svg:line x2="1099" y2="800" x1="1565" y1="730"></svg:line><svg:rect width="610" height="30" y="800" x="794"></svg:rect><svg:text y="815" x="1099">case ((Nil)) of {Nil  -&gt; (Nil); Cons v1 z3 -&gt; (Cons ((fp (P f1 f2)) v1) ((map (fp (P f1 f2))) z3));}</svg:text><svg:line x2="1099" y2="900" x1="1099" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="1079"></svg:rect><svg:text y="915" x="1099">(Nil)</svg:text><svg:line x2="1921" y2="800" x1="1565" y1="730"></svg:line><svg:rect width="760" height="30" y="800" x="1541"></svg:rect><svg:text y="815" x="1921">case ((Cons (P u5 p) (zip (P u v2)))) of {Nil  -&gt; (Nil); Cons p1 p2 -&gt; (Cons ((fp (P f1 f2)) p1) ((map (fp (P f1 f2))) p2));}</svg:text><svg:line x2="1921" y2="900" x1="1921" y1="830"></svg:line><svg:rect width="430" height="30" y="900" x="1706"></svg:rect><svg:text y="915" x="1921">(Cons ((fp (P f1 f2)) (P u5 p)) ((map (fp (P f1 f2))) (zip (P u v2))))</svg:text><svg:line x2="1785" y2="1000" x1="1921" y1="930"></svg:line><svg:rect width="160" height="30" y="1000" x="1705"></svg:rect><svg:text y="1015" x="1785">((fp (P f1 f2)) (P u5 p))</svg:text><svg:line x2="1785" y2="1100" x1="1785" y1="1030"></svg:line><svg:rect width="682" height="30" y="1100" x="1444"></svg:rect><svg:text y="1115" x="1785">(((\x2 -&gt; (\t2 -&gt; case (x2) of {P y4 r -&gt; case (t2) of {P w1 p4 -&gt; (P (y4 w1) (r p4));};})) (P f1 f2)) (P u5 p))</svg:text><svg:line x2="1785" y2="1200" x1="1785" y1="1130"></svg:line><svg:rect width="598" height="30" y="1200" x="1486"></svg:rect><svg:text y="1215" x="1785">((\p5 -&gt; case ((P f1 f2)) of {P z u3 -&gt; case (p5) of {P s4 y3 -&gt; (P (z s4) (u3 y3));};}) (P u5 p))</svg:text><svg:line x2="1785" y2="1300" x1="1785" y1="1230"></svg:line><svg:rect width="514" height="30" y="1300" x="1528"></svg:rect><svg:text y="1315" x="1785">case ((P f1 f2)) of {P z1 r3 -&gt; case ((P u5 p)) of {P y5 t -&gt; (P (z1 y5) (r3 t));};}</svg:text><svg:line x2="1785" y2="1400" x1="1785" y1="1330"></svg:line><svg:rect width="322" height="30" y="1400" x="1624"></svg:rect><svg:text y="1415" x="1785">case ((P u5 p)) of {P s2 x4 -&gt; (P (f1 s2) (f2 x4));}</svg:text><svg:line x2="1785" y2="1500" x1="1785" y1="1430"></svg:line><svg:rect width="118" height="30" y="1500" x="1726"></svg:rect><svg:text y="1515" x="1785">(P (f1 u5) (f2 p))</svg:text><svg:line x2="1742" y2="1600" x1="1785" y1="1530"></svg:line><svg:rect width="52" height="30" y="1600" x="1716"></svg:rect><svg:text y="1615" x="1742">(f1 u5)</svg:text><svg:line x2="1742" y2="1700" x1="1742" y1="1630"></svg:line><svg:rect width="22" height="30" y="1700" x="1731"></svg:rect><svg:text y="1715" x="1742">u5</svg:text><svg:line x2="1831" y2="1600" x1="1785" y1="1530"></svg:line><svg:rect width="46" height="30" y="1600" x="1808"></svg:rect><svg:text y="1615" x="1831">(f2 p)</svg:text><svg:line x2="1831" y2="1700" x1="1831" y1="1630"></svg:line><svg:rect width="16" height="30" y="1700" x="1823"></svg:rect><svg:text y="1715" x="1831">p</svg:text><svg:line x2="2282" y2="1000" x1="1921" y1="930"></svg:line><svg:rect width="232" height="30" y="1000" x="2166"></svg:rect><svg:text y="1015" x="2282">((map (fp (P f1 f2))) (zip (P u v2)))</svg:text>
    <svg:path d="M 2398, 1015 C 2418, 1015 2418, 15 1328, 15" style="stroke:black;"></svg:path>
    </svg:svg>