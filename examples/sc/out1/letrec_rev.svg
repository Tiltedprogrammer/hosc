<svg:svg width="1132" height="1230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="46" height="30" y="0" x="543"></svg:rect><svg:text y="15" x="566">(f zs)</svg:text><svg:line x2="566" y2="100" x1="566" y1="30"></svg:line><svg:rect width="430" height="30" y="100" x="351"></svg:rect><svg:text y="115" x="566">((\r -&gt; case (r) of {Nil  -&gt; (Nil); Cons t1 u -&gt; ((g t1) (f u));}) zs)</svg:text><svg:line x2="566" y2="200" x1="566" y1="130"></svg:line><svg:rect width="370" height="30" y="200" x="381"></svg:rect><svg:text y="215" x="566">case (zs) of {Nil  -&gt; (Nil); Cons y1 v1 -&gt; ((g y1) (f v1));}</svg:text><svg:line x2="31" y2="300" x1="566" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">zs</svg:text><svg:line x2="102" y2="300" x1="566" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="637" y2="300" x1="566" y1="230"></svg:line><svg:rect width="100" height="30" y="300" x="587"></svg:rect><svg:text y="315" x="637">((g y1) (f v1))</svg:text><svg:line x2="637" y2="400" x1="637" y1="330"></svg:line><svg:rect width="634" height="30" y="400" x="320"></svg:rect><svg:text y="415" x="637">(((\z2 -&gt; (\v -&gt; case (v) of {Cons x1 z -&gt; (Cons x1 ((g z2) z)); Nil  -&gt; (Cons z2 (Nil));})) y1) (f v1))</svg:text><svg:line x2="637" y2="500" x1="637" y1="430"></svg:line><svg:rect width="562" height="30" y="500" x="356"></svg:rect><svg:text y="515" x="637">((\s1 -&gt; case (s1) of {Cons z1 t -&gt; (Cons z1 ((g y1) t)); Nil  -&gt; (Cons y1 (Nil));}) (f v1))</svg:text><svg:line x2="637" y2="600" x1="637" y1="530"></svg:line><svg:rect width="562" height="30" y="600" x="356"></svg:rect><svg:text y="615" x="637">let p1=(f v1)
 in case (p1) of {Cons w x2 -&gt; (Cons w ((g y1) x2)); Nil  -&gt; (Cons y1 (Nil));}</svg:text><svg:line x2="594" y2="700" x1="637" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="367"></svg:rect><svg:text y="715" x="594">case (p1) of {Cons w x2 -&gt; (Cons w ((g y1) x2)); Nil  -&gt; (Cons y1 (Nil));}</svg:text><svg:line x2="173" y2="800" x1="594" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="162"></svg:rect><svg:text y="815" x="173">p1</svg:text><svg:line x2="554" y2="800" x1="594" y1="730"></svg:line><svg:rect width="130" height="30" y="800" x="489"></svg:rect><svg:text y="815" x="554">(Cons w ((g y1) x2))</svg:text><svg:line x2="232" y2="900" x1="554" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="224"></svg:rect><svg:text y="915" x="232">w</svg:text><svg:line x2="582" y2="900" x1="554" y1="830"></svg:line><svg:rect width="76" height="30" y="900" x="544"></svg:rect><svg:text y="915" x="582">((g y1) x2)</svg:text><svg:line x2="582" y2="1000" x1="582" y1="930"></svg:line><svg:rect width="604" height="30" y="1000" x="280"></svg:rect><svg:text y="1015" x="582">(((\y -&gt; (\s -&gt; case (s) of {Cons u1 u2 -&gt; (Cons u1 ((g y) u2)); Nil  -&gt; (Cons y (Nil));})) y1) x2)</svg:text><svg:line x2="582" y2="1100" x1="582" y1="1030"></svg:line><svg:rect width="526" height="30" y="1100" x="319"></svg:rect><svg:text y="1115" x="582">((\x -&gt; case (x) of {Cons p w1 -&gt; (Cons p ((g y1) w1)); Nil  -&gt; (Cons y1 (Nil));}) x2)</svg:text><svg:line x2="582" y2="1200" x1="582" y1="1130"></svg:line><svg:rect width="466" height="30" y="1200" x="349"></svg:rect><svg:text y="1215" x="582">case (x2) of {Cons r1 y2 -&gt; (Cons r1 ((g y1) y2)); Nil  -&gt; (Cons y1 (Nil));}</svg:text><svg:line x2="975" y2="800" x1="594" y1="730"></svg:line><svg:rect width="100" height="30" y="800" x="925"></svg:rect><svg:text y="815" x="975">(Cons y1 (Nil))</svg:text><svg:line x2="935" y2="900" x1="975" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="924"></svg:rect><svg:text y="915" x="935">y1</svg:text><svg:line x2="1006" y2="900" x1="975" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="986"></svg:rect><svg:text y="915" x="1006">(Nil)</svg:text><svg:line x2="1089" y2="700" x1="637" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="1066"></svg:rect><svg:text y="715" x="1089">(f v1)</svg:text>
    <svg:path d="M 349, 1215 C 142, 1215 142, 715 367, 715" style="stroke:black;"></svg:path><svg:path d="M 1112, 715 C 1132, 715 1132, 15 589, 15" style="stroke:black;"></svg:path>
    </svg:svg>