<svg:svg width="1990" height="4230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="130" height="30" y="0" x="930"></svg:rect><svg:text y="15" x="995">(((u pp) qq) states)</svg:text><svg:line x2="995" y2="100" x1="995" y1="30"></svg:line><svg:rect width="442" height="30" y="100" x="774"></svg:rect><svg:text y="115" x="995">((((\w -&gt; (\y2 -&gt; ((or1 y2) ((and1 w) (x ((u w) y2)))))) pp) qq) states)</svg:text><svg:line x2="995" y2="200" x1="995" y1="130"></svg:line><svg:rect width="376" height="30" y="200" x="807"></svg:rect><svg:text y="215" x="995">(((\z3 -&gt; ((or1 z3) ((and1 pp) (x ((u pp) z3))))) qq) states)</svg:text><svg:line x2="995" y2="300" x1="995" y1="230"></svg:line><svg:rect width="292" height="30" y="300" x="849"></svg:rect><svg:text y="315" x="995">(((or1 qq) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="995" y2="400" x1="995" y1="330"></svg:line><svg:rect width="592" height="30" y="400" x="699"></svg:rect><svg:text y="415" x="995">((((\p2 -&gt; (\z2 -&gt; (\v -&gt; (not ((and (p2 v)) (z2 v)))))) qq) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="995" y2="500" x1="995" y1="430"></svg:line><svg:rect width="526" height="30" y="500" x="732"></svg:rect><svg:text y="515" x="995">(((\z4 -&gt; (\s2 -&gt; (not ((and (qq s2)) (z4 s2))))) ((and1 pp) (x ((u pp) qq)))) states)</svg:text><svg:line x2="995" y2="600" x1="995" y1="530"></svg:line><svg:rect width="442" height="30" y="600" x="774"></svg:rect><svg:text y="615" x="995">((\y1 -&gt; (not ((and (qq y1)) (((and1 pp) (x ((u pp) qq))) y1)))) states)</svg:text><svg:line x2="995" y2="700" x1="995" y1="630"></svg:line><svg:rect width="382" height="30" y="700" x="804"></svg:rect><svg:text y="715" x="995">(not ((and (qq states)) (((and1 pp) (x ((u pp) qq))) states)))</svg:text><svg:line x2="995" y2="800" x1="995" y1="730"></svg:line><svg:rect width="718" height="30" y="800" x="636"></svg:rect><svg:text y="815" x="995">((\t3 -&gt; case (t3) of {True  -&gt; (False); False  -&gt; (True);}) ((and (qq states)) (((and1 pp) (x ((u pp) qq))) states)))</svg:text><svg:line x2="995" y2="900" x1="995" y1="830"></svg:line><svg:rect width="634" height="30" y="900" x="678"></svg:rect><svg:text y="915" x="995">case (((and (qq states)) (((and1 pp) (x ((u pp) qq))) states))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="995" y2="1000" x1="995" y1="930"></svg:line><svg:rect width="1000" height="30" y="1000" x="495"></svg:rect><svg:text y="1015" x="995">case ((((\y3 -&gt; (\x3 -&gt; case (y3) of {True  -&gt; x3; False  -&gt; (False);})) (qq states)) (((and1 pp) (x ((u pp) qq))) states))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="995" y2="1100" x1="995" y1="1030"></svg:line><svg:rect width="916" height="30" y="1100" x="537"></svg:rect><svg:text y="1115" x="995">case (((\v4 -&gt; case ((qq states)) of {True  -&gt; v4; False  -&gt; (False);}) (((and1 pp) (x ((u pp) qq))) states))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="995" y2="1200" x1="995" y1="1130"></svg:line><svg:rect width="916" height="30" y="1200" x="537"></svg:rect><svg:text y="1215" x="995">let u2=case ((qq states)) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) states); False  -&gt; (False);}
 in case (u2) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="175" y2="1300" x1="995" y1="1230"></svg:line><svg:rect width="310" height="30" y="1300" x="20"></svg:rect><svg:text y="1315" x="175">case (u2) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="86" y2="1400" x1="175" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="75"></svg:rect><svg:text y="1415" x="86">u2</svg:text><svg:line x2="160" y2="1400" x1="175" y1="1330"></svg:line><svg:rect width="46" height="30" y="1400" x="137"></svg:rect><svg:text y="1415" x="160">(True)</svg:text><svg:line x2="249" y2="1400" x1="175" y1="1330"></svg:line><svg:rect width="52" height="30" y="1400" x="223"></svg:rect><svg:text y="1415" x="249">(False)</svg:text><svg:line x2="1170" y2="1300" x1="995" y1="1230"></svg:line><svg:rect width="544" height="30" y="1300" x="898"></svg:rect><svg:text y="1315" x="1170">case ((qq states)) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) states); False  -&gt; (False);}</svg:text><svg:line x2="408" y2="1400" x1="1170" y1="1330"></svg:line><svg:rect width="76" height="30" y="1400" x="370"></svg:rect><svg:text y="1415" x="408">(qq states)</svg:text><svg:line x2="408" y2="1500" x1="408" y1="1430"></svg:line><svg:rect width="46" height="30" y="1500" x="385"></svg:rect><svg:text y="1515" x="408">states</svg:text><svg:line x2="1182" y2="1400" x1="1170" y1="1330"></svg:line><svg:rect width="226" height="30" y="1400" x="1069"></svg:rect><svg:text y="1415" x="1182">(((and1 pp) (x ((u pp) qq))) states)</svg:text><svg:line x2="1182" y2="1500" x1="1182" y1="1430"></svg:line><svg:rect width="490" height="30" y="1500" x="937"></svg:rect><svg:text y="1515" x="1182">((((\p4 -&gt; (\t -&gt; (\v2 -&gt; ((and (p4 v2)) (t v2))))) pp) (x ((u pp) qq))) states)</svg:text><svg:line x2="1182" y2="1600" x1="1182" y1="1530"></svg:line><svg:rect width="418" height="30" y="1600" x="973"></svg:rect><svg:text y="1615" x="1182">(((\t2 -&gt; (\u4 -&gt; ((and (pp u4)) (t2 u4)))) (x ((u pp) qq))) states)</svg:text><svg:line x2="1182" y2="1700" x1="1182" y1="1630"></svg:line><svg:rect width="334" height="30" y="1700" x="1015"></svg:rect><svg:text y="1715" x="1182">((\s3 -&gt; ((and (pp s3)) ((x ((u pp) qq)) s3))) states)</svg:text><svg:line x2="1182" y2="1800" x1="1182" y1="1730"></svg:line><svg:rect width="274" height="30" y="1800" x="1045"></svg:rect><svg:text y="1815" x="1182">((and (pp states)) ((x ((u pp) qq)) states))</svg:text><svg:line x2="1182" y2="1900" x1="1182" y1="1830"></svg:line><svg:rect width="640" height="30" y="1900" x="862"></svg:rect><svg:text y="1915" x="1182">(((\w2 -&gt; (\p1 -&gt; case (w2) of {True  -&gt; p1; False  -&gt; (False);})) (pp states)) ((x ((u pp) qq)) states))</svg:text><svg:line x2="1182" y2="2000" x1="1182" y1="1930"></svg:line><svg:rect width="556" height="30" y="2000" x="904"></svg:rect><svg:text y="2015" x="1182">((\v1 -&gt; case ((pp states)) of {True  -&gt; v1; False  -&gt; (False);}) ((x ((u pp) qq)) states))</svg:text><svg:line x2="1182" y2="2100" x1="1182" y1="2030"></svg:line><svg:rect width="472" height="30" y="2100" x="946"></svg:rect><svg:text y="2115" x="1182">case ((pp states)) of {True  -&gt; ((x ((u pp) qq)) states); False  -&gt; (False);}</svg:text><svg:line x2="524" y2="2200" x1="1182" y1="2130"></svg:line><svg:rect width="76" height="30" y="2200" x="486"></svg:rect><svg:text y="2215" x="524">(pp states)</svg:text><svg:line x2="524" y2="2300" x1="524" y1="2230"></svg:line><svg:rect width="46" height="30" y="2300" x="501"></svg:rect><svg:text y="2315" x="524">states</svg:text><svg:line x2="1194" y2="2200" x1="1182" y1="2130"></svg:line><svg:rect width="154" height="30" y="2200" x="1117"></svg:rect><svg:text y="2215" x="1194">((x ((u pp) qq)) states)</svg:text><svg:line x2="1194" y2="2300" x1="1194" y1="2230"></svg:line><svg:rect width="340" height="30" y="2300" x="1024"></svg:rect><svg:text y="2315" x="1194">(((\z1 -&gt; (\s1 -&gt; (z1 (tail s1)))) ((u pp) qq)) states)</svg:text><svg:line x2="1194" y2="2400" x1="1194" y1="2330"></svg:line><svg:rect width="256" height="30" y="2400" x="1066"></svg:rect><svg:text y="2415" x="1194">((\v3 -&gt; (((u pp) qq) (tail v3))) states)</svg:text><svg:line x2="1194" y2="2500" x1="1194" y1="2430"></svg:line><svg:rect width="172" height="30" y="2500" x="1108"></svg:rect><svg:text y="2515" x="1194">(((u pp) qq) (tail states))</svg:text><svg:line x2="1194" y2="2600" x1="1194" y1="2530"></svg:line><svg:rect width="484" height="30" y="2600" x="952"></svg:rect><svg:text y="2615" x="1194">((((\s -&gt; (\t1 -&gt; ((or1 t1) ((and1 s) (x ((u s) t1)))))) pp) qq) (tail states))</svg:text><svg:line x2="1194" y2="2700" x1="1194" y1="2630"></svg:line><svg:rect width="418" height="30" y="2700" x="985"></svg:rect><svg:text y="2715" x="1194">(((\u3 -&gt; ((or1 u3) ((and1 pp) (x ((u pp) u3))))) qq) (tail states))</svg:text><svg:line x2="1194" y2="2800" x1="1194" y1="2730"></svg:line><svg:rect width="334" height="30" y="2800" x="1027"></svg:rect><svg:text y="2815" x="1194">(((or1 qq) ((and1 pp) (x ((u pp) qq)))) (tail states))</svg:text><svg:line x2="1194" y2="2900" x1="1194" y1="2830"></svg:line><svg:rect width="652" height="30" y="2900" x="868"></svg:rect><svg:text y="2915" x="1194">((((\y4 -&gt; (\p3 -&gt; (\r2 -&gt; (not ((and (y4 r2)) (p3 r2)))))) qq) ((and1 pp) (x ((u pp) qq)))) (tail states))</svg:text><svg:line x2="1194" y2="3000" x1="1194" y1="2930"></svg:line><svg:rect width="568" height="30" y="3000" x="910"></svg:rect><svg:text y="3015" x="1194">(((\u1 -&gt; (\r4 -&gt; (not ((and (qq r4)) (u1 r4))))) ((and1 pp) (x ((u pp) qq)))) (tail states))</svg:text><svg:line x2="1194" y2="3100" x1="1194" y1="3030"></svg:line><svg:rect width="484" height="30" y="3100" x="952"></svg:rect><svg:text y="3115" x="1194">((\x1 -&gt; (not ((and (qq x1)) (((and1 pp) (x ((u pp) qq))) x1)))) (tail states))</svg:text><svg:line x2="1194" y2="3200" x1="1194" y1="3130"></svg:line><svg:rect width="466" height="30" y="3200" x="961"></svg:rect><svg:text y="3215" x="1194">(not ((and (qq (tail states))) (((and1 pp) (x ((u pp) qq))) (tail states))))</svg:text><svg:line x2="1194" y2="3300" x1="1194" y1="3230"></svg:line><svg:rect width="802" height="30" y="3300" x="793"></svg:rect><svg:text y="3315" x="1194">((\w1 -&gt; case (w1) of {True  -&gt; (False); False  -&gt; (True);}) ((and (qq (tail states))) (((and1 pp) (x ((u pp) qq))) (tail states))))</svg:text><svg:line x2="1194" y2="3400" x1="1194" y1="3330"></svg:line><svg:rect width="718" height="30" y="3400" x="835"></svg:rect><svg:text y="3415" x="1194">case (((and (qq (tail states))) (((and1 pp) (x ((u pp) qq))) (tail states)))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="1194" y2="3500" x1="1194" y1="3430"></svg:line><svg:rect width="1072" height="30" y="3500" x="658"></svg:rect><svg:text y="3515" x="1194">case ((((\r3 -&gt; (\p -&gt; case (r3) of {True  -&gt; p; False  -&gt; (False);})) (qq (tail states))) (((and1 pp) (x ((u pp) qq))) (tail states)))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="1194" y2="3600" x1="1194" y1="3530"></svg:line><svg:rect width="1000" height="30" y="3600" x="694"></svg:rect><svg:text y="3615" x="1194">case (((\r1 -&gt; case ((qq (tail states))) of {True  -&gt; r1; False  -&gt; (False);}) (((and1 pp) (x ((u pp) qq))) (tail states)))) of {True  -&gt; (False); False  -&gt; (True);}</svg:text><svg:line x2="1194" y2="3700" x1="1194" y1="3630"></svg:line><svg:rect width="988" height="30" y="3700" x="700"></svg:rect><svg:text y="3715" x="1194">let z=case ((qq (tail states))) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) (tail states)); False  -&gt; (False);}
 in case (z) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="754" y2="3800" x1="1194" y1="3730"></svg:line><svg:rect width="304" height="30" y="3800" x="602"></svg:rect><svg:text y="3815" x="754">case (z) of {False  -&gt; (True); True  -&gt; (False);}</svg:text><svg:line x2="665" y2="3900" x1="754" y1="3830"></svg:line><svg:rect width="16" height="30" y="3900" x="657"></svg:rect><svg:text y="3915" x="665">z</svg:text><svg:line x2="736" y2="3900" x1="754" y1="3830"></svg:line><svg:rect width="46" height="30" y="3900" x="713"></svg:rect><svg:text y="3915" x="736">(True)</svg:text><svg:line x2="825" y2="3900" x1="754" y1="3830"></svg:line><svg:rect width="52" height="30" y="3900" x="799"></svg:rect><svg:text y="3915" x="825">(False)</svg:text><svg:line x2="1366" y2="3800" x1="1194" y1="3730"></svg:line><svg:rect width="646" height="30" y="3800" x="1043"></svg:rect><svg:text y="3815" x="1366">let w3=(tail states)
 in case ((qq w3)) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) w3); False  -&gt; (False);}</svg:text><svg:line x2="1194" y2="3900" x1="1366" y1="3830"></svg:line><svg:rect width="496" height="30" y="3900" x="946"></svg:rect><svg:text y="3915" x="1194">case ((qq w3)) of {True  -&gt; (((and1 pp) (x ((u pp) qq))) w3); False  -&gt; (False);}</svg:text><svg:line x2="1634" y2="3900" x1="1366" y1="3830"></svg:line><svg:rect width="88" height="30" y="3900" x="1590"></svg:rect><svg:text y="3915" x="1634">(tail states)</svg:text><svg:line x2="1634" y2="4000" x1="1634" y1="3930"></svg:line><svg:rect width="304" height="30" y="4000" x="1482"></svg:rect><svg:text y="4015" x="1634">((\w4 -&gt; case (w4) of {Cons r x2 -&gt; x2;}) states)</svg:text><svg:line x2="1634" y2="4100" x1="1634" y1="4030"></svg:line><svg:rect width="214" height="30" y="4100" x="1527"></svg:rect><svg:text y="4115" x="1634">case (states) of {Cons x4 y -&gt; y;}</svg:text><svg:line x2="1606" y2="4200" x1="1634" y1="4130"></svg:line><svg:rect width="46" height="30" y="4200" x="1583"></svg:rect><svg:text y="4215" x="1606">states</svg:text><svg:line x2="1677" y2="4200" x1="1634" y1="4130"></svg:line><svg:rect width="16" height="30" y="4200" x="1669"></svg:rect><svg:text y="4215" x="1677">y</svg:text><svg:line x2="1852" y2="2200" x1="1182" y1="2130"></svg:line><svg:rect width="52" height="30" y="2200" x="1826"></svg:rect><svg:text y="2215" x="1852">(False)</svg:text><svg:line x2="1944" y2="1400" x1="1170" y1="1330"></svg:line><svg:rect width="52" height="30" y="1400" x="1918"></svg:rect><svg:text y="1415" x="1944">(False)</svg:text>
    <svg:path d="M 1442, 3915 C 1990, 3915 1990, 1315 1442, 1315" style="stroke:black;"></svg:path>
    </svg:svg>