<svg:svg width="1594" height="1430" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="58" height="30" y="0" x="768"></svg:rect><svg:text y="15" x="797">(rev xs)</svg:text><svg:line x2="797" y2="100" x1="797" y1="30"></svg:line><svg:rect width="544" height="30" y="100" x="525"></svg:rect><svg:text y="115" x="797">((\v1 -&gt; case (v1) of {Nil  -&gt; (Nil); Cons x2 s -&gt; ((app (rev s)) (Cons x2 (Nil)));}) xs)</svg:text><svg:line x2="797" y2="200" x1="797" y1="130"></svg:line><svg:rect width="472" height="30" y="200" x="561"></svg:rect><svg:text y="215" x="797">case (xs) of {Nil  -&gt; (Nil); Cons y1 w1 -&gt; ((app (rev w1)) (Cons y1 (Nil)));}</svg:text><svg:line x2="31" y2="300" x1="797" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">xs</svg:text><svg:line x2="102" y2="300" x1="797" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="868" y2="300" x1="797" y1="230"></svg:line><svg:rect width="202" height="30" y="300" x="767"></svg:rect><svg:text y="315" x="868">((app (rev w1)) (Cons y1 (Nil)))</svg:text><svg:line x2="868" y2="400" x1="868" y1="330"></svg:line><svg:rect width="652" height="30" y="400" x="542"></svg:rect><svg:text y="415" x="868">(((\p -&gt; (\x -&gt; case (p) of {Nil  -&gt; x; Cons p2 s1 -&gt; (Cons p2 ((app s1) x));})) (rev w1)) (Cons y1 (Nil)))</svg:text><svg:line x2="868" y2="500" x1="868" y1="430"></svg:line><svg:rect width="568" height="30" y="500" x="584"></svg:rect><svg:text y="515" x="868">((\r -&gt; case ((rev w1)) of {Nil  -&gt; r; Cons w p1 -&gt; (Cons w ((app p1) r));}) (Cons y1 (Nil)))</svg:text><svg:line x2="868" y2="600" x1="868" y1="530"></svg:line><svg:rect width="580" height="30" y="600" x="578"></svg:rect><svg:text y="615" x="868">case ((rev w1)) of {Nil  -&gt; (Cons y1 (Nil)); Cons t r1 -&gt; (Cons t ((app r1) (Cons y1 (Nil))));}</svg:text><svg:line x2="868" y2="700" x1="868" y1="630"></svg:line><svg:rect width="1054" height="30" y="700" x="341"></svg:rect><svg:text y="715" x="868">case (((\u -&gt; case (u) of {Nil  -&gt; (Nil); Cons t2 v -&gt; ((app (rev v)) (Cons t2 (Nil)));}) w1)) of {Nil  -&gt; (Cons y1 (Nil)); Cons t r1 -&gt; (Cons t ((app r1) (Cons y1 (Nil))));}</svg:text><svg:line x2="868" y2="800" x1="868" y1="730"></svg:line><svg:rect width="1090" height="30" y="800" x="323"></svg:rect><svg:text y="815" x="868">let v2=case (w1) of {Nil  -&gt; (Nil); Cons x3 s2 -&gt; ((app (rev s2)) (Cons x3 (Nil)));}
 in case (v2) of {Cons y2 u1 -&gt; (Cons y2 ((app u1) (Cons y1 (Nil)))); Nil  -&gt; (Cons y1 (Nil));}</svg:text><svg:line x2="612" y2="900" x1="868" y1="830"></svg:line><svg:rect width="556" height="30" y="900" x="334"></svg:rect><svg:text y="915" x="612">case (v2) of {Cons y2 u1 -&gt; (Cons y2 ((app u1) (Cons y1 (Nil)))); Nil  -&gt; (Cons y1 (Nil));}</svg:text><svg:line x2="173" y2="1000" x1="612" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="162"></svg:rect><svg:text y="1015" x="173">v2</svg:text><svg:line x2="572" y2="1000" x1="612" y1="930"></svg:line><svg:rect width="226" height="30" y="1000" x="459"></svg:rect><svg:text y="1015" x="572">(Cons y2 ((app u1) (Cons y1 (Nil))))</svg:text><svg:line x2="235" y2="1100" x1="572" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="224"></svg:rect><svg:text y="1115" x="235">y2</svg:text><svg:line x2="603" y2="1100" x1="572" y1="1030"></svg:line><svg:rect width="166" height="30" y="1100" x="520"></svg:rect><svg:text y="1115" x="603">((app u1) (Cons y1 (Nil)))</svg:text><svg:line x2="603" y2="1200" x1="603" y1="1130"></svg:line><svg:rect width="634" height="30" y="1200" x="286"></svg:rect><svg:text y="1215" x="603">(((\z -&gt; (\r2 -&gt; case (z) of {Nil  -&gt; r2; Cons z1 t1 -&gt; (Cons z1 ((app t1) r2));})) u1) (Cons y1 (Nil)))</svg:text><svg:line x2="603" y2="1300" x1="603" y1="1230"></svg:line><svg:rect width="550" height="30" y="1300" x="328"></svg:rect><svg:text y="1315" x="603">((\w2 -&gt; case (u1) of {Nil  -&gt; w2; Cons x1 y -&gt; (Cons x1 ((app y) w2));}) (Cons y1 (Nil)))</svg:text><svg:line x2="603" y2="1400" x1="603" y1="1330"></svg:line><svg:rect width="556" height="30" y="1400" x="325"></svg:rect><svg:text y="1415" x="603">case (u1) of {Nil  -&gt; (Cons y1 (Nil)); Cons u2 z2 -&gt; (Cons u2 ((app z2) (Cons y1 (Nil))));}</svg:text><svg:line x2="1011" y2="1000" x1="612" y1="930"></svg:line><svg:rect width="100" height="30" y="1000" x="961"></svg:rect><svg:text y="1015" x="1011">(Cons y1 (Nil))</svg:text><svg:line x2="971" y2="1100" x1="1011" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="960"></svg:rect><svg:text y="1115" x="971">y1</svg:text><svg:line x2="1042" y2="1100" x1="1011" y1="1030"></svg:line><svg:rect width="40" height="30" y="1100" x="1022"></svg:rect><svg:text y="1115" x="1042">(Nil)</svg:text><svg:line x2="1338" y2="900" x1="868" y1="830"></svg:line><svg:rect width="472" height="30" y="900" x="1102"></svg:rect><svg:text y="915" x="1338">case (w1) of {Nil  -&gt; (Nil); Cons x3 s2 -&gt; ((app (rev s2)) (Cons x3 (Nil)));}</svg:text>
    <svg:path d="M 325, 1415 C 142, 1415 142, 915 334, 915" style="stroke:black;"></svg:path><svg:path d="M 1574, 915 C 1594, 915 1594, 215 1033, 215" style="stroke:black;"></svg:path>
    </svg:svg>