<svg:svg width="2220" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="148" height="30" y="0" x="1036"></svg:rect><svg:text y="15" x="1110">(even ((double n) (Z)))</svg:text><svg:line x2="1110" y2="100" x1="1110" y1="30"></svg:line><svg:rect width="694" height="30" y="100" x="763"></svg:rect><svg:text y="115" x="1110">((\u1 -&gt; case (u1) of {Z  -&gt; (True); S u2 -&gt; case (u2) of {Z  -&gt; (False); S v1 -&gt; (even v1);};}) ((double n) (Z)))</svg:text><svg:line x2="1110" y2="200" x1="1110" y1="130"></svg:line><svg:rect width="598" height="30" y="200" x="811"></svg:rect><svg:text y="215" x="1110">case (((double n) (Z))) of {Z  -&gt; (True); S v -&gt; case (v) of {Z  -&gt; (False); S u3 -&gt; (even u3);};}</svg:text><svg:line x2="1110" y2="300" x1="1110" y1="230"></svg:line><svg:rect width="1000" height="30" y="300" x="610"></svg:rect><svg:text y="315" x="1110">case ((((\s1 -&gt; (\u -&gt; case (s1) of {Z  -&gt; u; S r2 -&gt; ((double r2) (S (S u)));})) n) (Z))) of {Z  -&gt; (True); S v -&gt; case (v) of {Z  -&gt; (False); S u3 -&gt; (even u3);};}</svg:text><svg:line x2="1110" y2="400" x1="1110" y1="330"></svg:line><svg:rect width="934" height="30" y="400" x="643"></svg:rect><svg:text y="415" x="1110">case (((\y2 -&gt; case (n) of {Z  -&gt; y2; S w3 -&gt; ((double w3) (S (S y2)));}) (Z))) of {Z  -&gt; (True); S p -&gt; case (p) of {Z  -&gt; (False); S w1 -&gt; (even w1);};}</svg:text><svg:line x2="1110" y2="500" x1="1110" y1="430"></svg:line><svg:rect width="976" height="30" y="500" x="622"></svg:rect><svg:text y="515" x="1110">let x2=(Z), w2=n
 in case (case (w2) of {S v3 -&gt; ((double v3) (S (S x2))); Z  -&gt; x2;}) of {S z -&gt; case (z) of {S p2 -&gt; (even p2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="1048" y2="600" x1="1110" y1="530"></svg:line><svg:rect width="850" height="30" y="600" x="623"></svg:rect><svg:text y="615" x="1048">case (case (w2) of {S v3 -&gt; ((double v3) (S (S x2))); Z  -&gt; x2;}) of {S z -&gt; case (z) of {S p2 -&gt; (even p2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="31" y2="700" x1="1048" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">w2</svg:text><svg:line x2="606" y2="700" x1="1048" y1="630"></svg:line><svg:rect width="658" height="30" y="700" x="277"></svg:rect><svg:text y="715" x="606">case (((double v3) (S (S x2)))) of {S r1 -&gt; case (r1) of {S v2 -&gt; (even v2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="606" y2="800" x1="606" y1="730"></svg:line><svg:rect width="1048" height="30" y="800" x="82"></svg:rect><svg:text y="815" x="606">case ((((\s -&gt; (\x -&gt; case (s) of {Z  -&gt; x; S x1 -&gt; ((double x1) (S (S x)));})) v3) (S (S x2)))) of {S r1 -&gt; case (r1) of {S v2 -&gt; (even v2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="606" y2="900" x1="606" y1="830"></svg:line><svg:rect width="982" height="30" y="900" x="115"></svg:rect><svg:text y="915" x="606">case (((\t1 -&gt; case (v3) of {Z  -&gt; t1; S y1 -&gt; ((double y1) (S (S t1)));}) (S (S x2)))) of {S r -&gt; case (r) of {S t2 -&gt; (even t2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="606" y2="1000" x1="606" y1="930"></svg:line><svg:rect width="1006" height="30" y="1000" x="103"></svg:rect><svg:text y="1015" x="606">let z1=v3, w=(S (S x2))
 in case (case (z1) of {S v3 -&gt; ((double v3) (S (S w))); Z  -&gt; w;}) of {S z -&gt; case (z) of {S p2 -&gt; (even p2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="520" y2="1100" x1="606" y1="1030"></svg:line><svg:rect width="838" height="30" y="1100" x="101"></svg:rect><svg:text y="1115" x="520">case (case (z1) of {S v3 -&gt; ((double v3) (S (S w))); Z  -&gt; w;}) of {S z -&gt; case (z) of {S p2 -&gt; (even p2); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="990" y2="1100" x1="606" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="979"></svg:rect><svg:text y="1115" x="990">v3</svg:text><svg:line x2="1076" y2="1100" x1="606" y1="1030"></svg:line><svg:rect width="70" height="30" y="1100" x="1041"></svg:rect><svg:text y="1115" x="1076">(S (S x2))</svg:text><svg:line x2="1076" y2="1200" x1="1076" y1="1130"></svg:line><svg:rect width="46" height="30" y="1200" x="1053"></svg:rect><svg:text y="1215" x="1076">(S x2)</svg:text><svg:line x2="1076" y2="1300" x1="1076" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="1065"></svg:rect><svg:text y="1315" x="1076">x2</svg:text><svg:line x2="1623" y2="700" x1="1048" y1="630"></svg:line><svg:rect width="514" height="30" y="700" x="1366"></svg:rect><svg:text y="715" x="1623">case (x2) of {S z3 -&gt; case (z3) of {S y -&gt; (even y); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="1181" y2="800" x1="1623" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="1170"></svg:rect><svg:text y="815" x="1181">x2</svg:text><svg:line x2="1611" y2="800" x1="1623" y1="730"></svg:line><svg:rect width="286" height="30" y="800" x="1468"></svg:rect><svg:text y="815" x="1611">case (z3) of {S t -&gt; (even t); Z  -&gt; (False);}</svg:text><svg:line x2="1243" y2="900" x1="1611" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="1232"></svg:rect><svg:text y="915" x="1243">z3</svg:text><svg:line x2="1596" y2="900" x1="1611" y1="830"></svg:line><svg:rect width="58" height="30" y="900" x="1567"></svg:rect><svg:text y="915" x="1596">(even t)</svg:text><svg:line x2="1596" y2="1000" x1="1596" y1="930"></svg:line><svg:rect width="604" height="30" y="1000" x="1294"></svg:rect><svg:text y="1015" x="1596">((\y3 -&gt; case (y3) of {Z  -&gt; (True); S s2 -&gt; case (s2) of {Z  -&gt; (False); S x3 -&gt; (even x3);};}) t)</svg:text><svg:line x2="1596" y2="1100" x1="1596" y1="1030"></svg:line><svg:rect width="520" height="30" y="1100" x="1336"></svg:rect><svg:text y="1115" x="1596">case (t) of {Z  -&gt; (True); S z2 -&gt; case (z2) of {Z  -&gt; (False); S p1 -&gt; (even p1);};}</svg:text><svg:line x2="1964" y2="900" x1="1611" y1="830"></svg:line><svg:rect width="52" height="30" y="900" x="1938"></svg:rect><svg:text y="915" x="1964">(False)</svg:text><svg:line x2="2053" y2="800" x1="1623" y1="730"></svg:line><svg:rect width="46" height="30" y="800" x="2030"></svg:rect><svg:text y="815" x="2053">(True)</svg:text><svg:line x2="2130" y2="600" x1="1110" y1="530"></svg:line><svg:rect width="28" height="30" y="600" x="2116"></svg:rect><svg:text y="615" x="2130">(Z)</svg:text><svg:line x2="2192" y2="600" x1="1110" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="2184"></svg:rect><svg:text y="615" x="2192">n</svg:text>
    <svg:path d="M 101, 1115 C 0, 1115 0, 615 623, 615" style="stroke:black;"></svg:path><svg:path d="M 1336, 1115 C 1150, 1115 1150, 715 1366, 715" style="stroke:black;"></svg:path>
    </svg:svg>