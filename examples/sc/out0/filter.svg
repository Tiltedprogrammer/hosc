<svg:svg width="3810" height="2030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="244" height="30" y="0" x="1783"></svg:rect><svg:text y="15" x="1905">((map f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1905" y2="100" x1="1905" y1="30"></svg:line><svg:rect width="772" height="30" y="100" x="1519"></svg:rect><svg:text y="115" x="1905">(((\v1 -&gt; (\u6 -&gt; case (u6) of {Nil  -&gt; (Nil); Cons u4 p2 -&gt; (Cons (v1 u4) ((map v1) p2));})) f) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1905" y2="200" x1="1905" y1="130"></svg:line><svg:rect width="682" height="30" y="200" x="1564"></svg:rect><svg:text y="215" x="1905">((\t1 -&gt; case (t1) of {Nil  -&gt; (Nil); Cons r6 t5 -&gt; (Cons (f r6) ((map f) t5));}) ((filter ((compose p) f)) xs))</svg:text><svg:line x2="1905" y2="300" x1="1905" y1="230"></svg:line><svg:rect width="586" height="30" y="300" x="1612"></svg:rect><svg:text y="315" x="1905">case (((filter ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons s3 w -&gt; (Cons (f s3) ((map f) w));}</svg:text><svg:line x2="1905" y2="400" x1="1905" y1="330"></svg:line><svg:rect width="1408" height="30" y="400" x="1201"></svg:rect><svg:text y="415" x="1905">case ((((\t -&gt; (\w3 -&gt; case (w3) of {Nil  -&gt; (Nil); Cons v6 p5 -&gt; case ((t v6)) of {True  -&gt; (Cons v6 ((filter t) p5)); False  -&gt; ((filter t) p5);};})) ((compose p) f)) xs)) of {Nil  -&gt; (Nil); Cons s3 w -&gt; (Cons (f s3) ((map f) w));}</svg:text><svg:line x2="1905" y2="500" x1="1905" y1="430"></svg:line><svg:rect width="1516" height="30" y="500" x="1147"></svg:rect><svg:text y="515" x="1905">case (((\p3 -&gt; case (p3) of {Nil  -&gt; (Nil); Cons x2 r1 -&gt; case ((((compose p) f) x2)) of {True  -&gt; (Cons x2 ((filter ((compose p) f)) r1)); False  -&gt; ((filter ((compose p) f)) r1);};}) xs)) of {Nil  -&gt; (Nil); Cons x5 y2 -&gt; (Cons (f x5) ((map f) y2));}</svg:text><svg:line x2="1905" y2="600" x1="1905" y1="530"></svg:line><svg:rect width="1414" height="30" y="600" x="1198"></svg:rect><svg:text y="615" x="1905">case (case (xs) of {Nil  -&gt; (Nil); Cons u r7 -&gt; case ((((compose p) f) u)) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);};}) of {Nil  -&gt; (Nil); Cons x1 y3 -&gt; (Cons (f x1) ((map f) y3));}</svg:text><svg:line x2="31" y2="700" x1="1905" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">xs</svg:text><svg:line x2="309" y2="700" x1="1905" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="82"></svg:rect><svg:text y="715" x="309">case ((Nil)) of {Nil  -&gt; (Nil); Cons t6 r5 -&gt; (Cons (f t6) ((map f) r5));}</svg:text><svg:line x2="309" y2="800" x1="309" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="289"></svg:rect><svg:text y="815" x="309">(Nil)</svg:text><svg:line x2="2183" y2="700" x1="1905" y1="630"></svg:line><svg:rect width="1150" height="30" y="700" x="1608"></svg:rect><svg:text y="715" x="2183">case (case ((((compose p) f) u)) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);}) of {Nil  -&gt; (Nil); Cons r3 w1 -&gt; (Cons (f r3) ((map f) w1));}</svg:text><svg:line x2="2183" y2="800" x1="2183" y1="730"></svg:line><svg:rect width="1342" height="30" y="800" x="1512"></svg:rect><svg:text y="815" x="2183">case (case (((((\w6 -&gt; (\y5 -&gt; (\v2 -&gt; (w6 (y5 v2))))) p) f) u)) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);}) of {Nil  -&gt; (Nil); Cons r3 w1 -&gt; (Cons (f r3) ((map f) w1));}</svg:text><svg:line x2="2183" y2="900" x1="2183" y1="830"></svg:line><svg:rect width="1258" height="30" y="900" x="1554"></svg:rect><svg:text y="915" x="2183">case (case ((((\z4 -&gt; (\w7 -&gt; (p (z4 w7)))) f) u)) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);}) of {Nil  -&gt; (Nil); Cons u1 v3 -&gt; (Cons (f u1) ((map f) v3));}</svg:text><svg:line x2="2183" y2="1000" x1="2183" y1="930"></svg:line><svg:rect width="1174" height="30" y="1000" x="1596"></svg:rect><svg:text y="1015" x="2183">case (case (((\s6 -&gt; (p (f s6))) u)) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);}) of {Nil  -&gt; (Nil); Cons z6 v5 -&gt; (Cons (f z6) ((map f) v5));}</svg:text><svg:line x2="2183" y2="1100" x1="2183" y1="1030"></svg:line><svg:rect width="1090" height="30" y="1100" x="1638"></svg:rect><svg:text y="1115" x="2183">case (case ((p (f u))) of {True  -&gt; (Cons u ((filter ((compose p) f)) r7)); False  -&gt; ((filter ((compose p) f)) r7);}) of {Nil  -&gt; (Nil); Cons r2 y1 -&gt; (Cons (f r2) ((map f) y1));}</svg:text><svg:line x2="608" y2="1200" x1="2183" y1="1130"></svg:line><svg:rect width="64" height="30" y="1200" x="576"></svg:rect><svg:text y="1215" x="608">(p (f u))</svg:text><svg:line x2="608" y2="1300" x1="608" y1="1230"></svg:line><svg:rect width="40" height="30" y="1300" x="588"></svg:rect><svg:text y="1315" x="608">(f u)</svg:text><svg:line x2="608" y2="1400" x1="608" y1="1330"></svg:line><svg:rect width="16" height="30" y="1400" x="600"></svg:rect><svg:text y="1415" x="608">u</svg:text><svg:line x2="1472" y2="1200" x1="2183" y1="1130"></svg:line><svg:rect width="652" height="30" y="1200" x="1146"></svg:rect><svg:text y="1215" x="1472">case ((Cons u ((filter ((compose p) f)) r7))) of {Nil  -&gt; (Nil); Cons p4 y4 -&gt; (Cons (f p4) ((map f) y4));}</svg:text><svg:line x2="1472" y2="1300" x1="1472" y1="1230"></svg:line><svg:rect width="322" height="30" y="1300" x="1311"></svg:rect><svg:text y="1315" x="1472">(Cons (f u) ((map f) ((filter ((compose p) f)) r7)))</svg:text><svg:line x2="700" y2="1400" x1="1472" y1="1330"></svg:line><svg:rect width="40" height="30" y="1400" x="680"></svg:rect><svg:text y="1415" x="700">(f u)</svg:text><svg:line x2="700" y2="1500" x1="700" y1="1430"></svg:line><svg:rect width="16" height="30" y="1500" x="692"></svg:rect><svg:text y="1515" x="700">u</svg:text><svg:line x2="1512" y2="1400" x1="1472" y1="1330"></svg:line><svg:rect width="244" height="30" y="1400" x="1390"></svg:rect><svg:text y="1415" x="1512">((map f) ((filter ((compose p) f)) r7))</svg:text><svg:line x2="1512" y2="1500" x1="1512" y1="1430"></svg:line><svg:rect width="772" height="30" y="1500" x="1126"></svg:rect><svg:text y="1515" x="1512">(((\u5 -&gt; (\y6 -&gt; case (y6) of {Nil  -&gt; (Nil); Cons y7 p1 -&gt; (Cons (u5 y7) ((map u5) p1));})) f) ((filter ((compose p) f)) r7))</svg:text><svg:line x2="1512" y2="1600" x1="1512" y1="1530"></svg:line><svg:rect width="670" height="30" y="1600" x="1177"></svg:rect><svg:text y="1615" x="1512">((\w5 -&gt; case (w5) of {Nil  -&gt; (Nil); Cons z2 x -&gt; (Cons (f z2) ((map f) x));}) ((filter ((compose p) f)) r7))</svg:text><svg:line x2="1512" y2="1700" x1="1512" y1="1630"></svg:line><svg:rect width="598" height="30" y="1700" x="1213"></svg:rect><svg:text y="1715" x="1512">case (((filter ((compose p) f)) r7)) of {Nil  -&gt; (Nil); Cons p7 w4 -&gt; (Cons (f p7) ((map f) w4));}</svg:text><svg:line x2="1512" y2="1800" x1="1512" y1="1730"></svg:line><svg:rect width="1432" height="30" y="1800" x="796"></svg:rect><svg:text y="1815" x="1512">case ((((\t2 -&gt; (\v -&gt; case (v) of {Nil  -&gt; (Nil); Cons s4 x6 -&gt; case ((t2 s4)) of {True  -&gt; (Cons s4 ((filter t2) x6)); False  -&gt; ((filter t2) x6);};})) ((compose p) f)) r7)) of {Nil  -&gt; (Nil); Cons p7 w4 -&gt; (Cons (f p7) ((map f) w4));}</svg:text><svg:line x2="1512" y2="1900" x1="1512" y1="1830"></svg:line><svg:rect width="1504" height="30" y="1900" x="760"></svg:rect><svg:text y="1915" x="1512">case (((\u7 -&gt; case (u7) of {Nil  -&gt; (Nil); Cons x4 t4 -&gt; case ((((compose p) f) x4)) of {True  -&gt; (Cons x4 ((filter ((compose p) f)) t4)); False  -&gt; ((filter ((compose p) f)) t4);};}) r7)) of {Nil  -&gt; (Nil); Cons w2 y -&gt; (Cons (f w2) ((map f) y));}</svg:text><svg:line x2="1512" y2="2000" x1="1512" y1="1930"></svg:line><svg:rect width="1432" height="30" y="2000" x="796"></svg:rect><svg:text y="2015" x="1512">case (case (r7) of {Nil  -&gt; (Nil); Cons v7 z5 -&gt; case ((((compose p) f) v7)) of {True  -&gt; (Cons v7 ((filter ((compose p) f)) z5)); False  -&gt; ((filter ((compose p) f)) z5);};}) of {Nil  -&gt; (Nil); Cons t3 s1 -&gt; (Cons (f t3) ((map f) s1));}</svg:text><svg:line x2="3047" y2="1200" x1="2183" y1="1130"></svg:line><svg:rect width="598" height="30" y="1200" x="2748"></svg:rect><svg:text y="1215" x="3047">case (((filter ((compose p) f)) r7)) of {Nil  -&gt; (Nil); Cons r4 x7 -&gt; (Cons (f r4) ((map f) x7));}</svg:text><svg:line x2="3047" y2="1300" x1="3047" y1="1230"></svg:line><svg:rect width="1444" height="30" y="1300" x="2325"></svg:rect><svg:text y="1315" x="3047">case ((((\z1 -&gt; (\u3 -&gt; case (u3) of {Nil  -&gt; (Nil); Cons p6 s5 -&gt; case ((z1 p6)) of {True  -&gt; (Cons p6 ((filter z1) s5)); False  -&gt; ((filter z1) s5);};})) ((compose p) f)) r7)) of {Nil  -&gt; (Nil); Cons r4 x7 -&gt; (Cons (f r4) ((map f) x7));}</svg:text><svg:line x2="3047" y2="1400" x1="3047" y1="1330"></svg:line><svg:rect width="1486" height="30" y="1400" x="2304"></svg:rect><svg:text y="1415" x="3047">case (((\z3 -&gt; case (z3) of {Nil  -&gt; (Nil); Cons x3 s -&gt; case ((((compose p) f) x3)) of {True  -&gt; (Cons x3 ((filter ((compose p) f)) s)); False  -&gt; ((filter ((compose p) f)) s);};}) r7)) of {Nil  -&gt; (Nil); Cons u2 z -&gt; (Cons (f u2) ((map f) z));}</svg:text><svg:line x2="3047" y2="1500" x1="3047" y1="1430"></svg:line><svg:rect width="1420" height="30" y="1500" x="2337"></svg:rect><svg:text y="1515" x="3047">case (case (r7) of {Nil  -&gt; (Nil); Cons z7 v4 -&gt; case ((((compose p) f) z7)) of {True  -&gt; (Cons z7 ((filter ((compose p) f)) v4)); False  -&gt; ((filter ((compose p) f)) v4);};}) of {Nil  -&gt; (Nil); Cons s2 r -&gt; (Cons (f s2) ((map f) r));}</svg:text>
    <svg:path d="M 796, 2015 C 0, 2015 0, 615 1198, 615" style="stroke:black;"></svg:path><svg:path d="M 3757, 1515 C 3810, 1515 3810, 615 2612, 615" style="stroke:black;"></svg:path>
    </svg:svg>