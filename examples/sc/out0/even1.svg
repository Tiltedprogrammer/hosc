<svg:svg width="2166" height="1130" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="76" height="30" y="0" x="1045"></svg:rect><svg:text y="15" x="1083">((f n) (Z))</svg:text><svg:line x2="1083" y2="100" x1="1083" y1="30"></svg:line><svg:rect width="940" height="30" y="100" x="613"></svg:rect><svg:text y="115" x="1083">(((\y -&gt; (\p -&gt; case (y) of {Z  -&gt; case (p) of {S w2 -&gt; case (w2) of {S u1 -&gt; (g u1); Z  -&gt; (False);}; Z  -&gt; (True);}; S w -&gt; ((f w) (S (S p)));})) n) (Z))</svg:text><svg:line x2="1083" y2="200" x1="1083" y1="130"></svg:line><svg:rect width="886" height="30" y="200" x="640"></svg:rect><svg:text y="215" x="1083">((\t2 -&gt; case (n) of {Z  -&gt; case (t2) of {S y3 -&gt; case (y3) of {S w1 -&gt; (g w1); Z  -&gt; (False);}; Z  -&gt; (True);}; S r -&gt; ((f r) (S (S t2)));}) (Z))</svg:text><svg:line x2="1083" y2="300" x1="1083" y1="230"></svg:line><svg:rect width="940" height="30" y="300" x="613"></svg:rect><svg:text y="315" x="1083">let x1=(Z), p2=n
 in case (p2) of {S p1 -&gt; ((f p1) (S (S x1))); Z  -&gt; case (x1) of {S z2 -&gt; case (z2) of {S z3 -&gt; (g z3); Z  -&gt; (False);}; Z  -&gt; (True);};}</svg:text><svg:line x2="1021" y2="400" x1="1083" y1="330"></svg:line><svg:rect width="814" height="30" y="400" x="614"></svg:rect><svg:text y="415" x="1021">case (p2) of {S p1 -&gt; ((f p1) (S (S x1))); Z  -&gt; case (x1) of {S z2 -&gt; case (z2) of {S z3 -&gt; (g z3); Z  -&gt; (False);}; Z  -&gt; (True);};}</svg:text><svg:line x2="31" y2="500" x1="1021" y1="430"></svg:line><svg:rect width="22" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="31">p2</svg:text><svg:line x2="585" y2="500" x1="1021" y1="430"></svg:line><svg:rect width="124" height="30" y="500" x="523"></svg:rect><svg:text y="515" x="585">((f p1) (S (S x1)))</svg:text><svg:line x2="585" y2="600" x1="585" y1="530"></svg:line><svg:rect width="1006" height="30" y="600" x="82"></svg:rect><svg:text y="615" x="585">(((\v -&gt; (\t1 -&gt; case (v) of {Z  -&gt; case (t1) of {S v1 -&gt; case (v1) of {S u2 -&gt; (g u2); Z  -&gt; (False);}; Z  -&gt; (True);}; S x -&gt; ((f x) (S (S t1)));})) p1) (S (S x1)))</svg:text><svg:line x2="585" y2="700" x1="585" y1="630"></svg:line><svg:rect width="946" height="30" y="700" x="112"></svg:rect><svg:text y="715" x="585">((\x3 -&gt; case (p1) of {Z  -&gt; case (x3) of {S x2 -&gt; case (x2) of {S z1 -&gt; (g z1); Z  -&gt; (False);}; Z  -&gt; (True);}; S r2 -&gt; ((f r2) (S (S x3)));}) (S (S x1)))</svg:text><svg:line x2="585" y2="800" x1="585" y1="730"></svg:line><svg:rect width="958" height="30" y="800" x="106"></svg:rect><svg:text y="815" x="585">let u=(S (S x1)), s=p1
 in case (s) of {S p1 -&gt; ((f p1) (S (S u))); Z  -&gt; case (u) of {S z2 -&gt; case (z2) of {S z3 -&gt; (g z3); Z  -&gt; (False);}; Z  -&gt; (True);};}</svg:text><svg:line x2="499" y2="900" x1="585" y1="830"></svg:line><svg:rect width="796" height="30" y="900" x="101"></svg:rect><svg:text y="915" x="499">case (s) of {S p1 -&gt; ((f p1) (S (S u))); Z  -&gt; case (u) of {S z2 -&gt; case (z2) of {S z3 -&gt; (g z3); Z  -&gt; (False);}; Z  -&gt; (True);};}</svg:text><svg:line x2="972" y2="900" x1="585" y1="830"></svg:line><svg:rect width="70" height="30" y="900" x="937"></svg:rect><svg:text y="915" x="972">(S (S x1))</svg:text><svg:line x2="972" y2="1000" x1="972" y1="930"></svg:line><svg:rect width="46" height="30" y="1000" x="949"></svg:rect><svg:text y="1015" x="972">(S x1)</svg:text><svg:line x2="972" y2="1100" x1="972" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="961"></svg:rect><svg:text y="1115" x="972">x1</svg:text><svg:line x2="1058" y2="900" x1="585" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="1047"></svg:rect><svg:text y="915" x="1058">p1</svg:text><svg:line x2="1575" y2="500" x1="1021" y1="430"></svg:line><svg:rect width="496" height="30" y="500" x="1327"></svg:rect><svg:text y="515" x="1575">case (x1) of {S y2 -&gt; case (y2) of {S z -&gt; (g z); Z  -&gt; (False);}; Z  -&gt; (True);}</svg:text><svg:line x2="1139" y2="600" x1="1575" y1="530"></svg:line><svg:rect width="22" height="30" y="600" x="1128"></svg:rect><svg:text y="615" x="1139">x1</svg:text><svg:line x2="1563" y2="600" x1="1575" y1="530"></svg:line><svg:rect width="280" height="30" y="600" x="1423"></svg:rect><svg:text y="615" x="1563">case (y2) of {S v2 -&gt; (g v2); Z  -&gt; (False);}</svg:text><svg:line x2="1201" y2="700" x1="1563" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="1190"></svg:rect><svg:text y="715" x="1201">y2</svg:text><svg:line x2="1548" y2="700" x1="1563" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="1525"></svg:rect><svg:text y="715" x="1548">(g v2)</svg:text><svg:line x2="1548" y2="800" x1="1548" y1="730"></svg:line><svg:rect width="592" height="30" y="800" x="1252"></svg:rect><svg:text y="815" x="1548">((\s1 -&gt; case (s1) of {Z  -&gt; (True); S y1 -&gt; case (y1) of {Z  -&gt; (False); S s2 -&gt; (g s2);};}) v2)</svg:text><svg:line x2="1548" y2="900" x1="1548" y1="830"></svg:line><svg:rect width="496" height="30" y="900" x="1300"></svg:rect><svg:text y="915" x="1548">case (v2) of {Z  -&gt; (True); S r1 -&gt; case (r1) of {Z  -&gt; (False); S t -&gt; (g t);};}</svg:text><svg:line x2="1910" y2="700" x1="1563" y1="630"></svg:line><svg:rect width="52" height="30" y="700" x="1884"></svg:rect><svg:text y="715" x="1910">(False)</svg:text><svg:line x2="1999" y2="600" x1="1575" y1="530"></svg:line><svg:rect width="46" height="30" y="600" x="1976"></svg:rect><svg:text y="615" x="1999">(True)</svg:text><svg:line x2="2076" y2="400" x1="1083" y1="330"></svg:line><svg:rect width="28" height="30" y="400" x="2062"></svg:rect><svg:text y="415" x="2076">(Z)</svg:text><svg:line x2="2138" y2="400" x1="1083" y1="330"></svg:line><svg:rect width="16" height="30" y="400" x="2130"></svg:rect><svg:text y="415" x="2138">n</svg:text>
    <svg:path d="M 101, 915 C 0, 915 0, 415 614, 415" style="stroke:black;"></svg:path><svg:path d="M 1300, 915 C 1108, 915 1108, 515 1327, 515" style="stroke:black;"></svg:path>
    </svg:svg>