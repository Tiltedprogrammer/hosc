<svg:svg width="1680" height="1030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="520" height="30" y="0" x="580"></svg:rect><svg:text y="15" x="840">(((\w1 -&gt; (\p1 -&gt; case (w1) of {Z  -&gt; (g p1); S y1 -&gt; ((f y1) (S (S p1)));})) t) (Z))</svg:text><svg:line x2="840" y2="100" x1="840" y1="30"></svg:line><svg:rect width="424" height="30" y="100" x="628"></svg:rect><svg:text y="115" x="840">((\z1 -&gt; case (t) of {Z  -&gt; (g z1); S x -&gt; ((f x) (S (S z1)));}) (Z))</svg:text><svg:line x2="840" y2="200" x1="840" y1="130"></svg:line><svg:rect width="460" height="30" y="200" x="610"></svg:rect><svg:text y="215" x="840">let z=(Z), t1=t
 in case (t1) of {S v2 -&gt; ((f v2) (S (S z))); Z  -&gt; (g z);}</svg:text><svg:line x2="778" y2="300" x1="840" y1="230"></svg:line><svg:rect width="340" height="30" y="300" x="608"></svg:rect><svg:text y="315" x="778">case (t1) of {S v2 -&gt; ((f v2) (S (S z))); Z  -&gt; (g z);}</svg:text><svg:line x2="31" y2="400" x1="778" y1="330"></svg:line><svg:rect width="22" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="31">t1</svg:text><svg:line x2="348" y2="400" x1="778" y1="330"></svg:line><svg:rect width="118" height="30" y="400" x="289"></svg:rect><svg:text y="415" x="348">((f v2) (S (S z)))</svg:text><svg:line x2="348" y2="500" x1="348" y1="430"></svg:line><svg:rect width="532" height="30" y="500" x="82"></svg:rect><svg:text y="515" x="348">(((\x2 -&gt; (\s -&gt; case (x2) of {Z  -&gt; (g s); S v -&gt; ((f v) (S (S s)));})) v2) (S (S z)))</svg:text><svg:line x2="348" y2="600" x1="348" y1="530"></svg:line><svg:rect width="466" height="30" y="600" x="115"></svg:rect><svg:text y="615" x="348">((\z2 -&gt; case (v2) of {Z  -&gt; (g z2); S y -&gt; ((f y) (S (S z2)));}) (S (S z)))</svg:text><svg:line x2="348" y2="700" x1="348" y1="630"></svg:line><svg:rect width="520" height="30" y="700" x="88"></svg:rect><svg:text y="715" x="348">let v1=v2, r1=(S (S z))
 in case (v1) of {S v2 -&gt; ((f v2) (S (S r1))); Z  -&gt; (g r1);}</svg:text><svg:line x2="265" y2="800" x1="348" y1="730"></svg:line><svg:rect width="352" height="30" y="800" x="89"></svg:rect><svg:text y="815" x="265">case (v1) of {S v2 -&gt; ((f v2) (S (S r1))); Z  -&gt; (g r1);}</svg:text><svg:line x2="492" y2="800" x1="348" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="481"></svg:rect><svg:text y="815" x="492">v2</svg:text><svg:line x2="575" y2="800" x1="348" y1="730"></svg:line><svg:rect width="64" height="30" y="800" x="543"></svg:rect><svg:text y="815" x="575">(S (S z))</svg:text><svg:line x2="575" y2="900" x1="575" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="555"></svg:rect><svg:text y="915" x="575">(S z)</svg:text><svg:line x2="575" y2="1000" x1="575" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="567"></svg:rect><svg:text y="1015" x="575">z</svg:text><svg:line x2="1095" y2="400" x1="778" y1="330"></svg:line><svg:rect width="40" height="30" y="400" x="1075"></svg:rect><svg:text y="415" x="1095">(g z)</svg:text><svg:line x2="1095" y2="500" x1="1095" y1="430"></svg:line><svg:rect width="574" height="30" y="500" x="808"></svg:rect><svg:text y="515" x="1095">((\u1 -&gt; case (u1) of {Z  -&gt; (True); S x1 -&gt; case (x1) of {Z  -&gt; (False); S w -&gt; (g w);};}) z)</svg:text><svg:line x2="1095" y2="600" x1="1095" y1="530"></svg:line><svg:rect width="490" height="30" y="600" x="850"></svg:rect><svg:text y="615" x="1095">case (z) of {Z  -&gt; (True); S u2 -&gt; case (u2) of {Z  -&gt; (False); S p -&gt; (g p);};}</svg:text><svg:line x2="662" y2="700" x1="1095" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="654"></svg:rect><svg:text y="715" x="662">z</svg:text><svg:line x2="733" y2="700" x1="1095" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="710"></svg:rect><svg:text y="715" x="733">(True)</svg:text><svg:line x2="1166" y2="700" x1="1095" y1="630"></svg:line><svg:rect width="268" height="30" y="700" x="1032"></svg:rect><svg:text y="715" x="1166">case (u2) of {Z  -&gt; (False); S r -&gt; (g r);}</svg:text><svg:line x2="807" y2="800" x1="1166" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="796"></svg:rect><svg:text y="815" x="807">u2</svg:text><svg:line x2="884" y2="800" x1="1166" y1="730"></svg:line><svg:rect width="52" height="30" y="800" x="858"></svg:rect><svg:text y="815" x="884">(False)</svg:text><svg:line x2="1243" y2="800" x1="1166" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="1223"></svg:rect><svg:text y="815" x="1243">(g r)</svg:text><svg:line x2="1243" y2="900" x1="1243" y1="830"></svg:line><svg:rect width="586" height="30" y="900" x="950"></svg:rect><svg:text y="915" x="1243">((\y2 -&gt; case (y2) of {Z  -&gt; (True); S s1 -&gt; case (s1) of {Z  -&gt; (False); S p2 -&gt; (g p2);};}) r)</svg:text><svg:line x2="1243" y2="1000" x1="1243" y1="930"></svg:line><svg:rect width="490" height="30" y="1000" x="998"></svg:rect><svg:text y="1015" x="1243">case (r) of {Z  -&gt; (True); S u -&gt; case (u) of {Z  -&gt; (False); S w2 -&gt; (g w2);};}</svg:text><svg:line x2="1590" y2="300" x1="840" y1="230"></svg:line><svg:rect width="28" height="30" y="300" x="1576"></svg:rect><svg:text y="315" x="1590">(Z)</svg:text><svg:line x2="1652" y2="300" x1="840" y1="230"></svg:line><svg:rect width="16" height="30" y="300" x="1644"></svg:rect><svg:text y="315" x="1652">t</svg:text>
    <svg:path d="M 89, 815 C 0, 815 0, 315 608, 315" style="stroke:black;"></svg:path><svg:path d="M 1488, 1015 C 1556, 1015 1556, 615 1340, 615" style="stroke:black;"></svg:path>
    </svg:svg>