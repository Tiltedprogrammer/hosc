<svg:svg width="946" height="1230" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="124" height="30" y="0" x="411"></svg:rect><svg:text y="15" x="473">(((f x) (S (Z))) d)</svg:text><svg:line x2="473" y2="100" x1="473" y1="30"></svg:line><svg:rect width="622" height="30" y="100" x="162"></svg:rect><svg:text y="115" x="473">((((\r -&gt; (\u1 -&gt; (\t1 -&gt; case (r) of {Z  -&gt; (t1 u1); S p1 -&gt; (((f p1) (S u1)) t1);}))) x) (S (Z))) d)</svg:text><svg:line x2="473" y2="200" x1="473" y1="130"></svg:line><svg:rect width="514" height="30" y="200" x="216"></svg:rect><svg:text y="215" x="473">(((\t -&gt; (\z -&gt; case (x) of {Z  -&gt; (z t); S z2 -&gt; (((f z2) (S t)) z);})) (S (Z))) d)</svg:text><svg:line x2="473" y2="300" x1="473" y1="230"></svg:line><svg:rect width="496" height="30" y="300" x="225"></svg:rect><svg:text y="315" x="473">((\r1 -&gt; case (x) of {Z  -&gt; (r1 (S (Z))); S z1 -&gt; (((f z1) (S (S (Z)))) r1);}) d)</svg:text><svg:line x2="473" y2="400" x1="473" y1="330"></svg:line><svg:rect width="514" height="30" y="400" x="216"></svg:rect><svg:text y="415" x="473">let w1=(Z), v=x
 in case (v) of {S y1 -&gt; (((f y1) (S (S w1))) d); Z  -&gt; (d (S w1));}</svg:text><svg:line x2="411" y2="500" x1="473" y1="430"></svg:line><svg:rect width="394" height="30" y="500" x="214"></svg:rect><svg:text y="515" x="411">case (v) of {S y1 -&gt; (((f y1) (S (S w1))) d); Z  -&gt; (d (S w1));}</svg:text><svg:line x2="28" y2="600" x1="411" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="20"></svg:rect><svg:text y="615" x="28">v</svg:text><svg:line x2="384" y2="600" x1="411" y1="530"></svg:line><svg:rect width="148" height="30" y="600" x="310"></svg:rect><svg:text y="615" x="384">(((f y1) (S (S w1))) d)</svg:text><svg:line x2="384" y2="700" x1="384" y1="630"></svg:line><svg:rect width="616" height="30" y="700" x="76"></svg:rect><svg:text y="715" x="384">((((\p -&gt; (\v1 -&gt; (\s -&gt; case (p) of {Z  -&gt; (s v1); S y -&gt; (((f y) (S v1)) s);}))) y1) (S (S w1))) d)</svg:text><svg:line x2="384" y2="800" x1="384" y1="730"></svg:line><svg:rect width="574" height="30" y="800" x="97"></svg:rect><svg:text y="815" x="384">(((\x2 -&gt; (\s1 -&gt; case (y1) of {Z  -&gt; (s1 x2); S y2 -&gt; (((f y2) (S x2)) s1);})) (S (S w1))) d)</svg:text><svg:line x2="384" y2="900" x1="384" y1="830"></svg:line><svg:rect width="520" height="30" y="900" x="124"></svg:rect><svg:text y="915" x="384">((\u -&gt; case (y1) of {Z  -&gt; (u (S (S w1))); S x1 -&gt; (((f x1) (S (S (S w1)))) u);}) d)</svg:text><svg:line x2="384" y2="1000" x1="384" y1="930"></svg:line><svg:rect width="532" height="30" y="1000" x="118"></svg:rect><svg:text y="1015" x="384">let u2=y1, w=(S w1)
 in case (u2) of {S y1 -&gt; (((f y1) (S (S w))) d); Z  -&gt; (d (S w));}</svg:text><svg:line x2="310" y2="1100" x1="384" y1="1030"></svg:line><svg:rect width="388" height="30" y="1100" x="116"></svg:rect><svg:text y="1115" x="310">case (u2) of {S y1 -&gt; (((f y1) (S (S w))) d); Z  -&gt; (d (S w));}</svg:text><svg:line x2="555" y2="1100" x1="384" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="544"></svg:rect><svg:text y="1115" x="555">y1</svg:text><svg:line x2="629" y2="1100" x1="384" y1="1030"></svg:line><svg:rect width="46" height="30" y="1100" x="606"></svg:rect><svg:text y="1115" x="629">(S w1)</svg:text><svg:line x2="629" y2="1200" x1="629" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="618"></svg:rect><svg:text y="1215" x="629">w1</svg:text><svg:line x2="767" y2="600" x1="411" y1="530"></svg:line><svg:rect width="70" height="30" y="600" x="732"></svg:rect><svg:text y="615" x="767">(d (S w1))</svg:text><svg:line x2="767" y2="700" x1="767" y1="630"></svg:line><svg:rect width="46" height="30" y="700" x="744"></svg:rect><svg:text y="715" x="767">(S w1)</svg:text><svg:line x2="767" y2="800" x1="767" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="756"></svg:rect><svg:text y="815" x="767">w1</svg:text><svg:line x2="856" y2="500" x1="473" y1="430"></svg:line><svg:rect width="28" height="30" y="500" x="842"></svg:rect><svg:text y="515" x="856">(Z)</svg:text><svg:line x2="918" y2="500" x1="473" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="910"></svg:rect><svg:text y="515" x="918">x</svg:text>
    <svg:path d="M 116, 1115 C 0, 1115 0, 515 214, 515" style="stroke:black;"></svg:path>
    </svg:svg>