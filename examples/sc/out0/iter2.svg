<svg:svg width="752" height="1030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="160" height="30" y="0" x="296"></svg:rect><svg:text y="15" x="376">((map f) ((iterate f) x))</svg:text><svg:line x2="376" y2="100" x1="376" y1="30"></svg:line><svg:rect width="688" height="30" y="100" x="32"></svg:rect><svg:text y="115" x="376">(((\p1 -&gt; (\y1 -&gt; case (y1) of {Nil  -&gt; (Nil); Cons z1 w1 -&gt; (Cons (p1 z1) ((map p1) w1));})) f) ((iterate f) x))</svg:text><svg:line x2="376" y2="200" x1="376" y1="130"></svg:line><svg:rect width="574" height="30" y="200" x="89"></svg:rect><svg:text y="215" x="376">((\z -&gt; case (z) of {Nil  -&gt; (Nil); Cons s u1 -&gt; (Cons (f s) ((map f) u1));}) ((iterate f) x))</svg:text><svg:line x2="376" y2="300" x1="376" y1="230"></svg:line><svg:rect width="490" height="30" y="300" x="131"></svg:rect><svg:text y="315" x="376">case (((iterate f) x)) of {Nil  -&gt; (Nil); Cons t v -&gt; (Cons (f t) ((map f) v));}</svg:text><svg:line x2="376" y2="400" x1="376" y1="330"></svg:line><svg:rect width="712" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="376">case ((((\w -&gt; (\y -&gt; (Cons y ((iterate w) (w y))))) f) x)) of {Nil  -&gt; (Nil); Cons t v -&gt; (Cons (f t) ((map f) v));}</svg:text><svg:line x2="376" y2="500" x1="376" y1="430"></svg:line><svg:rect width="670" height="30" y="500" x="41"></svg:rect><svg:text y="515" x="376">case (((\r1 -&gt; (Cons r1 ((iterate f) (f r1)))) x)) of {Nil  -&gt; (Nil); Cons p x1 -&gt; (Cons (f p) ((map f) x1));}</svg:text><svg:line x2="376" y2="600" x1="376" y1="530"></svg:line><svg:rect width="580" height="30" y="600" x="86"></svg:rect><svg:text y="615" x="376">case ((Cons x ((iterate f) (f x)))) of {Nil  -&gt; (Nil); Cons v1 u -&gt; (Cons (f v1) ((map f) u));}</svg:text><svg:line x2="376" y2="700" x1="376" y1="630"></svg:line><svg:rect width="262" height="30" y="700" x="245"></svg:rect><svg:text y="715" x="376">(Cons (f x) ((map f) ((iterate f) (f x))))</svg:text><svg:line x2="228" y2="800" x1="376" y1="730"></svg:line><svg:rect width="40" height="30" y="800" x="208"></svg:rect><svg:text y="815" x="228">(f x)</svg:text><svg:line x2="228" y2="900" x1="228" y1="830"></svg:line><svg:rect width="16" height="30" y="900" x="220"></svg:rect><svg:text y="915" x="228">x</svg:text><svg:line x2="416" y2="800" x1="376" y1="730"></svg:line><svg:rect width="256" height="30" y="800" x="288"></svg:rect><svg:text y="815" x="416">let r=(f x)
 in ((map f) ((iterate f) r))</svg:text><svg:line x2="376" y2="900" x1="416" y1="830"></svg:line><svg:rect width="160" height="30" y="900" x="296"></svg:rect><svg:text y="915" x="376">((map f) ((iterate f) r))</svg:text><svg:line x2="516" y2="900" x1="416" y1="830"></svg:line><svg:rect width="40" height="30" y="900" x="496"></svg:rect><svg:text y="915" x="516">(f x)</svg:text><svg:line x2="516" y2="1000" x1="516" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="508"></svg:rect><svg:text y="1015" x="516">x</svg:text>
    <svg:path d="M 296, 915 C 0, 915 0, 15 296, 15" style="stroke:black;"></svg:path>
    </svg:svg>