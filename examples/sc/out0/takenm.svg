<svg:svg width="1164" height="930" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="94" height="30" y="0" x="535"></svg:rect><svg:text y="15" x="582">((take n1) m1)</svg:text><svg:line x2="582" y2="100" x1="582" y1="30"></svg:line><svg:rect width="802" height="30" y="100" x="181"></svg:rect><svg:text y="115" x="582">(((\y1 -&gt; (\r1 -&gt; case (r1) of {Nil  -&gt; (Nil); Cons x2 y -&gt; case (y1) of {Z  -&gt; (Nil); S w1 -&gt; (Cons x2 ((take w1) y));};})) n1) m1)</svg:text><svg:line x2="582" y2="200" x1="582" y1="130"></svg:line><svg:rect width="706" height="30" y="200" x="229"></svg:rect><svg:text y="215" x="582">((\u1 -&gt; case (u1) of {Nil  -&gt; (Nil); Cons p r -&gt; case (n1) of {Z  -&gt; (Nil); S y2 -&gt; (Cons p ((take y2) r));};}) m1)</svg:text><svg:line x2="582" y2="300" x1="582" y1="230"></svg:line><svg:rect width="622" height="30" y="300" x="271"></svg:rect><svg:text y="315" x="582">case (m1) of {Nil  -&gt; (Nil); Cons z s -&gt; case (n1) of {Z  -&gt; (Nil); S z1 -&gt; (Cons z ((take z1) s));};}</svg:text><svg:line x2="31" y2="400" x1="582" y1="330"></svg:line><svg:rect width="22" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="31">m1</svg:text><svg:line x2="102" y2="400" x1="582" y1="330"></svg:line><svg:rect width="40" height="30" y="400" x="82"></svg:rect><svg:text y="415" x="102">(Nil)</svg:text><svg:line x2="653" y2="400" x1="582" y1="330"></svg:line><svg:rect width="364" height="30" y="400" x="471"></svg:rect><svg:text y="415" x="653">case (n1) of {Z  -&gt; (Nil); S t1 -&gt; (Cons z ((take t1) s));}</svg:text><svg:line x2="173" y2="500" x1="653" y1="430"></svg:line><svg:rect width="22" height="30" y="500" x="162"></svg:rect><svg:text y="515" x="173">n1</svg:text><svg:line x2="244" y2="500" x1="653" y1="430"></svg:line><svg:rect width="40" height="30" y="500" x="224"></svg:rect><svg:text y="515" x="244">(Nil)</svg:text><svg:line x2="724" y2="500" x1="653" y1="430"></svg:line><svg:rect width="142" height="30" y="500" x="653"></svg:rect><svg:text y="515" x="724">(Cons z ((take t1) s))</svg:text><svg:line x2="312" y2="600" x1="724" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="304"></svg:rect><svg:text y="615" x="312">z</svg:text><svg:line x2="752" y2="600" x1="724" y1="530"></svg:line><svg:rect width="88" height="30" y="600" x="708"></svg:rect><svg:text y="615" x="752">((take t1) s)</svg:text><svg:line x2="752" y2="700" x1="752" y1="630"></svg:line><svg:rect width="784" height="30" y="700" x="360"></svg:rect><svg:text y="715" x="752">(((\v2 -&gt; (\v -&gt; case (v) of {Nil  -&gt; (Nil); Cons s1 v1 -&gt; case (v2) of {Z  -&gt; (Nil); S w -&gt; (Cons s1 ((take w) v1));};})) t1) s)</svg:text><svg:line x2="752" y2="800" x1="752" y1="730"></svg:line><svg:rect width="700" height="30" y="800" x="402"></svg:rect><svg:text y="815" x="752">((\x1 -&gt; case (x1) of {Nil  -&gt; (Nil); Cons z2 u -&gt; case (t1) of {Z  -&gt; (Nil); S x -&gt; (Cons z2 ((take x) u));};}) s)</svg:text><svg:line x2="752" y2="900" x1="752" y1="830"></svg:line><svg:rect width="628" height="30" y="900" x="438"></svg:rect><svg:text y="915" x="752">case (s) of {Nil  -&gt; (Nil); Cons t p1 -&gt; case (t1) of {Z  -&gt; (Nil); S u2 -&gt; (Cons t ((take u2) p1));};}</svg:text>
    <svg:path d="M 1066, 915 C 1164, 915 1164, 315 893, 315" style="stroke:black;"></svg:path>
    </svg:svg>