<svg:svg width="1462" height="1430" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="46" height="30" y="0" x="708"></svg:rect><svg:text y="15" x="731">(f zs)</svg:text><svg:line x2="731" y2="100" x1="731" y1="30"></svg:line><svg:rect width="430" height="30" y="100" x="516"></svg:rect><svg:text y="115" x="731">((\w2 -&gt; case (w2) of {Nil  -&gt; (Nil); Cons r z -&gt; ((g r) (f z));}) zs)</svg:text><svg:line x2="731" y2="200" x1="731" y1="130"></svg:line><svg:rect width="370" height="30" y="200" x="546"></svg:rect><svg:text y="215" x="731">case (zs) of {Nil  -&gt; (Nil); Cons v1 y2 -&gt; ((g v1) (f y2));}</svg:text><svg:line x2="31" y2="300" x1="731" y1="230"></svg:line><svg:rect width="22" height="30" y="300" x="20"></svg:rect><svg:text y="315" x="31">zs</svg:text><svg:line x2="102" y2="300" x1="731" y1="230"></svg:line><svg:rect width="40" height="30" y="300" x="82"></svg:rect><svg:text y="315" x="102">(Nil)</svg:text><svg:line x2="802" y2="300" x1="731" y1="230"></svg:line><svg:rect width="100" height="30" y="300" x="752"></svg:rect><svg:text y="315" x="802">((g v1) (f y2))</svg:text><svg:line x2="802" y2="400" x1="802" y1="330"></svg:line><svg:rect width="640" height="30" y="400" x="482"></svg:rect><svg:text y="415" x="802">(((\y -&gt; (\t1 -&gt; case (t1) of {Cons z1 r2 -&gt; (Cons z1 ((g y) r2)); Nil  -&gt; (Cons y (Nil));})) v1) (f y2))</svg:text><svg:line x2="802" y2="500" x1="802" y1="430"></svg:line><svg:rect width="562" height="30" y="500" x="521"></svg:rect><svg:text y="515" x="802">((\z2 -&gt; case (z2) of {Cons w1 v -&gt; (Cons w1 ((g v1) v)); Nil  -&gt; (Cons v1 (Nil));}) (f y2))</svg:text><svg:line x2="802" y2="600" x1="802" y1="530"></svg:line><svg:rect width="490" height="30" y="600" x="557"></svg:rect><svg:text y="615" x="802">case ((f y2)) of {Cons u2 x2 -&gt; (Cons u2 ((g v1) x2)); Nil  -&gt; (Cons v1 (Nil));}</svg:text><svg:line x2="802" y2="700" x1="802" y1="630"></svg:line><svg:rect width="886" height="30" y="700" x="359"></svg:rect><svg:text y="715" x="802">case (((\p1 -&gt; case (p1) of {Nil  -&gt; (Nil); Cons s x3 -&gt; ((g s) (f x3));}) y2)) of {Cons u2 x2 -&gt; (Cons u2 ((g v1) x2)); Nil  -&gt; (Cons v1 (Nil));}</svg:text><svg:line x2="802" y2="800" x1="802" y1="730"></svg:line><svg:rect width="886" height="30" y="800" x="359"></svg:rect><svg:text y="815" x="802">let y1=case (y2) of {Nil  -&gt; (Nil); Cons x1 u1 -&gt; ((g x1) (f u1));}
 in case (y1) of {Cons u s1 -&gt; (Cons u ((g v1) s1)); Nil  -&gt; (Cons v1 (Nil));}</svg:text><svg:line x2="597" y2="900" x1="802" y1="830"></svg:line><svg:rect width="454" height="30" y="900" x="370"></svg:rect><svg:text y="915" x="597">case (y1) of {Cons u s1 -&gt; (Cons u ((g v1) s1)); Nil  -&gt; (Cons v1 (Nil));}</svg:text><svg:line x2="173" y2="1000" x1="597" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="162"></svg:rect><svg:text y="1015" x="173">y1</svg:text><svg:line x2="557" y2="1000" x1="597" y1="930"></svg:line><svg:rect width="130" height="30" y="1000" x="492"></svg:rect><svg:text y="1015" x="557">(Cons u ((g v1) s1))</svg:text><svg:line x2="232" y2="1100" x1="557" y1="1030"></svg:line><svg:rect width="16" height="30" y="1100" x="224"></svg:rect><svg:text y="1115" x="232">u</svg:text><svg:line x2="585" y2="1100" x1="557" y1="1030"></svg:line><svg:rect width="76" height="30" y="1100" x="547"></svg:rect><svg:text y="1115" x="585">((g v1) s1)</svg:text><svg:line x2="585" y2="1200" x1="585" y1="1130"></svg:line><svg:rect width="610" height="30" y="1200" x="280"></svg:rect><svg:text y="1215" x="585">(((\t2 -&gt; (\p -&gt; case (p) of {Cons x p2 -&gt; (Cons x ((g t2) p2)); Nil  -&gt; (Cons t2 (Nil));})) v1) s1)</svg:text><svg:line x2="585" y2="1300" x1="585" y1="1230"></svg:line><svg:rect width="526" height="30" y="1300" x="322"></svg:rect><svg:text y="1315" x="585">((\r1 -&gt; case (r1) of {Cons t w -&gt; (Cons t ((g v1) w)); Nil  -&gt; (Cons v1 (Nil));}) s1)</svg:text><svg:line x2="585" y2="1400" x1="585" y1="1330"></svg:line><svg:rect width="466" height="30" y="1400" x="352"></svg:rect><svg:text y="1415" x="585">case (s1) of {Cons v2 s2 -&gt; (Cons v2 ((g v1) s2)); Nil  -&gt; (Cons v1 (Nil));}</svg:text><svg:line x2="981" y2="1000" x1="597" y1="930"></svg:line><svg:rect width="100" height="30" y="1000" x="931"></svg:rect><svg:text y="1015" x="981">(Cons v1 (Nil))</svg:text><svg:line x2="941" y2="1100" x1="981" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="930"></svg:rect><svg:text y="1115" x="941">v1</svg:text><svg:line x2="1012" y2="1100" x1="981" y1="1030"></svg:line><svg:rect width="40" height="30" y="1100" x="992"></svg:rect><svg:text y="1115" x="1012">(Nil)</svg:text><svg:line x2="1257" y2="900" x1="802" y1="830"></svg:line><svg:rect width="370" height="30" y="900" x="1072"></svg:rect><svg:text y="915" x="1257">case (y2) of {Nil  -&gt; (Nil); Cons x1 u1 -&gt; ((g x1) (f u1));}</svg:text>
    <svg:path d="M 352, 1415 C 142, 1415 142, 915 370, 915" style="stroke:black;"></svg:path><svg:path d="M 1442, 915 C 1462, 915 1462, 215 916, 215" style="stroke:black;"></svg:path>
    </svg:svg>