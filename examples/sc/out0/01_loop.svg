<svg:svg width="810" height="1530" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="94" height="30" y="0" x="358"></svg:rect><svg:text y="15" x="405">(((f1 x) y) d)</svg:text><svg:line x2="405" y2="100" x1="405" y1="30"></svg:line><svg:rect width="604" height="30" y="100" x="103"></svg:rect><svg:text y="115" x="405">((((\p1 -&gt; (\y1 -&gt; (\u -&gt; case ((g p1)) of {Z  -&gt; (u y1); S y2 -&gt; (((f y2) (S y1)) u);}))) x) y) d)</svg:text><svg:line x2="405" y2="200" x1="405" y1="130"></svg:line><svg:rect width="508" height="30" y="200" x="151"></svg:rect><svg:text y="215" x="405">(((\w2 -&gt; (\s -&gt; case ((g x)) of {Z  -&gt; (s w2); S p -&gt; (((f p) (S w2)) s);})) y) d)</svg:text><svg:line x2="405" y2="300" x1="405" y1="230"></svg:line><svg:rect width="448" height="30" y="300" x="181"></svg:rect><svg:text y="315" x="405">((\s1 -&gt; case ((g x)) of {Z  -&gt; (s1 y); S v1 -&gt; (((f v1) (S y)) s1);}) d)</svg:text><svg:line x2="405" y2="400" x1="405" y1="330"></svg:line><svg:rect width="346" height="30" y="400" x="232"></svg:rect><svg:text y="415" x="405">case ((g x)) of {Z  -&gt; (d y); S t -&gt; (((f t) (S y)) d);}</svg:text><svg:line x2="405" y2="500" x1="405" y1="430"></svg:line><svg:rect width="406" height="30" y="500" x="202"></svg:rect><svg:text y="515" x="405">case (((\u2 -&gt; u2) x)) of {Z  -&gt; (d y); S t -&gt; (((f t) (S y)) d);}</svg:text><svg:line x2="405" y2="600" x1="405" y1="530"></svg:line><svg:rect width="334" height="30" y="600" x="238"></svg:rect><svg:text y="615" x="405">case (x) of {Z  -&gt; (d y); S r1 -&gt; (((f r1) (S y)) d);}</svg:text><svg:line x2="28" y2="700" x1="405" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="28">x</svg:text><svg:line x2="96" y2="700" x1="405" y1="630"></svg:line><svg:rect width="40" height="30" y="700" x="76"></svg:rect><svg:text y="715" x="96">(d y)</svg:text><svg:line x2="96" y2="800" x1="96" y1="730"></svg:line><svg:rect width="16" height="30" y="800" x="88"></svg:rect><svg:text y="815" x="96">y</svg:text><svg:line x2="473" y2="700" x1="405" y1="630"></svg:line><svg:rect width="118" height="30" y="700" x="414"></svg:rect><svg:text y="715" x="473">(((f r1) (S y)) d)</svg:text><svg:line x2="473" y2="800" x1="473" y1="730"></svg:line><svg:rect width="634" height="30" y="800" x="156"></svg:rect><svg:text y="815" x="473">((((\z1 -&gt; (\r -&gt; (\t1 -&gt; case ((g z1)) of {Z  -&gt; (t1 r); S p2 -&gt; (((f p2) (S r)) t1);}))) r1) (S y)) d)</svg:text><svg:line x2="473" y2="900" x1="473" y1="830"></svg:line><svg:rect width="550" height="30" y="900" x="198"></svg:rect><svg:text y="915" x="473">(((\x1 -&gt; (\v -&gt; case ((g r1)) of {Z  -&gt; (v x1); S z2 -&gt; (((f z2) (S x1)) v);})) (S y)) d)</svg:text><svg:line x2="473" y2="1000" x1="473" y1="930"></svg:line><svg:rect width="490" height="30" y="1000" x="228"></svg:rect><svg:text y="1015" x="473">((\u1 -&gt; case ((g r1)) of {Z  -&gt; (u1 (S y)); S w -&gt; (((f w) (S (S y))) u1);}) d)</svg:text><svg:line x2="473" y2="1100" x1="473" y1="1030"></svg:line><svg:rect width="412" height="30" y="1100" x="267"></svg:rect><svg:text y="1115" x="473">case ((g r1)) of {Z  -&gt; (d (S y)); S v2 -&gt; (((f v2) (S (S y))) d);}</svg:text><svg:line x2="473" y2="1200" x1="473" y1="1130"></svg:line><svg:rect width="472" height="30" y="1200" x="237"></svg:rect><svg:text y="1215" x="473">case (((\w1 -&gt; w1) r1)) of {Z  -&gt; (d (S y)); S v2 -&gt; (((f v2) (S (S y))) d);}</svg:text><svg:line x2="473" y2="1300" x1="473" y1="1230"></svg:line><svg:rect width="484" height="30" y="1300" x="231"></svg:rect><svg:text y="1315" x="473">let z=r1, x2=(S y)
 in case (z) of {Z  -&gt; (d x2); S r1 -&gt; (((f r1) (S x2)) d);}</svg:text><svg:line x2="402" y2="1400" x1="473" y1="1330"></svg:line><svg:rect width="346" height="30" y="1400" x="229"></svg:rect><svg:text y="1415" x="402">case (z) of {Z  -&gt; (d x2); S r1 -&gt; (((f r1) (S x2)) d);}</svg:text><svg:line x2="626" y2="1400" x1="473" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="615"></svg:rect><svg:text y="1415" x="626">r1</svg:text><svg:line x2="697" y2="1400" x1="473" y1="1330"></svg:line><svg:rect width="40" height="30" y="1400" x="677"></svg:rect><svg:text y="1415" x="697">(S y)</svg:text><svg:line x2="697" y2="1500" x1="697" y1="1430"></svg:line><svg:rect width="16" height="30" y="1500" x="689"></svg:rect><svg:text y="1515" x="697">y</svg:text>
    <svg:path d="M 229, 1415 C 0, 1415 0, 615 238, 615" style="stroke:black;"></svg:path>
    </svg:svg>