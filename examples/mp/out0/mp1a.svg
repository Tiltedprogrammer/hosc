<svg:svg width="1662" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="166" height="30" y="0" x="748"></svg:rect><svg:text y="15" x="831">((addOpt (Some x)) (None))</svg:text><svg:line x2="831" y2="100" x1="831" y1="30"></svg:line><svg:rect width="1144" height="30" y="100" x="259"></svg:rect><svg:text y="115" x="831">(((\t2 -&gt; (\r -&gt; case (t2) of {Some z1 -&gt; case (z1) of {Z  -&gt; r; S x2 -&gt; case (((addOpt (Some x2)) r)) of {Some u -&gt; (Some (S u)); None  -&gt; (None);};}; None  -&gt; (None);})) (Some x)) (None))</svg:text><svg:line x2="831" y2="200" x1="831" y1="130"></svg:line><svg:rect width="1090" height="30" y="200" x="286"></svg:rect><svg:text y="215" x="831">((\r2 -&gt; case ((Some x)) of {Some p1 -&gt; case (p1) of {Z  -&gt; r2; S w2 -&gt; case (((addOpt (Some w2)) r2)) of {Some v1 -&gt; (Some (S v1)); None  -&gt; (None);};}; None  -&gt; (None);}) (None))</svg:text><svg:line x2="831" y2="300" x1="831" y1="230"></svg:line><svg:rect width="1030" height="30" y="300" x="316"></svg:rect><svg:text y="315" x="831">case ((Some x)) of {Some y2 -&gt; case (y2) of {Z  -&gt; (None); S s1 -&gt; case (((addOpt (Some s1)) (None))) of {Some z3 -&gt; (Some (S z3)); None  -&gt; (None);};}; None  -&gt; (None);}</svg:text><svg:line x2="831" y2="400" x1="831" y1="330"></svg:line><svg:rect width="712" height="30" y="400" x="475"></svg:rect><svg:text y="415" x="831">case (x) of {Z  -&gt; (None); S w -&gt; case (((addOpt (Some w)) (None))) of {Some u1 -&gt; (Some (S u1)); None  -&gt; (None);};}</svg:text><svg:line x2="28" y2="500" x1="831" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="28">x</svg:text><svg:line x2="99" y2="500" x1="831" y1="430"></svg:line><svg:rect width="46" height="30" y="500" x="76"></svg:rect><svg:text y="515" x="99">(None)</svg:text><svg:line x2="902" y2="500" x1="831" y1="430"></svg:line><svg:rect width="496" height="30" y="500" x="654"></svg:rect><svg:text y="515" x="902">case (((addOpt (Some w)) (None))) of {Some r1 -&gt; (Some (S r1)); None  -&gt; (None);}</svg:text><svg:line x2="902" y2="600" x1="902" y1="530"></svg:line><svg:rect width="1480" height="30" y="600" x="162"></svg:rect><svg:text y="615" x="902">case ((((\t -&gt; (\x3 -&gt; case (t) of {Some u3 -&gt; case (u3) of {Z  -&gt; x3; S v2 -&gt; case (((addOpt (Some v2)) x3)) of {Some z -&gt; (Some (S z)); None  -&gt; (None);};}; None  -&gt; (None);})) (Some w)) (None))) of {Some r1 -&gt; (Some (S r1)); None  -&gt; (None);}</svg:text><svg:line x2="902" y2="700" x1="902" y1="630"></svg:line><svg:rect width="1408" height="30" y="700" x="198"></svg:rect><svg:text y="715" x="902">case (((\y1 -&gt; case ((Some w)) of {Some z2 -&gt; case (z2) of {Z  -&gt; y1; S s2 -&gt; case (((addOpt (Some s2)) y1)) of {Some v -&gt; (Some (S v)); None  -&gt; (None);};}; None  -&gt; (None);}) (None))) of {Some x1 -&gt; (Some (S x1)); None  -&gt; (None);}</svg:text><svg:line x2="902" y2="800" x1="902" y1="730"></svg:line><svg:rect width="1336" height="30" y="800" x="234"></svg:rect><svg:text y="815" x="902">case (case ((Some w)) of {Some t1 -&gt; case (t1) of {Z  -&gt; (None); S s -&gt; case (((addOpt (Some s)) (None))) of {Some p -&gt; (Some (S p)); None  -&gt; (None);};}; None  -&gt; (None);}) of {Some y3 -&gt; (Some (S y3)); None  -&gt; (None);}</svg:text><svg:line x2="902" y2="900" x1="902" y1="830"></svg:line><svg:rect width="1126" height="30" y="900" x="339"></svg:rect><svg:text y="915" x="902">let p2=case (w) of {Z  -&gt; (None); S u2 -&gt; case (((addOpt (Some u2)) (None))) of {Some y -&gt; (Some (S y)); None  -&gt; (None);};}
 in case (p2) of {None  -&gt; (None); Some w1 -&gt; (Some (S w1));}</svg:text><svg:line x2="526" y2="1000" x1="902" y1="930"></svg:line><svg:rect width="352" height="30" y="1000" x="350"></svg:rect><svg:text y="1015" x="526">case (p2) of {None  -&gt; (None); Some w1 -&gt; (Some (S w1));}</svg:text><svg:line x2="419" y2="1100" x1="526" y1="1030"></svg:line><svg:rect width="22" height="30" y="1100" x="408"></svg:rect><svg:text y="1115" x="419">p2</svg:text><svg:line x2="493" y2="1100" x1="526" y1="1030"></svg:line><svg:rect width="46" height="30" y="1100" x="470"></svg:rect><svg:text y="1115" x="493">(None)</svg:text><svg:line x2="600" y2="1100" x1="526" y1="1030"></svg:line><svg:rect width="88" height="30" y="1100" x="556"></svg:rect><svg:text y="1115" x="600">(Some (S w1))</svg:text><svg:line x2="600" y2="1200" x1="600" y1="1130"></svg:line><svg:rect width="46" height="30" y="1200" x="577"></svg:rect><svg:text y="1215" x="600">(S w1)</svg:text><svg:line x2="600" y2="1300" x1="600" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="589"></svg:rect><svg:text y="1315" x="600">w1</svg:text><svg:line x2="1098" y2="1000" x1="902" y1="930"></svg:line><svg:rect width="712" height="30" y="1000" x="742"></svg:rect><svg:text y="1015" x="1098">case (w) of {Z  -&gt; (None); S u2 -&gt; case (((addOpt (Some u2)) (None))) of {Some y -&gt; (Some (S y)); None  -&gt; (None);};}</svg:text>
    <svg:path d="M 1454, 1015 C 1662, 1015 1662, 415 1187, 415" style="stroke:black;"></svg:path>
    </svg:svg>