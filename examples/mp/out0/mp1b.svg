<svg:svg width="1368" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="166" height="30" y="0" x="601"></svg:rect><svg:text y="15" x="684">((addOpt (Some x)) (None))</svg:text><svg:line x2="684" y2="100" x1="684" y1="30"></svg:line><svg:rect width="958" height="30" y="100" x="205"></svg:rect><svg:text y="115" x="684">(((\s1 -&gt; (\y1 -&gt; case (s1) of {Some y -&gt; case (y) of {Z  -&gt; y1; S u1 -&gt; case (((addOpt (Some u1)) y1)) of {Some y2 -&gt; (Some (S y2));};};})) (Some x)) (None))</svg:text><svg:line x2="684" y2="200" x1="684" y1="130"></svg:line><svg:rect width="874" height="30" y="200" x="247"></svg:rect><svg:text y="215" x="684">((\r2 -&gt; case ((Some x)) of {Some v -&gt; case (v) of {Z  -&gt; r2; S p1 -&gt; case (((addOpt (Some p1)) r2)) of {Some u2 -&gt; (Some (S u2));};};}) (None))</svg:text><svg:line x2="684" y2="300" x1="684" y1="230"></svg:line><svg:rect width="814" height="30" y="300" x="277"></svg:rect><svg:text y="315" x="684">case ((Some x)) of {Some z3 -&gt; case (z3) of {Z  -&gt; (None); S p2 -&gt; case (((addOpt (Some p2)) (None))) of {Some u -&gt; (Some (S u));};};}</svg:text><svg:line x2="684" y2="400" x1="684" y1="330"></svg:line><svg:rect width="598" height="30" y="400" x="385"></svg:rect><svg:text y="415" x="684">case (x) of {Z  -&gt; (None); S t -&gt; case (((addOpt (Some t)) (None))) of {Some w -&gt; (Some (S w));};}</svg:text><svg:line x2="28" y2="500" x1="684" y1="430"></svg:line><svg:rect width="16" height="30" y="500" x="20"></svg:rect><svg:text y="515" x="28">x</svg:text><svg:line x2="99" y2="500" x1="684" y1="430"></svg:line><svg:rect width="46" height="30" y="500" x="76"></svg:rect><svg:text y="515" x="99">(None)</svg:text><svg:line x2="755" y2="500" x1="684" y1="430"></svg:line><svg:rect width="394" height="30" y="500" x="558"></svg:rect><svg:text y="515" x="755">case (((addOpt (Some t)) (None))) of {Some z1 -&gt; (Some (S z1));}</svg:text><svg:line x2="755" y2="600" x1="755" y1="530"></svg:line><svg:rect width="1186" height="30" y="600" x="162"></svg:rect><svg:text y="615" x="755">case ((((\x2 -&gt; (\s2 -&gt; case (x2) of {Some s -&gt; case (s) of {Z  -&gt; s2; S v1 -&gt; case (((addOpt (Some v1)) s2)) of {Some w2 -&gt; (Some (S w2));};};})) (Some t)) (None))) of {Some z1 -&gt; (Some (S z1));}</svg:text><svg:line x2="755" y2="700" x1="755" y1="630"></svg:line><svg:rect width="1102" height="30" y="700" x="204"></svg:rect><svg:text y="715" x="755">case (((\v2 -&gt; case ((Some t)) of {Some t1 -&gt; case (t1) of {Z  -&gt; v2; S r -&gt; case (((addOpt (Some r)) v2)) of {Some y3 -&gt; (Some (S y3));};};}) (None))) of {Some x1 -&gt; (Some (S x1));}</svg:text><svg:line x2="755" y2="800" x1="755" y1="730"></svg:line><svg:rect width="1042" height="30" y="800" x="234"></svg:rect><svg:text y="815" x="755">case (case ((Some t)) of {Some r1 -&gt; case (r1) of {Z  -&gt; (None); S z2 -&gt; case (((addOpt (Some z2)) (None))) of {Some u3 -&gt; (Some (S u3));};};}) of {Some p -&gt; (Some (S p));}</svg:text><svg:line x2="755" y2="900" x1="755" y1="830"></svg:line><svg:rect width="922" height="30" y="900" x="294"></svg:rect><svg:text y="915" x="755">let z=case (t) of {Z  -&gt; (None); S w1 -&gt; case (((addOpt (Some w1)) (None))) of {Some x3 -&gt; (Some (S x3));};}
 in case (z) of {Some t2 -&gt; (Some (S t2));}</svg:text><svg:line x2="424" y2="1000" x1="755" y1="930"></svg:line><svg:rect width="244" height="30" y="1000" x="302"></svg:rect><svg:text y="1015" x="424">case (z) of {Some t2 -&gt; (Some (S t2));}</svg:text><svg:line x2="360" y2="1100" x1="424" y1="1030"></svg:line><svg:rect width="16" height="30" y="1100" x="352"></svg:rect><svg:text y="1115" x="360">z</svg:text><svg:line x2="452" y2="1100" x1="424" y1="1030"></svg:line><svg:rect width="88" height="30" y="1100" x="408"></svg:rect><svg:text y="1115" x="452">(Some (S t2))</svg:text><svg:line x2="452" y2="1200" x1="452" y1="1130"></svg:line><svg:rect width="46" height="30" y="1200" x="429"></svg:rect><svg:text y="1215" x="452">(S t2)</svg:text><svg:line x2="452" y2="1300" x1="452" y1="1230"></svg:line><svg:rect width="22" height="30" y="1300" x="441"></svg:rect><svg:text y="1315" x="452">t2</svg:text><svg:line x2="897" y2="1000" x1="755" y1="930"></svg:line><svg:rect width="622" height="30" y="1000" x="586"></svg:rect><svg:text y="1015" x="897">case (t) of {Z  -&gt; (None); S w1 -&gt; case (((addOpt (Some w1)) (None))) of {Some x3 -&gt; (Some (S x3));};}</svg:text>
    <svg:path d="M 1208, 1015 C 1368, 1015 1368, 415 983, 415" style="stroke:black;"></svg:path>
    </svg:svg>