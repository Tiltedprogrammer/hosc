<svg:svg width="954" height="1330" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="112" height="30" y="0" x="421"></svg:rect><svg:text y="15" x="477">((contract r) rc)</svg:text><svg:line x2="477" y2="100" x1="477" y1="30"></svg:line><svg:rect width="496" height="30" y="100" x="229"></svg:rect><svg:text y="115" x="477">(((\y -&gt; (\v -&gt; case (y) of {Access r2 w2 -&gt; (Some ((lookup r2) w2) v);})) r) rc)</svg:text><svg:line x2="477" y2="200" x1="477" y1="130"></svg:line><svg:rect width="424" height="30" y="200" x="265"></svg:rect><svg:text y="215" x="477">((\u2 -&gt; case (r) of {Access p2 s -&gt; (Some ((lookup p2) s) u2);}) rc)</svg:text><svg:line x2="477" y2="300" x1="477" y1="230"></svg:line><svg:rect width="352" height="30" y="300" x="301"></svg:rect><svg:text y="315" x="477">case (r) of {Access z3 t1 -&gt; (Some ((lookup z3) t1) rc);}</svg:text><svg:line x2="28" y2="400" x1="477" y1="330"></svg:line><svg:rect width="16" height="30" y="400" x="20"></svg:rect><svg:text y="415" x="28">r</svg:text><svg:line x2="505" y2="400" x1="477" y1="330"></svg:line><svg:rect width="166" height="30" y="400" x="422"></svg:rect><svg:text y="415" x="505">(Some ((lookup z3) t1) rc)</svg:text><svg:line x2="474" y2="500" x1="505" y1="430"></svg:line><svg:rect width="106" height="30" y="500" x="421"></svg:rect><svg:text y="515" x="474">((lookup z3) t1)</svg:text><svg:line x2="474" y2="600" x1="474" y1="530"></svg:line><svg:rect width="634" height="30" y="600" x="157"></svg:rect><svg:text y="615" x="474">(((\z1 -&gt; (\u -&gt; case (u) of {Cons z2 w -&gt; case (z1) of {Z  -&gt; z2; S x2 -&gt; ((lookup x2) w);};})) z3) t1)</svg:text><svg:line x2="474" y2="700" x1="474" y1="630"></svg:line><svg:rect width="574" height="30" y="700" x="187"></svg:rect><svg:text y="715" x="474">((\t2 -&gt; case (t2) of {Cons s1 p1 -&gt; case (z3) of {Z  -&gt; s1; S x3 -&gt; ((lookup x3) p1);};}) t1)</svg:text><svg:line x2="474" y2="800" x1="474" y1="730"></svg:line><svg:rect width="490" height="30" y="800" x="229"></svg:rect><svg:text y="815" x="474">case (t1) of {Cons v3 u3 -&gt; case (z3) of {Z  -&gt; v3; S s2 -&gt; ((lookup s2) u3);};}</svg:text><svg:line x2="87" y2="900" x1="474" y1="830"></svg:line><svg:rect width="22" height="30" y="900" x="76"></svg:rect><svg:text y="915" x="87">t1</svg:text><svg:line x2="505" y2="900" x1="474" y1="830"></svg:line><svg:rect width="310" height="30" y="900" x="350"></svg:rect><svg:text y="915" x="505">case (z3) of {Z  -&gt; v3; S v1 -&gt; ((lookup v1) u3);}</svg:text><svg:line x2="149" y2="1000" x1="505" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="138"></svg:rect><svg:text y="1015" x="149">z3</svg:text><svg:line x2="211" y2="1000" x1="505" y1="930"></svg:line><svg:rect width="22" height="30" y="1000" x="200"></svg:rect><svg:text y="1015" x="211">v3</svg:text><svg:line x2="567" y2="1000" x1="505" y1="930"></svg:line><svg:rect width="106" height="30" y="1000" x="514"></svg:rect><svg:text y="1015" x="567">((lookup v1) u3)</svg:text><svg:line x2="567" y2="1100" x1="567" y1="1030"></svg:line><svg:rect width="610" height="30" y="1100" x="262"></svg:rect><svg:text y="1115" x="567">(((\w1 -&gt; (\p -&gt; case (p) of {Cons z x -&gt; case (w1) of {Z  -&gt; z; S t -&gt; ((lookup t) x);};})) v1) u3)</svg:text><svg:line x2="567" y2="1200" x1="567" y1="1130"></svg:line><svg:rect width="574" height="30" y="1200" x="280"></svg:rect><svg:text y="1215" x="567">((\r1 -&gt; case (r1) of {Cons u1 x1 -&gt; case (v1) of {Z  -&gt; u1; S y1 -&gt; ((lookup y1) x1);};}) u3)</svg:text><svg:line x2="567" y2="1300" x1="567" y1="1230"></svg:line><svg:rect width="490" height="30" y="1300" x="322"></svg:rect><svg:text y="1315" x="567">case (u3) of {Cons v2 y2 -&gt; case (v1) of {Z  -&gt; v2; S y3 -&gt; ((lookup y3) y2);};}</svg:text><svg:line x2="923" y2="500" x1="505" y1="430"></svg:line><svg:rect width="22" height="30" y="500" x="912"></svg:rect><svg:text y="515" x="923">rc</svg:text>
    <svg:path d="M 812, 1315 C 892, 1315 892, 815 719, 815" style="stroke:black;"></svg:path>
    </svg:svg>