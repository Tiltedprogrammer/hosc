<svg:svg width="7542" height="2030" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="118" height="30" y="0" x="3712"></svg:rect><svg:text y="15" x="3771">((normalize2 f) t)</svg:text><svg:line x2="3771" y2="100" x1="3771" y1="30"></svg:line><svg:rect width="724" height="30" y="100" x="3409"></svg:rect><svg:text y="115" x="3771">(((\p11 -&gt; (\u12 -&gt; case ((decompose u12)) of {Val p10 -&gt; p10; Ctx s10 -&gt; ((normalize2 p11) ((step p11) s10));})) f) t)</svg:text><svg:line x2="3771" y2="200" x1="3771" y1="130"></svg:line><svg:rect width="592" height="30" y="200" x="3475"></svg:rect><svg:text y="215" x="3771">((\p9 -&gt; case ((decompose p9)) of {Val v9 -&gt; v9; Ctx v11 -&gt; ((normalize2 f) ((step f) v11));}) t)</svg:text><svg:line x2="3771" y2="300" x1="3771" y1="230"></svg:line><svg:rect width="496" height="30" y="300" x="3523"></svg:rect><svg:text y="315" x="3771">case ((decompose t)) of {Val t9 -&gt; t9; Ctx t8 -&gt; ((normalize2 f) ((step f) t8));}</svg:text><svg:line x2="3771" y2="400" x1="3771" y1="330"></svg:line><svg:rect width="1768" height="30" y="400" x="2887"></svg:rect><svg:text y="415" x="3771">case (((\z13 -&gt; case (z13) of {Lit z14 -&gt; (Val z14); Add y12 p12 -&gt; case ((decompose y12)) of {Ctx w10 -&gt; (Ctx (C1 w10 p12)); Val p2 -&gt; case ((decompose p12)) of {Val v -&gt; (Ctx (Hole (Sum p2 v))); Ctx w -&gt; (Ctx (C2 p2 w));};};}) t)) of {Val t9 -&gt; t9; Ctx t8 -&gt; ((normalize2 f) ((step f) t8));}</svg:text><svg:line x2="3771" y2="500" x1="3771" y1="430"></svg:line><svg:rect width="1618" height="30" y="500" x="2962"></svg:rect><svg:text y="515" x="3771">case (case (t) of {Lit r -&gt; (Val r); Add x z1 -&gt; case ((decompose x)) of {Ctx w4 -&gt; (Ctx (C1 w4 z1)); Val w5 -&gt; case ((decompose z1)) of {Val t4 -&gt; (Ctx (Hole (Sum w5 t4))); Ctx u8 -&gt; (Ctx (C2 w5 u8));};};}) of {Val r8 -&gt; r8; Ctx s8 -&gt; ((normalize2 f) ((step f) s8));}</svg:text><svg:line x2="28" y2="600" x1="3771" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="20"></svg:rect><svg:text y="615" x="28">t</svg:text><svg:line x2="306" y2="600" x1="3771" y1="530"></svg:line><svg:rect width="460" height="30" y="600" x="76"></svg:rect><svg:text y="615" x="306">case ((Val r)) of {Val v6 -&gt; v6; Ctx x5 -&gt; ((normalize2 f) ((step f) x5));}</svg:text><svg:line x2="306" y2="700" x1="306" y1="630"></svg:line><svg:rect width="16" height="30" y="700" x="298"></svg:rect><svg:text y="715" x="306">r</svg:text><svg:line x2="4049" y2="600" x1="3771" y1="530"></svg:line><svg:rect width="1456" height="30" y="600" x="3321"></svg:rect><svg:text y="615" x="4049">let s2=case ((decompose x)) of {Ctx z8 -&gt; (Ctx (C1 z8 z1)); Val u7 -&gt; case ((decompose z1)) of {Val y7 -&gt; (Ctx (Hole (Sum u7 y7))); Ctx t6 -&gt; (Ctx (C2 u7 t6));};}
 in case (s2) of {Ctx v13 -&gt; ((normalize2 f) ((step f) v13)); Val r14 -&gt; r14;}</svg:text><svg:line x2="1213" y2="700" x1="4049" y1="630"></svg:line><svg:rect width="454" height="30" y="700" x="986"></svg:rect><svg:text y="715" x="1213">case (s2) of {Ctx v13 -&gt; ((normalize2 f) ((step f) v13)); Val r14 -&gt; r14;}</svg:text><svg:line x2="587" y2="800" x1="1213" y1="730"></svg:line><svg:rect width="22" height="30" y="800" x="576"></svg:rect><svg:text y="815" x="587">s2</svg:text><svg:line x2="1210" y2="800" x1="1213" y1="730"></svg:line><svg:rect width="280" height="30" y="800" x="1070"></svg:rect><svg:text y="815" x="1210">let p7=((step f) v13)
 in ((normalize2 f) p7)</svg:text><svg:line x2="700" y2="900" x1="1210" y1="830"></svg:line><svg:rect width="124" height="30" y="900" x="638"></svg:rect><svg:text y="915" x="700">((normalize2 f) p7)</svg:text><svg:line x2="1292" y2="900" x1="1210" y1="830"></svg:line><svg:rect width="94" height="30" y="900" x="1245"></svg:rect><svg:text y="915" x="1292">((step f) v13)</svg:text><svg:line x2="1292" y2="1000" x1="1292" y1="930"></svg:line><svg:rect width="952" height="30" y="1000" x="816"></svg:rect><svg:text y="1015" x="1292">(((\t7 -&gt; (\p14 -&gt; case (p14) of {Hole w7 -&gt; ((contract t7) w7); C1 w8 w13 -&gt; (Add ((step t7) w8) w13); C2 x9 t1 -&gt; (Add (Lit x9) ((step t7) t1));})) f) v13)</svg:text><svg:line x2="1292" y2="1100" x1="1292" y1="1030"></svg:line><svg:rect width="856" height="30" y="1100" x="864"></svg:rect><svg:text y="1115" x="1292">((\u1 -&gt; case (u1) of {Hole z4 -&gt; ((contract f) z4); C1 r7 y8 -&gt; (Add ((step f) r7) y8); C2 t13 p13 -&gt; (Add (Lit t13) ((step f) p13));}) v13)</svg:text><svg:line x2="1292" y2="1200" x1="1292" y1="1130"></svg:line><svg:rect width="808" height="30" y="1200" x="888"></svg:rect><svg:text y="1215" x="1292">case (v13) of {Hole r10 -&gt; ((contract f) r10); C1 r11 y15 -&gt; (Add ((step f) r11) y15); C2 s14 z11 -&gt; (Add (Lit s14) ((step f) z11));}</svg:text><svg:line x2="816" y2="1300" x1="1292" y1="1230"></svg:line><svg:rect width="28" height="30" y="1300" x="802"></svg:rect><svg:text y="1315" x="816">v13</svg:text><svg:line x2="1106" y2="1300" x1="1292" y1="1230"></svg:line><svg:rect width="118" height="30" y="1300" x="1047"></svg:rect><svg:text y="1315" x="1106">((contract f) r10)</svg:text><svg:line x2="1106" y2="1400" x1="1106" y1="1330"></svg:line><svg:rect width="472" height="30" y="1400" x="870"></svg:rect><svg:text y="1415" x="1106">(((\v12 -&gt; (\x15 -&gt; case (x15) of {Sum y13 w14 -&gt; ((v12 y13) w14);})) f) r10)</svg:text><svg:line x2="1106" y2="1500" x1="1106" y1="1430"></svg:line><svg:rect width="352" height="30" y="1500" x="930"></svg:rect><svg:text y="1515" x="1106">((\t11 -&gt; case (t11) of {Sum z9 p8 -&gt; ((f z9) p8);}) r10)</svg:text><svg:line x2="1106" y2="1600" x1="1106" y1="1530"></svg:line><svg:rect width="244" height="30" y="1600" x="984"></svg:rect><svg:text y="1615" x="1106">case (r10) of {Sum u r6 -&gt; ((f u) r6);}</svg:text><svg:line x2="1047" y2="1700" x1="1106" y1="1630"></svg:line><svg:rect width="28" height="30" y="1700" x="1033"></svg:rect><svg:text y="1715" x="1047">r10</svg:text><svg:line x2="1140" y2="1700" x1="1106" y1="1630"></svg:line><svg:rect width="70" height="30" y="1700" x="1105"></svg:rect><svg:text y="1715" x="1140">((f u) r6)</svg:text><svg:line x2="1109" y2="1800" x1="1140" y1="1730"></svg:line><svg:rect width="16" height="30" y="1800" x="1101"></svg:rect><svg:text y="1815" x="1109">u</svg:text><svg:line x2="1168" y2="1800" x1="1140" y1="1730"></svg:line><svg:rect width="22" height="30" y="1800" x="1157"></svg:rect><svg:text y="1815" x="1168">r6</svg:text><svg:line x2="1463" y2="1300" x1="1292" y1="1230"></svg:line><svg:rect width="154" height="30" y="1300" x="1386"></svg:rect><svg:text y="1315" x="1463">(Add ((step f) r11) y15)</svg:text><svg:line x2="1429" y2="1400" x1="1463" y1="1330"></svg:line><svg:rect width="94" height="30" y="1400" x="1382"></svg:rect><svg:text y="1415" x="1429">((step f) r11)</svg:text><svg:line x2="1530" y2="1400" x1="1463" y1="1330"></svg:line><svg:rect width="28" height="30" y="1400" x="1516"></svg:rect><svg:text y="1415" x="1530">y15</svg:text><svg:line x2="1683" y2="1300" x1="1292" y1="1230"></svg:line><svg:rect width="190" height="30" y="1300" x="1588"></svg:rect><svg:text y="1315" x="1683">(Add (Lit s14) ((step f) z11))</svg:text><svg:line x2="1616" y2="1400" x1="1683" y1="1330"></svg:line><svg:rect width="64" height="30" y="1400" x="1584"></svg:rect><svg:text y="1415" x="1616">(Lit s14)</svg:text><svg:line x2="1616" y2="1500" x1="1616" y1="1430"></svg:line><svg:rect width="28" height="30" y="1500" x="1602"></svg:rect><svg:text y="1515" x="1616">s14</svg:text><svg:line x2="1735" y2="1400" x1="1683" y1="1330"></svg:line><svg:rect width="94" height="30" y="1400" x="1688"></svg:rect><svg:text y="1415" x="1735">((step f) z11)</svg:text><svg:line x2="1836" y2="800" x1="1213" y1="730"></svg:line><svg:rect width="28" height="30" y="800" x="1822"></svg:rect><svg:text y="815" x="1836">r14</svg:text><svg:line x2="4706" y2="700" x1="4049" y1="630"></svg:line><svg:rect width="940" height="30" y="700" x="4236"></svg:rect><svg:text y="715" x="4706">case ((decompose x)) of {Ctx z8 -&gt; (Ctx (C1 z8 z1)); Val u7 -&gt; case ((decompose z1)) of {Val y7 -&gt; (Ctx (Hole (Sum u7 y7))); Ctx t6 -&gt; (Ctx (C2 u7 t6));};}</svg:text><svg:line x2="4706" y2="800" x1="4706" y1="730"></svg:line><svg:rect width="2194" height="30" y="800" x="3609"></svg:rect><svg:text y="815" x="4706">case (((\z3 -&gt; case (z3) of {Lit u3 -&gt; (Val u3); Add x8 r9 -&gt; case ((decompose x8)) of {Ctx z10 -&gt; (Ctx (C1 z10 r9)); Val v7 -&gt; case ((decompose r9)) of {Val z7 -&gt; (Ctx (Hole (Sum v7 z7))); Ctx r13 -&gt; (Ctx (C2 v7 r13));};};}) x)) of {Ctx z8 -&gt; (Ctx (C1 z8 z1)); Val u7 -&gt; case ((decompose z1)) of {Val y7 -&gt; (Ctx (Hole (Sum u7 y7))); Ctx t6 -&gt; (Ctx (C2 u7 t6));};}</svg:text><svg:line x2="4706" y2="900" x1="4706" y1="830"></svg:line><svg:rect width="2170" height="30" y="900" x="3621"></svg:rect><svg:text y="915" x="4706">case (case (x) of {Lit v14 -&gt; (Val v14); Add z12 s12 -&gt; case ((decompose z12)) of {Ctx t10 -&gt; (Ctx (C1 t10 s12)); Val t14 -&gt; case ((decompose s12)) of {Val x11 -&gt; (Ctx (Hole (Sum t14 x11))); Ctx u2 -&gt; (Ctx (C2 t14 u2));};};}) of {Ctx t2 -&gt; (Ctx (C1 t2 z1)); Val x4 -&gt; case ((decompose z1)) of {Val t3 -&gt; (Ctx (Hole (Sum x4 t3))); Ctx v4 -&gt; (Ctx (C2 x4 v4));};}</svg:text><svg:line x2="1898" y2="1000" x1="4706" y1="930"></svg:line><svg:rect width="16" height="30" y="1000" x="1890"></svg:rect><svg:text y="1015" x="1898">x</svg:text><svg:line x2="3027" y2="1000" x1="4706" y1="930"></svg:line><svg:rect width="916" height="30" y="1000" x="2569"></svg:rect><svg:text y="1015" x="3027">case ((Val v14)) of {Ctx v5 -&gt; (Ctx (C1 v5 z1)); Val z5 -&gt; case ((decompose z1)) of {Val s1 -&gt; (Ctx (Hole (Sum z5 s1))); Ctx p4 -&gt; (Ctx (C2 z5 p4));};}</svg:text><svg:line x2="3027" y2="1100" x1="3027" y1="1030"></svg:line><svg:rect width="586" height="30" y="1100" x="2734"></svg:rect><svg:text y="1115" x="3027">case ((decompose z1)) of {Val y14 -&gt; (Ctx (Hole (Sum v14 y14))); Ctx t12 -&gt; (Ctx (C2 v14 t12));}</svg:text><svg:line x2="3027" y2="1200" x1="3027" y1="1130"></svg:line><svg:rect width="1816" height="30" y="1200" x="2119"></svg:rect><svg:text y="1215" x="3027">case (((\y1 -&gt; case (y1) of {Lit v1 -&gt; (Val v1); Add x2 v2 -&gt; case ((decompose x2)) of {Ctx x1 -&gt; (Ctx (C1 x1 v2)); Val p5 -&gt; case ((decompose v2)) of {Val x6 -&gt; (Ctx (Hole (Sum p5 x6))); Ctx z2 -&gt; (Ctx (C2 p5 z2));};};}) z1)) of {Val y14 -&gt; (Ctx (Hole (Sum v14 y14))); Ctx t12 -&gt; (Ctx (C2 v14 t12));}</svg:text><svg:line x2="3027" y2="1300" x1="3027" y1="1230"></svg:line><svg:rect width="1702" height="30" y="1300" x="2176"></svg:rect><svg:text y="1315" x="3027">case (case (z1) of {Lit w1 -&gt; (Val w1); Add r1 y -&gt; case ((decompose r1)) of {Ctx z6 -&gt; (Ctx (C1 z6 y)); Val w3 -&gt; case ((decompose y)) of {Val v3 -&gt; (Ctx (Hole (Sum w3 v3))); Ctx r5 -&gt; (Ctx (C2 w3 r5));};};}) of {Val p6 -&gt; (Ctx (Hole (Sum v14 p6))); Ctx y10 -&gt; (Ctx (C2 v14 y10));}</svg:text><svg:line x2="1957" y2="1400" x1="3027" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="1946"></svg:rect><svg:text y="1415" x="1957">z1</svg:text><svg:line x2="2277" y2="1400" x1="3027" y1="1330"></svg:line><svg:rect width="538" height="30" y="1400" x="2008"></svg:rect><svg:text y="1415" x="2277">case ((Val w1)) of {Val x10 -&gt; (Ctx (Hole (Sum v14 x10))); Ctx u9 -&gt; (Ctx (C2 v14 u9));}</svg:text><svg:line x2="2277" y2="1500" x1="2277" y1="1430"></svg:line><svg:rect width="160" height="30" y="1500" x="2197"></svg:rect><svg:text y="1515" x="2277">(Ctx (Hole (Sum v14 w1)))</svg:text><svg:line x2="2277" y2="1600" x1="2277" y1="1530"></svg:line><svg:rect width="124" height="30" y="1600" x="2215"></svg:rect><svg:text y="1615" x="2277">(Hole (Sum v14 w1))</svg:text><svg:line x2="2277" y2="1700" x1="2277" y1="1630"></svg:line><svg:rect width="82" height="30" y="1700" x="2236"></svg:rect><svg:text y="1715" x="2277">(Sum v14 w1)</svg:text><svg:line x2="2246" y2="1800" x1="2277" y1="1730"></svg:line><svg:rect width="28" height="30" y="1800" x="2232"></svg:rect><svg:text y="1815" x="2246">v14</svg:text><svg:line x2="2311" y2="1800" x1="2277" y1="1730"></svg:line><svg:rect width="22" height="30" y="1800" x="2300"></svg:rect><svg:text y="1815" x="2311">w1</svg:text><svg:line x2="3347" y2="1400" x1="3027" y1="1330"></svg:line><svg:rect width="1522" height="30" y="1400" x="2586"></svg:rect><svg:text y="1415" x="3347">let y4=case ((decompose r1)) of {Ctx x14 -&gt; (Ctx (C1 x14 y)); Val v8 -&gt; case ((decompose y)) of {Val u13 -&gt; (Ctx (Hole (Sum v8 u13))); Ctx s13 -&gt; (Ctx (C2 v8 s13));};}
 in case (y4) of {Ctx w12 -&gt; (Ctx (C2 v14 w12)); Val p -&gt; (Ctx (Hole (Sum v14 p)));}</svg:text><svg:line x2="2842" y2="1500" x1="3347" y1="1430"></svg:line><svg:rect width="490" height="30" y="1500" x="2597"></svg:rect><svg:text y="1515" x="2842">case (y4) of {Ctx w12 -&gt; (Ctx (C2 v14 w12)); Val p -&gt; (Ctx (Hole (Sum v14 p)));}</svg:text><svg:line x2="2666" y2="1600" x1="2842" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="2655"></svg:rect><svg:text y="1615" x="2666">y4</svg:text><svg:line x2="2776" y2="1600" x1="2842" y1="1530"></svg:line><svg:rect width="118" height="30" y="1600" x="2717"></svg:rect><svg:text y="1615" x="2776">(Ctx (C2 v14 w12))</svg:text><svg:line x2="2776" y2="1700" x1="2776" y1="1630"></svg:line><svg:rect width="82" height="30" y="1700" x="2735"></svg:rect><svg:text y="1715" x="2776">(C2 v14 w12)</svg:text><svg:line x2="2742" y2="1800" x1="2776" y1="1730"></svg:line><svg:rect width="28" height="30" y="1800" x="2728"></svg:rect><svg:text y="1815" x="2742">v14</svg:text><svg:line x2="2810" y2="1800" x1="2776" y1="1730"></svg:line><svg:rect width="28" height="30" y="1800" x="2796"></svg:rect><svg:text y="1815" x="2810">w12</svg:text><svg:line x2="2952" y2="1600" x1="2842" y1="1530"></svg:line><svg:rect width="154" height="30" y="1600" x="2875"></svg:rect><svg:text y="1615" x="2952">(Ctx (Hole (Sum v14 p)))</svg:text><svg:line x2="2952" y2="1700" x1="2952" y1="1630"></svg:line><svg:rect width="118" height="30" y="1700" x="2893"></svg:rect><svg:text y="1715" x="2952">(Hole (Sum v14 p))</svg:text><svg:line x2="2952" y2="1800" x1="2952" y1="1730"></svg:line><svg:rect width="76" height="30" y="1800" x="2914"></svg:rect><svg:text y="1815" x="2952">(Sum v14 p)</svg:text><svg:line x2="2924" y2="1900" x1="2952" y1="1830"></svg:line><svg:rect width="28" height="30" y="1900" x="2910"></svg:rect><svg:text y="1915" x="2924">v14</svg:text><svg:line x2="2986" y2="1900" x1="2952" y1="1830"></svg:line><svg:rect width="16" height="30" y="1900" x="2978"></svg:rect><svg:text y="1915" x="2986">p</svg:text><svg:line x2="3612" y2="1500" x1="3347" y1="1430"></svg:line><svg:rect width="970" height="30" y="1500" x="3127"></svg:rect><svg:text y="1515" x="3612">case ((decompose r1)) of {Ctx x14 -&gt; (Ctx (C1 x14 y)); Val v8 -&gt; case ((decompose y)) of {Val u13 -&gt; (Ctx (Hole (Sum v8 u13))); Ctx s13 -&gt; (Ctx (C2 v8 s13));};}</svg:text><svg:line x2="5835" y2="1000" x1="4706" y1="930"></svg:line><svg:rect width="1882" height="30" y="1000" x="4894"></svg:rect><svg:text y="1015" x="5835">let s5=case ((decompose z12)) of {Ctx p1 -&gt; (Ctx (C1 p1 s12)); Val s3 -&gt; case ((decompose s12)) of {Val r3 -&gt; (Ctx (Hole (Sum s3 r3))); Ctx x3 -&gt; (Ctx (C2 s3 x3));};}
 in case (s5) of {Ctx s6 -&gt; (Ctx (C1 s6 z1)); Val s -&gt; case ((decompose z1)) of {Ctx y6 -&gt; (Ctx (C2 s y6)); Val p3 -&gt; (Ctx (Hole (Sum s p3)));};}</svg:text><svg:line x2="5333" y2="1100" x1="5835" y1="1030"></svg:line><svg:rect width="856" height="30" y="1100" x="4905"></svg:rect><svg:text y="1115" x="5333">case (s5) of {Ctx s6 -&gt; (Ctx (C1 s6 z1)); Val s -&gt; case ((decompose z1)) of {Ctx y6 -&gt; (Ctx (C2 s y6)); Val p3 -&gt; (Ctx (Hole (Sum s p3)));};}</svg:text><svg:line x2="4159" y2="1200" x1="5333" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="4148"></svg:rect><svg:text y="1215" x="4159">s5</svg:text><svg:line x2="4263" y2="1200" x1="5333" y1="1130"></svg:line><svg:rect width="106" height="30" y="1200" x="4210"></svg:rect><svg:text y="1215" x="4263">(Ctx (C1 s6 z1))</svg:text><svg:line x2="4263" y2="1300" x1="4263" y1="1230"></svg:line><svg:rect width="70" height="30" y="1300" x="4228"></svg:rect><svg:text y="1315" x="4263">(C1 s6 z1)</svg:text><svg:line x2="4232" y2="1400" x1="4263" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="4221"></svg:rect><svg:text y="1415" x="4232">s6</svg:text><svg:line x2="4294" y2="1400" x1="4263" y1="1330"></svg:line><svg:rect width="22" height="30" y="1400" x="4283"></svg:rect><svg:text y="1415" x="4294">z1</svg:text><svg:line x2="5437" y2="1200" x1="5333" y1="1130"></svg:line><svg:rect width="538" height="30" y="1200" x="5168"></svg:rect><svg:text y="1215" x="5437">case ((decompose z1)) of {Ctx s4 -&gt; (Ctx (C2 s s4)); Val t5 -&gt; (Ctx (Hole (Sum s t5)));}</svg:text><svg:line x2="5437" y2="1300" x1="5437" y1="1230"></svg:line><svg:rect width="1768" height="30" y="1300" x="4553"></svg:rect><svg:text y="1315" x="5437">case (((\s7 -&gt; case (s7) of {Lit y5 -&gt; (Val y5); Add u6 r4 -&gt; case ((decompose u6)) of {Ctx v10 -&gt; (Ctx (C1 v10 r4)); Val y3 -&gt; case ((decompose r4)) of {Val z -&gt; (Ctx (Hole (Sum y3 z))); Ctx u4 -&gt; (Ctx (C2 y3 u4));};};}) z1)) of {Ctx s4 -&gt; (Ctx (C2 s s4)); Val t5 -&gt; (Ctx (Hole (Sum s t5)));}</svg:text><svg:line x2="5437" y2="1400" x1="5437" y1="1330"></svg:line><svg:rect width="1726" height="30" y="1400" x="4574"></svg:rect><svg:text y="1415" x="5437">case (case (z1) of {Lit u11 -&gt; (Val u11); Add r2 s9 -&gt; case ((decompose r2)) of {Ctx w9 -&gt; (Ctx (C1 w9 s9)); Val u10 -&gt; case ((decompose s9)) of {Val y9 -&gt; (Ctx (Hole (Sum u10 y9))); Ctx x7 -&gt; (Ctx (C2 u10 x7));};};}) of {Ctx w6 -&gt; (Ctx (C2 s w6)); Val u14 -&gt; (Ctx (Hole (Sum s u14)));}</svg:text><svg:line x2="4367" y2="1500" x1="5437" y1="1430"></svg:line><svg:rect width="22" height="30" y="1500" x="4356"></svg:rect><svg:text y="1515" x="4367">z1</svg:text><svg:line x2="4678" y2="1500" x1="5437" y1="1430"></svg:line><svg:rect width="520" height="30" y="1500" x="4418"></svg:rect><svg:text y="1515" x="4678">case ((Val u11)) of {Ctx x13 -&gt; (Ctx (C2 s x13)); Val w2 -&gt; (Ctx (Hole (Sum s w2)));}</svg:text><svg:line x2="4678" y2="1600" x1="4678" y1="1530"></svg:line><svg:rect width="154" height="30" y="1600" x="4601"></svg:rect><svg:text y="1615" x="4678">(Ctx (Hole (Sum s u11)))</svg:text><svg:line x2="4678" y2="1700" x1="4678" y1="1630"></svg:line><svg:rect width="118" height="30" y="1700" x="4619"></svg:rect><svg:text y="1715" x="4678">(Hole (Sum s u11))</svg:text><svg:line x2="4678" y2="1800" x1="4678" y1="1730"></svg:line><svg:rect width="76" height="30" y="1800" x="4640"></svg:rect><svg:text y="1815" x="4678">(Sum s u11)</svg:text><svg:line x2="4644" y2="1900" x1="4678" y1="1830"></svg:line><svg:rect width="16" height="30" y="1900" x="4636"></svg:rect><svg:text y="1915" x="4644">s</svg:text><svg:line x2="4706" y2="1900" x1="4678" y1="1830"></svg:line><svg:rect width="28" height="30" y="1900" x="4692"></svg:rect><svg:text y="1915" x="4706">u11</svg:text><svg:line x2="5748" y2="1500" x1="5437" y1="1430"></svg:line><svg:rect width="1540" height="30" y="1500" x="4978"></svg:rect><svg:text y="1515" x="5748">let y2=case ((decompose r2)) of {Ctx x12 -&gt; (Ctx (C1 x12 s9)); Val y11 -&gt; case ((decompose s9)) of {Val s11 -&gt; (Ctx (Hole (Sum y11 s11))); Ctx w11 -&gt; (Ctx (C2 y11 w11));};}
 in case (y2) of {Ctx r12 -&gt; (Ctx (C2 s r12)); Val u5 -&gt; (Ctx (Hole (Sum s u5)));}</svg:text><svg:line x2="5228" y2="1600" x1="5748" y1="1530"></svg:line><svg:rect width="478" height="30" y="1600" x="4989"></svg:rect><svg:text y="1615" x="5228">case (y2) of {Ctx r12 -&gt; (Ctx (C2 s r12)); Val u5 -&gt; (Ctx (Hole (Sum s u5)));}</svg:text><svg:line x2="5061" y2="1700" x1="5228" y1="1630"></svg:line><svg:rect width="22" height="30" y="1700" x="5050"></svg:rect><svg:text y="1715" x="5061">y2</svg:text><svg:line x2="5165" y2="1700" x1="5228" y1="1630"></svg:line><svg:rect width="106" height="30" y="1700" x="5112"></svg:rect><svg:text y="1715" x="5165">(Ctx (C2 s r12))</svg:text><svg:line x2="5165" y2="1800" x1="5165" y1="1730"></svg:line><svg:rect width="70" height="30" y="1800" x="5130"></svg:rect><svg:text y="1815" x="5165">(C2 s r12)</svg:text><svg:line x2="5131" y2="1900" x1="5165" y1="1830"></svg:line><svg:rect width="16" height="30" y="1900" x="5123"></svg:rect><svg:text y="1915" x="5131">s</svg:text><svg:line x2="5193" y2="1900" x1="5165" y1="1830"></svg:line><svg:rect width="28" height="30" y="1900" x="5179"></svg:rect><svg:text y="1915" x="5193">r12</svg:text><svg:line x2="5332" y2="1700" x1="5228" y1="1630"></svg:line><svg:rect width="148" height="30" y="1700" x="5258"></svg:rect><svg:text y="1715" x="5332">(Ctx (Hole (Sum s u5)))</svg:text><svg:line x2="5332" y2="1800" x1="5332" y1="1730"></svg:line><svg:rect width="112" height="30" y="1800" x="5276"></svg:rect><svg:text y="1815" x="5332">(Hole (Sum s u5))</svg:text><svg:line x2="5332" y2="1900" x1="5332" y1="1830"></svg:line><svg:rect width="70" height="30" y="1900" x="5297"></svg:rect><svg:text y="1915" x="5332">(Sum s u5)</svg:text><svg:line x2="5301" y2="2000" x1="5332" y1="1930"></svg:line><svg:rect width="16" height="30" y="2000" x="5293"></svg:rect><svg:text y="2015" x="5301">s</svg:text><svg:line x2="5360" y2="2000" x1="5332" y1="1930"></svg:line><svg:rect width="22" height="30" y="2000" x="5349"></svg:rect><svg:text y="2015" x="5360">u5</svg:text><svg:line x2="6007" y2="1600" x1="5748" y1="1530"></svg:line><svg:rect width="1000" height="30" y="1600" x="5507"></svg:rect><svg:text y="1615" x="6007">case ((decompose r2)) of {Ctx x12 -&gt; (Ctx (C1 x12 s9)); Val y11 -&gt; case ((decompose s9)) of {Val s11 -&gt; (Ctx (Hole (Sum y11 s11))); Ctx w11 -&gt; (Ctx (C2 y11 w11));};}</svg:text><svg:line x2="7040" y2="1100" x1="5835" y1="1030"></svg:line><svg:rect width="964" height="30" y="1100" x="6558"></svg:rect><svg:text y="1115" x="7040">case ((decompose z12)) of {Ctx p1 -&gt; (Ctx (C1 p1 s12)); Val s3 -&gt; case ((decompose s12)) of {Val r3 -&gt; (Ctx (Hole (Sum s3 r3))); Ctx x3 -&gt; (Ctx (C2 s3 x3));};}</svg:text>
    <svg:path d="M 1476, 1415 C 1802, 1415 1802, 915 1339, 915" style="stroke:black;"></svg:path><svg:path d="M 1782, 1415 C 1802, 1415 1802, 915 1339, 915" style="stroke:black;"></svg:path><svg:path d="M 638, 915 C 0, 915 0, 15 3712, 15" style="stroke:black;"></svg:path><svg:path d="M 3127, 1515 C 1870, 1515 1870, 715 4236, 715" style="stroke:black;"></svg:path><svg:path d="M 6507, 1615 C 7542, 1615 7542, 715 5176, 715" style="stroke:black;"></svg:path><svg:path d="M 7522, 1115 C 7542, 1115 7542, 715 5176, 715" style="stroke:black;"></svg:path>
    </svg:svg>