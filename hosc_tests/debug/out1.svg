<svg:svg width="5404" height="2630" xmlns:svg="http://www.w3.org/2000/svg">
    <svg:defs>
    <svg:style type="text/css">
    
    rect {fill: none;stroke: black; stroke-width: 1;}
    text {text-anchor: middle; font-family: monospace; font-size: 10px;}
    line {stroke: black; stroke-width: 1}
    path {fill:none; stroke-width:1;stroke-dasharray: 4,4;}</svg:style>
    </svg:defs>
    <svg:rect width="208" height="30" y="0" x="2598"></svg:rect><svg:text y="15" x="2702">(iterate ((decTerm t) (CtxHole)))</svg:text><svg:line x2="2702" y2="100" x1="2702" y1="30"></svg:line><svg:rect width="754" height="30" y="100" x="2325"></svg:rect><svg:text y="115" x="2702">((\s12 -&gt; case (s12) of {Val r14 -&gt; r14; Dec x14 u17 -&gt; (iterate ((decTerm (contract x14)) u17));}) ((decTerm t) (CtxHole)))</svg:text><svg:line x2="2702" y2="200" x1="2702" y1="130"></svg:line><svg:rect width="646" height="30" y="200" x="2379"></svg:rect><svg:text y="215" x="2702">case (((decTerm t) (CtxHole))) of {Val z16 -&gt; z16; Dec r9 y12 -&gt; (iterate ((decTerm (contract r9)) y12));}</svg:text><svg:line x2="2702" y2="300" x1="2702" y1="230"></svg:line><svg:rect width="1312" height="30" y="300" x="2046"></svg:rect><svg:text y="315" x="2702">case ((((\v16 -&gt; (\y17 -&gt; case (v16) of {Cst y16 -&gt; ((decCtx y17) y16); Opr y3 x2 s1 -&gt; ((decTerm x2) (CtxLeft y3 y17 s1));})) t) (CtxHole))) of {Val z16 -&gt; z16; Dec r9 y12 -&gt; (iterate ((decTerm (contract r9)) y12));}</svg:text><svg:line x2="2702" y2="400" x1="2702" y1="330"></svg:line><svg:rect width="1198" height="30" y="400" x="2103"></svg:rect><svg:text y="415" x="2702">case (((\w1 -&gt; case (t) of {Cst w11 -&gt; ((decCtx w1) w11); Opr s11 y5 z4 -&gt; ((decTerm y5) (CtxLeft s11 w1 z4));}) (CtxHole))) of {Val v3 -&gt; v3; Dec p8 p12 -&gt; (iterate ((decTerm (contract p8)) p12));}</svg:text><svg:line x2="2702" y2="500" x1="2702" y1="430"></svg:line><svg:rect width="1222" height="30" y="500" x="2091"></svg:rect><svg:text y="515" x="2702">let r16=(CtxHole), t1=t
 in case (case (t1) of {Cst z6 -&gt; ((decCtx r16) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 r16 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="2622" y2="600" x1="2702" y1="530"></svg:line><svg:rect width="1054" height="30" y="600" x="2095"></svg:rect><svg:text y="615" x="2622">case (case (t1) of {Cst z6 -&gt; ((decCtx r16) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 r16 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="31" y2="700" x1="2622" y1="630"></svg:line><svg:rect width="22" height="30" y="700" x="20"></svg:rect><svg:text y="715" x="31">t1</svg:text><svg:line x2="1944" y2="700" x1="2622" y1="630"></svg:line><svg:rect width="586" height="30" y="700" x="1651"></svg:rect><svg:text y="715" x="1944">case (((decCtx r16) z6)) of {Dec y13 t4 -&gt; (iterate ((decTerm (contract y13)) t4)); Val p -&gt; p;}</svg:text><svg:line x2="1944" y2="800" x1="1944" y1="730"></svg:line><svg:rect width="1516" height="30" y="800" x="1186"></svg:rect><svg:text y="815" x="1944">case ((((\w6 -&gt; (\p9 -&gt; case (w6) of {CtxHole  -&gt; (Val p9); CtxLeft v10 s7 p7 -&gt; ((decTerm p7) (CtxRight v10 p9 s7)); CtxRight u3 p5 x5 -&gt; (Dec (PotRed u3 p5 p9) x5);})) r16) z6)) of {Dec y13 t4 -&gt; (iterate ((decTerm (contract y13)) t4)); Val p -&gt; p;}</svg:text><svg:line x2="1944" y2="900" x1="1944" y1="830"></svg:line><svg:rect width="1504" height="30" y="900" x="1192"></svg:rect><svg:text y="915" x="1944">case (((\p10 -&gt; case (r16) of {CtxHole  -&gt; (Val p10); CtxLeft x11 r1 v1 -&gt; ((decTerm v1) (CtxRight x11 p10 r1)); CtxRight x1 z1 p16 -&gt; (Dec (PotRed x1 z1 p10) p16);}) z6)) of {Dec r13 t10 -&gt; (iterate ((decTerm (contract r13)) t10)); Val z13 -&gt; z13;}</svg:text><svg:line x2="1944" y2="1000" x1="1944" y1="930"></svg:line><svg:rect width="1432" height="30" y="1000" x="1228"></svg:rect><svg:text y="1015" x="1944">case (case (r16) of {CtxHole  -&gt; (Val z6); CtxLeft u14 w14 t14 -&gt; ((decTerm t14) (CtxRight u14 z6 w14)); CtxRight p11 z11 x10 -&gt; (Dec (PotRed p11 z11 z6) x10);}) of {Dec y8 w10 -&gt; (iterate ((decTerm (contract y8)) w10)); Val t11 -&gt; t11;}</svg:text><svg:line x2="96" y2="1100" x1="1944" y1="1030"></svg:line><svg:rect width="28" height="30" y="1100" x="82"></svg:rect><svg:text y="1115" x="96">r16</svg:text><svg:line x2="428" y2="1100" x1="1944" y1="1030"></svg:line><svg:rect width="556" height="30" y="1100" x="150"></svg:rect><svg:text y="1115" x="428">case ((Val z6)) of {Dec u13 v12 -&gt; (iterate ((decTerm (contract u13)) v12)); Val u9 -&gt; u9;}</svg:text><svg:line x2="428" y2="1200" x1="428" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="417"></svg:rect><svg:text y="1215" x="428">z6</svg:text><svg:line x2="1423" y2="1100" x1="1944" y1="1030"></svg:line><svg:rect width="718" height="30" y="1100" x="1064"></svg:rect><svg:text y="1115" x="1423">case (((decTerm t14) (CtxRight u14 z6 w14))) of {Dec y10 v8 -&gt; (iterate ((decTerm (contract y10)) v8)); Val t7 -&gt; t7;}</svg:text><svg:line x2="1423" y2="1200" x1="1423" y1="1130"></svg:line><svg:rect width="1354" height="30" y="1200" x="746"></svg:rect><svg:text y="1215" x="1423">case ((((\t15 -&gt; (\r3 -&gt; case (t15) of {Cst r2 -&gt; ((decCtx r3) r2); Opr x8 v9 t8 -&gt; ((decTerm v9) (CtxLeft x8 r3 t8));})) t14) (CtxRight u14 z6 w14))) of {Dec y10 v8 -&gt; (iterate ((decTerm (contract y10)) v8)); Val t7 -&gt; t7;}</svg:text><svg:line x2="1423" y2="1300" x1="1423" y1="1230"></svg:line><svg:rect width="1246" height="30" y="1300" x="800"></svg:rect><svg:text y="1315" x="1423">case (((\w8 -&gt; case (t14) of {Cst z7 -&gt; ((decCtx w8) z7); Opr p4 s5 s6 -&gt; ((decTerm s5) (CtxLeft p4 w8 s6));}) (CtxRight u14 z6 w14))) of {Dec u5 v7 -&gt; (iterate ((decTerm (contract u5)) v7)); Val r6 -&gt; r6;}</svg:text><svg:line x2="1423" y2="1400" x1="1423" y1="1330"></svg:line><svg:rect width="1318" height="30" y="1400" x="764"></svg:rect><svg:text y="1415" x="1423">let s13=(CtxRight u14 z6 w14), y11=t14
 in case (case (y11) of {Cst z6 -&gt; ((decCtx s13) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 s13 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="1290" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="1060" height="30" y="1500" x="760"></svg:rect><svg:text y="1515" x="1290">case (case (y11) of {Cst z6 -&gt; ((decCtx s13) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 s13 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="1939" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="136" height="30" y="1500" x="1871"></svg:rect><svg:text y="1515" x="1939">(CtxRight u14 z6 w14)</svg:text><svg:line x2="1874" y2="1600" x1="1939" y1="1530"></svg:line><svg:rect width="28" height="30" y="1600" x="1860"></svg:rect><svg:text y="1615" x="1874">u14</svg:text><svg:line x2="1939" y2="1600" x1="1939" y1="1530"></svg:line><svg:rect width="22" height="30" y="1600" x="1928"></svg:rect><svg:text y="1615" x="1939">z6</svg:text><svg:line x2="2004" y2="1600" x1="1939" y1="1530"></svg:line><svg:rect width="28" height="30" y="1600" x="1990"></svg:rect><svg:text y="1615" x="2004">w14</svg:text><svg:line x2="2072" y2="1500" x1="1423" y1="1430"></svg:line><svg:rect width="28" height="30" y="1500" x="2058"></svg:rect><svg:text y="1515" x="2072">t14</svg:text><svg:line x2="2973" y2="1100" x1="1944" y1="1030"></svg:line><svg:rect width="634" height="30" y="1100" x="2656"></svg:rect><svg:text y="1115" x="2973">case ((Dec (PotRed p11 z11 z6) x10)) of {Dec w s -&gt; (iterate ((decTerm (contract w)) s)); Val u2 -&gt; u2;}</svg:text><svg:line x2="2973" y2="1200" x1="2973" y1="1130"></svg:line><svg:rect width="346" height="30" y="1200" x="2800"></svg:rect><svg:text y="1215" x="2973">(iterate ((decTerm (contract (PotRed p11 z11 z6))) x10))</svg:text><svg:line x2="2973" y2="1300" x1="2973" y1="1230"></svg:line><svg:rect width="832" height="30" y="1300" x="2557"></svg:rect><svg:text y="1315" x="2973">((\y2 -&gt; case (y2) of {Val s3 -&gt; s3; Dec x s2 -&gt; (iterate ((decTerm (contract x)) s2));}) ((decTerm (contract (PotRed p11 z11 z6))) x10))</svg:text><svg:line x2="2973" y2="1400" x1="2973" y1="1330"></svg:line><svg:rect width="736" height="30" y="1400" x="2605"></svg:rect><svg:text y="1415" x="2973">case (((decTerm (contract (PotRed p11 z11 z6))) x10)) of {Val z -&gt; z; Dec v6 r -&gt; (iterate ((decTerm (contract v6)) r));}</svg:text><svg:line x2="2973" y2="1500" x1="2973" y1="1430"></svg:line><svg:rect width="1402" height="30" y="1500" x="2272"></svg:rect><svg:text y="1515" x="2973">case ((((\t16 -&gt; (\r15 -&gt; case (t16) of {Cst y -&gt; ((decCtx r15) y); Opr z12 p13 t9 -&gt; ((decTerm p13) (CtxLeft z12 r15 t9));})) (contract (PotRed p11 z11 z6))) x10)) of {Val z -&gt; z; Dec v6 r -&gt; (iterate ((decTerm (contract v6)) r));}</svg:text><svg:line x2="2973" y2="1600" x1="2973" y1="1530"></svg:line><svg:rect width="1366" height="30" y="1600" x="2290"></svg:rect><svg:text y="1615" x="2973">case (((\r12 -&gt; case ((contract (PotRed p11 z11 z6))) of {Cst w15 -&gt; ((decCtx r12) w15); Opr z14 u11 s15 -&gt; ((decTerm u11) (CtxLeft z14 r12 s15));}) x10)) of {Val x6 -&gt; x6; Dec u6 u7 -&gt; (iterate ((decTerm (contract u6)) u7));}</svg:text><svg:line x2="2973" y2="1700" x1="2973" y1="1630"></svg:line><svg:rect width="1234" height="30" y="1700" x="2356"></svg:rect><svg:text y="1715" x="2973">case (case ((contract (PotRed p11 z11 z6))) of {Cst t13 -&gt; ((decCtx x10) t13); Opr t3 w3 v2 -&gt; ((decTerm w3) (CtxLeft t3 x10 v2));}) of {Val t6 -&gt; t6; Dec r4 v4 -&gt; (iterate ((decTerm (contract r4)) v4));}</svg:text><svg:line x2="2973" y2="1800" x1="2973" y1="1730"></svg:line><svg:rect width="1558" height="30" y="1800" x="2194"></svg:rect><svg:text y="1815" x="2973">case (case (((\v5 -&gt; case (v5) of {PotRed x3 w2 p2 -&gt; (Cst ((x3 w2) p2));}) (PotRed p11 z11 z6))) of {Cst t13 -&gt; ((decCtx x10) t13); Opr t3 w3 v2 -&gt; ((decTerm w3) (CtxLeft t3 x10 v2));}) of {Val t6 -&gt; t6; Dec r4 v4 -&gt; (iterate ((decTerm (contract r4)) v4));}</svg:text><svg:line x2="2973" y2="1900" x1="2973" y1="1830"></svg:line><svg:rect width="1534" height="30" y="1900" x="2206"></svg:rect><svg:text y="1915" x="2973">case (case (case ((PotRed p11 z11 z6)) of {PotRed w16 u15 y15 -&gt; (Cst ((w16 u15) y15));}) of {Cst w12 -&gt; ((decCtx x10) w12); Opr p17 z9 s8 -&gt; ((decTerm z9) (CtxLeft p17 x10 s8));}) of {Val x9 -&gt; x9; Dec u12 z8 -&gt; (iterate ((decTerm (contract u12)) z8));}</svg:text><svg:line x2="2973" y2="2000" x1="2973" y1="1930"></svg:line><svg:rect width="1174" height="30" y="2000" x="2386"></svg:rect><svg:text y="2015" x="2973">case (case ((Cst ((p11 z11) z6))) of {Cst v13 -&gt; ((decCtx x10) v13); Opr t5 r5 t12 -&gt; ((decTerm r5) (CtxLeft t5 x10 t12));}) of {Val y4 -&gt; y4; Dec y7 v -&gt; (iterate ((decTerm (contract y7)) v));}</svg:text><svg:line x2="2973" y2="2100" x1="2973" y1="2030"></svg:line><svg:rect width="682" height="30" y="2100" x="2632"></svg:rect><svg:text y="2115" x="2973">case (((decCtx x10) ((p11 z11) z6))) of {Val x13 -&gt; x13; Dec x12 u4 -&gt; (iterate ((decTerm (contract x12)) u4));}</svg:text><svg:line x2="2973" y2="2200" x1="2973" y1="2130"></svg:line><svg:rect width="1612" height="30" y="2200" x="2167"></svg:rect><svg:text y="2215" x="2973">case ((((\z5 -&gt; (\r7 -&gt; case (z5) of {CtxHole  -&gt; (Val r7); CtxLeft w7 z3 x4 -&gt; ((decTerm x4) (CtxRight w7 r7 z3)); CtxRight s4 w4 x16 -&gt; (Dec (PotRed s4 w4 r7) x16);})) x10) ((p11 z11) z6))) of {Val x13 -&gt; x13; Dec x12 u4 -&gt; (iterate ((decTerm (contract x12)) u4));}</svg:text><svg:line x2="2973" y2="2300" x1="2973" y1="2230"></svg:line><svg:rect width="1576" height="30" y="2300" x="2185"></svg:rect><svg:text y="2315" x="2973">case (((\z17 -&gt; case (x10) of {CtxHole  -&gt; (Val z17); CtxLeft v14 u8 w9 -&gt; ((decTerm w9) (CtxRight v14 z17 u8)); CtxRight r11 v11 s9 -&gt; (Dec (PotRed r11 v11 z17) s9);}) ((p11 z11) z6))) of {Val u10 -&gt; u10; Dec z10 x7 -&gt; (iterate ((decTerm (contract z10)) x7));}</svg:text><svg:line x2="2973" y2="2400" x1="2973" y1="2330"></svg:line><svg:rect width="1666" height="30" y="2400" x="2140"></svg:rect><svg:text y="2415" x="2973">let w13=x10, v15=((p11 z11) z6)
 in case (case (w13) of {CtxHole  -&gt; (Val v15); CtxLeft u14 w14 t14 -&gt; ((decTerm t14) (CtxRight u14 v15 w14)); CtxRight p11 z11 x10 -&gt; (Dec (PotRed p11 z11 v15) x10);}) of {Dec y8 w10 -&gt; (iterate ((decTerm (contract y8)) w10)); Val t11 -&gt; t11;}</svg:text><svg:line x2="2872" y2="2500" x1="2973" y1="2430"></svg:line><svg:rect width="1450" height="30" y="2500" x="2147"></svg:rect><svg:text y="2515" x="2872">case (case (w13) of {CtxHole  -&gt; (Val v15); CtxLeft u14 w14 t14 -&gt; ((decTerm t14) (CtxRight u14 v15 w14)); CtxRight p11 z11 x10 -&gt; (Dec (PotRed p11 z11 v15) x10);}) of {Dec y8 w10 -&gt; (iterate ((decTerm (contract y8)) w10)); Val t11 -&gt; t11;}</svg:text><svg:line x2="3651" y2="2500" x1="2973" y1="2430"></svg:line><svg:rect width="28" height="30" y="2500" x="3637"></svg:rect><svg:text y="2515" x="3651">x10</svg:text><svg:line x2="3752" y2="2500" x1="2973" y1="2430"></svg:line><svg:rect width="94" height="30" y="2500" x="3705"></svg:rect><svg:text y="2515" x="3752">((p11 z11) z6)</svg:text><svg:line x2="3721" y2="2600" x1="3752" y1="2530"></svg:line><svg:rect width="28" height="30" y="2600" x="3707"></svg:rect><svg:text y="2615" x="3721">z11</svg:text><svg:line x2="3786" y2="2600" x1="3752" y1="2530"></svg:line><svg:rect width="22" height="30" y="2600" x="3775"></svg:rect><svg:text y="2615" x="3786">z6</svg:text><svg:line x2="4535" y2="700" x1="2622" y1="630"></svg:line><svg:rect width="706" height="30" y="700" x="4182"></svg:rect><svg:text y="715" x="4535">case (((decTerm u) (CtxLeft p1 r16 t2))) of {Dec y1 s16 -&gt; (iterate ((decTerm (contract y1)) s16)); Val p15 -&gt; p15;}</svg:text><svg:line x2="4535" y2="800" x1="4535" y1="730"></svg:line><svg:rect width="1378" height="30" y="800" x="3846"></svg:rect><svg:text y="815" x="4535">case ((((\z2 -&gt; (\p3 -&gt; case (z2) of {Cst y14 -&gt; ((decCtx p3) y14); Opr p14 x15 z15 -&gt; ((decTerm x15) (CtxLeft p14 p3 z15));})) u) (CtxLeft p1 r16 t2))) of {Dec y1 s16 -&gt; (iterate ((decTerm (contract y1)) s16)); Val p15 -&gt; p15;}</svg:text><svg:line x2="4535" y2="900" x1="4535" y1="830"></svg:line><svg:rect width="1300" height="30" y="900" x="3885"></svg:rect><svg:text y="915" x="4535">case (((\u16 -&gt; case (u) of {Cst r10 -&gt; ((decCtx u16) r10); Opr y9 s10 r8 -&gt; ((decTerm s10) (CtxLeft y9 u16 r8));}) (CtxLeft p1 r16 t2))) of {Dec v17 x17 -&gt; (iterate ((decTerm (contract v17)) x17)); Val s14 -&gt; s14;}</svg:text><svg:line x2="4535" y2="1000" x1="4535" y1="930"></svg:line><svg:rect width="1264" height="30" y="1000" x="3903"></svg:rect><svg:text y="1015" x="4535">let u1=(CtxLeft p1 r16 t2), p6=u
 in case (case (p6) of {Cst z6 -&gt; ((decCtx u1) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 u1 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="4411" y2="1100" x1="4535" y1="1030"></svg:line><svg:rect width="1042" height="30" y="1100" x="3890"></svg:rect><svg:text y="1115" x="4411">case (case (p6) of {Cst z6 -&gt; ((decCtx u1) z6); Opr p1 u t2 -&gt; ((decTerm u) (CtxLeft p1 u1 t2));}) of {Dec y6 w5 -&gt; (iterate ((decTerm (contract y6)) w5)); Val w17 -&gt; w17;}</svg:text><svg:line x2="5048" y2="1100" x1="4535" y1="1030"></svg:line><svg:rect width="124" height="30" y="1100" x="4986"></svg:rect><svg:text y="1115" x="5048">(CtxLeft p1 r16 t2)</svg:text><svg:line x2="4983" y2="1200" x1="5048" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="4972"></svg:rect><svg:text y="1215" x="4983">p1</svg:text><svg:line x2="5048" y2="1200" x1="5048" y1="1130"></svg:line><svg:rect width="28" height="30" y="1200" x="5034"></svg:rect><svg:text y="1215" x="5048">r16</svg:text><svg:line x2="5113" y2="1200" x1="5048" y1="1130"></svg:line><svg:rect width="22" height="30" y="1200" x="5102"></svg:rect><svg:text y="1215" x="5113">t2</svg:text><svg:line x2="5172" y2="1100" x1="4535" y1="1030"></svg:line><svg:rect width="16" height="30" y="1100" x="5164"></svg:rect><svg:text y="1115" x="5172">u</svg:text><svg:line x2="5296" y2="600" x1="2702" y1="530"></svg:line><svg:rect width="64" height="30" y="600" x="5264"></svg:rect><svg:text y="615" x="5296">(CtxHole)</svg:text><svg:line x2="5376" y2="600" x1="2702" y1="530"></svg:line><svg:rect width="16" height="30" y="600" x="5368"></svg:rect><svg:text y="615" x="5376">t</svg:text>
    <svg:path d="M 760, 1515 C 0, 1515 0, 615 2095, 615" style="stroke:black;"></svg:path><svg:path d="M 3597, 2515 C 3826, 2515 3826, 1015 2660, 1015" style="stroke:black;"></svg:path><svg:path d="M 4932, 1115 C 5244, 1115 5244, 615 3149, 615" style="stroke:black;"></svg:path>
    </svg:svg>