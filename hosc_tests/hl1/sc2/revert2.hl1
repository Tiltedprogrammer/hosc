list $a :: Nil  | Cons $a (list $a);
boolean  :: True  | False ;

( letrec
  f = %w1 {
    case  w1  of {
      Cons t r :
        case  (f r)  of {
          Cons p v :
            (Cons
              p
              ( letrec g = %p1 { %r1 { case  p1  of { Nil : (Cons r1 Nil); Cons x1 s : (Cons x1 ((g s) r1)); } } }
              in 
                ((g v) t)));
          Nil : (Cons t Nil);
        };
      Nil : Nil;
    }
  }
in 
  (f x))
